<?xml version="1.0" ?>
<!DOCTYPE book PUBLIC "-//KDE//DTD DocBook XML V4.2-Based Variant V1.1//EN" "dtd/kdex.dtd" [
<!ENTITY kappname "&kmidi;">
<!ENTITY package "kdemultimedia">
<!ENTITY timidity "<application
>TiMidity</application
>">
<!ENTITY % addindex "IGNORE">
<!ENTITY % Swedish "INCLUDE">
]>

<book lang="&language;">
<bookinfo>
<title
>Handbok &kmidi;</title>
<authorgroup>
<author
><firstname
>Bernd Johannes</firstname
> <surname
>Wuebben</surname
> <affiliation
> <address
><email
>wuebben@kde.org</email
></address>
</affiliation>
</author>
<author
><firstname
>Greg</firstname
> <surname
>Lee</surname
> <affiliation
> <address
><email
>lee@hawaii.edu</email
></address>
</affiliation>
</author>
<othercredit role="translator"
> <firstname
>Stefan</firstname
> <surname
>Asserhäll</surname
> <affiliation
><address
><email
>stefan.asserhall@comhem.se</email
></address
></affiliation
> <contrib
>Översättare</contrib
></othercredit>
</authorgroup>
    
<copyright>
<year
>1999</year>
<year
>2000</year>
<holder
>Greg Lee</holder>
</copyright>
   
<date
>2000-12-16</date>
<releaseinfo
>1.03.00</releaseinfo>
<abstract>
<para
>&kmidi; spelar midi-filer med användning av instrumentpatcher. Den gör samma sak med programvara som ett ljudkort som GUS (Gravis UltraSound) eller Sound Blaster AWE gör i maskinvara. </para>

</abstract>
<keywordset>
<keyword
>KMidi</keyword>
<keyword
>Midi</keyword>
<keyword
>Spelare</keyword>
<keyword
>Timidity</keyword>
<keyword
>Midi</keyword>
<keyword
>till</keyword>
<keyword
>Wav</keyword>
</keywordset>
</bookinfo>

<chapter id="introduction">
<title
>Inledning</title>

<para
>&kmidi; spelar midi-filer med användning av instrumentpatcher. Den gör samma sak med programvara som ett ljudkort som <acronym
>GUS</acronym
> (Gravis UltraSound) eller Sound Blaster AWE gör i maskinvara. Därför är den enda utrustning som du behöver ett enkelt ljudkort eller krets. Även om du har ett <acronym
>GUS</acronym
> eller AWE, kanske du vill prova &kmidi; ändå, eftersom den låter rätt bra. </para>

<para
>Och den har fördelen att om du vill att den ska låta bättre, kan du bara kavla upp ärmarna och skriva om den, eftersom du förstås får källkoden gratis. </para>

<para
>Den behöver dock en del <acronym
>CPU</acronym
>-tid. Jag märker att öppna nya fönster eller ibland bara rulla skärmen orsakar pauser i musiken. Dessutom vill du nog skaffa några instrumentuppsättningar (se nedan). De är för omfattande (10-12 Mibyte) för att följa med den vanliga &kde;-distributionen, så jag har bara tagit med fem patcher som exempel. &kmidi; kan hantera 257 banker med 128 instrument vardera. </para>

<para
>&kmidi; är baserat på Tuukka Toivonens underbara program <application
>TiMidity</application
>, som gör det mesta arbetet. &kmidi; är ett grafiskt gränssnitt för <application
>TiMidity</application
>, och <application
>TiMidity</application
> själv, med andra alternativa användargränssnitt, ingår i källkodsdistributionen av &kmidi;. Tack, Tuukka! </para>

<para
>&kmidi; stöder följande plattformar för närvarande (version 1.3): </para>

<itemizedlist>
<listitem>
<para
>&Linux;</para>
</listitem>
<listitem>
<para
>FreeBSD</para>
</listitem>
<listitem>
<para
>DEC OSF/1 </para>
</listitem>
<listitem>
<para
>&HP-UX;</para>
</listitem>
<listitem>
<para
>SunOS</para>
</listitem>
<listitem>
<para
>Sun &Solaris;</para>
</listitem>
</itemizedlist>

<para
>Flyttning till andra plattformar bör vara enkel. Var snäll kontakta mig om du har flyttat &kmidi; till en annan plattform. </para>

<para
>För detaljer om användning som inte täcks av den här handboken, se manualsidan för <command
>timidity</command
>. </para>

<para
>Kom ihåg att midi-filer är typiskt omkring 50 Kibyte eller mindre och är därför så lätta att ladda ner att du aldrig får slut på bra filer att spela. </para>

<para
>Lycka till med &kmidi;! </para>

<para
>Bernd Johannes Wuebben <email
>wuebben@kde.org</email
> </para>

</chapter>

<chapter id="usage">
<title
>Användning </title>

<sect1 id="getting-started">
<title
>Att komma igång </title>

<para
>Om du inte har använd &kmidi; tidigare, ser du namnet på en av midi-exempelfilerna jag inkluderat i det svarta fönstret. Klicka på uppspelningsknappen för att spela den. Flytta omkring muspekaren från knapp till knapp för att få en kort beskrivning med ett verktygstips om vad varje knapp gör när den klickas. </para>

<para
>Klicka på <guiicon
>KMidi</guiicon
>-logotypen överst till vänster för att visa den nedre panelen. Där syns ett svart fönster, <interface
>kanalvisaren</interface
>, som visar ett stapeldiagram med toner som spelas på de 16 midi-kanalerna. Till vänster finns en väljare av instrumentuppsättning och en sångväljare. Klicka på sångväljaren för att visa en lista med de övriga midi-exempelfilerna som jag inkluderade i &kmidi;-distributionen. Klicka på en annan, om du vill, för att spela den. </para>

<para
>Klicka på <guiicon
>Info</guiicon
>knappen för att se information om midi-filen som du spelar och <quote
>Karaoke</quote
>-sångtext (om midi-filen har någon). </para>

<para
>Klicka på knappen <guiicon
>spellista</guiicon
> för att leta omkring i filsystemet efter midi-filer och sammanställa en egen lista på filer som ska spelas. Om du inte klickar på filterknappen, visas bara midi-filer (vare sig de har filändelsen <literal role="extension"
>.mid</literal
> eller <literal role="extension"
>.kar</literal
>). Dubbelklicka på ett filnamn till vänster på skärmen för att lägga till filen i spellistan (som visas till höger). </para>

<para
>Bli inte överraskad eller förtretad om en del midi-filer ger lite eller inget ljud. Det finns ett ynkligt litet antal instrumentpatcher med i distributionen av &kmidi;. Ledsen för det. Titta gärna i avsnittet om hur man skaffar instrumentuppsättningar från nätet i det här dokumentet. </para>

</sect1>

<sect1 id="playlists">
<title
>Spellistor</title>

<para
>Klicka på knappen <guiicon
>mata ut</guiicon
> för att öppna spellisthanteraren. Till vänster syns innehållet i katalogen som du sist befann dig i när du redigerade spellistan. Till höger syns den nuvarande spellistan. Välj en midi-fil till vänster för att lägga till den i spellistan genom att dubbelklicka på den. Eller enkelklicka, och välj sedan <guibutton
>Lägg till</guibutton
>. </para>

<para
>De enda filer som visas till vänster är midi-filer. Komprimerade midi-filer känns tyvärr inte igen, så om du har använd till exempel <command
>gzip</command
> för att komprimera filerna, kan du behöva stänga av knappen <guibutton
>Filter</guibutton
> längst ner. Då blir alla filer synliga. &kmidi; avgör inte om en fil är en midi-fil eller inte genom att titta på namnet, utan istället läser den en liten del av filen för att se om den verkar vara en midi-fil. Därför är det inte nödvändigt att döpa dina midi-filer med filändelsen <literal role="extension"
>.mid</literal
>. </para>

<para
>Längst ner på skärmen finns de nuvarande spellistorna. När du först startar, finns det bara en, som heter <guilabel
>default</guilabel
>, med midi-exemplen från &kmidi;s distribution. Innehållet kan ändras genom att enkelklicka på namnet <guilabel
>default</guilabel
> (om det inte redan är markerat) och sedan välja <menuchoice
><guimenu
>Arkiv</guimenu
> <guimenuitem
>Spara</guimenuitem
></menuchoice
> för att byta ut spellistefilens innehåll mot den nuvarande spellistan. Eller välj <menuchoice
><guimenu
>Arkiv</guimenu
><guimenuitem
>Lägg till</guimenuitem
></menuchoice
> för att lägga till innehållet i den nuvarande spellistan sist i spellistans fil. Välj istället <menuchoice
><guimenu
>Arkiv</guimenu
><guimenuitem
>Spara som...</guimenuitem
></menuchoice
> för att skapa en ny spellista, och fyll i det nya namnet du valt i den lilla rutan som dyker upp. Dubbelklicka på en spellistefils namn för att byta ut din nuvarande spellista mot innehållet på den som du har sparat. Det här kan också göras från huvudpanelen genom att enkelklicka på en spellistas namn i rutan <guilabel
>Välj spellista</guilabel
>. </para>

<para
>Ta bort en spellista genom att klicka på namnet, och välj sedan <menuchoice
><guimenu
>Arkiv</guimenu
> <guimenuitem
>Ta bort</guimenuitem
> </menuchoice
>. </para>

<para
>Den vertikala linjen som skiljer kataloglistan från spellistan kan dras från vänster till höger med musen. Den horisontella linjen som avdelar de här två från spellistenamnen kan dras uppåt och neråt. </para>

</sect1>

<sect1 id="midi-filenames">
<title
>Midi-filnamn </title>

<para
>Namnen på midi-filer som syns på huvudpanelen kan skilja sig lite grand från de verkliga filnamnen. Av läsbarhetsskäl, byter &kmidi; ut alla <quote
>_</quote
> i midi-filnamnet mot mellanslag, och hugger av filändelsen <literal role="extension"
>.mid</literal
>/<literal role="extension"
>.MID</literal
> om den finns. </para>

</sect1>

<sect1 id="configuring">
<title
>Anpassa </title>

<para
>Genom att klicka på knappen Anpassa i panelen visas en inställningsdialogruta där du kan välja bakgrundsfärg för panelens två fönster och <acronym
>LED</acronym
>-färgen. För närvarande kan inte färgen som används för slaginstrument i kanalmätaren anpassas, den är alltid gul. </para>

</sect1>

<sect1 id="patchsets">
<title
>Instrumentuppsättningar </title>

<para
>I nedre panelen, längst upp till vänster, finns valet av instrumentuppsättning. Det finns tre uppsättningar med &kmidi;s distribution: <guilabel
>piano+gitarr</guilabel
>, <guilabel
>piano</guilabel
>, och <guilabel
>gitarr</guilabel
>. Det finns ingen riktig anledning att välja uppsättningarna piano eller gitarr, de finns bara med som exempel. När du skaffar flera instrumentuppsättningar, kan du ställa in så att du kan byta mellan dem i panelen. Det här görs på följande sätt: </para>

<para
>Skapa en <literal role="extension"
>cfg</literal
>-fil för varje instrumentuppsättning som beskriver patcherna och deras bank- och instrumentnummer (midi-program). Skriv sedan in raden <userinput
>source <replaceable
>filnamn</replaceable
></userinput
> och <userinput
>if <replaceable
>n</replaceable
></userinput
> på föregående rad, i filen <filename
>timidity.cfg</filename
>, där <replaceable
>filnamn</replaceable
> är namnet som du angav för filen som beskriver patcherna, och <replaceable
>n</replaceable
> är raden som <replaceable
>filnamn</replaceable
> ska visas i &kmidi;s panel i rutan <guilabel
>Välj instrumentuppsättning</guilabel
>. Genom att klicka på det här namnet så väljs instrumentuppsättningen. Numreringen av uppsättningarna börjar på 0. </para>

<para
>Banker/trummor och namn på patcher måste anges i <literal role="extension"
>cfg</literal
>-filer, eftersom de som inte anges inte kommer att laddas från filer (<acronym
>GUS</acronym
>-patchfiler eller ljudteckensnitt) även om patcherna är tillgängliga. På det här sättet är det lätt att utesluta vissa patcher från ett ljudteckensnitt för att ladda bättre från ett senare teckensnitt. Deklarera dem bara inte innan du bett att teckensnittet ska laddas. </para>

<para
>När samma patch för samma bank eller trummor anges mer än en gång, räknas bara den första. Ange därför de bästa teckensnitten först. </para>

<para
>Det finns ett verktyg <command
>sf2cfg</command
> för att skapa en <literal role="extension"
>cfg</literal
>-fil för ett <literal role="extension"
>sbk</literal
>/<literal role="extension"
>sf2</literal
>-ljudteckensnitt, som ger ifrån sig alla patcher som finns i teckensnittet. Jag har också inkluderat exempel på <literal role="extension"
>cfg</literal
>-filer för <filename
>chaos8m.sf2</filename
> och <filename
>chaos12m.sf2</filename
>. </para>

</sect1>

<sect1 id="polyphony">
<title
>Polyfoni </title>

<para
>Hör du pauser i musiken? Det är möjligt att &kmidi; inte hinner med att göra alla de beräkningar som behövs för att justera tonhöjden för instrumentpatcher, filtrera signalen, kombinera toner, och så vidare. Om detta inträffar, kan du kanske förbättra situationen genom att använda nummerinmatningsrutan till höger i den nedre panelen. Den justerar maximala antalet polyfoniska <quote
>röster</quote
> som används samtidigt. När du minskar den maximala polyfonin, lättar du bördan för &kmidi; på bekostnad av en del korus eller ekoeffekter, eller att vissa toner huggs av eller utelämnas helt (i vissa fall skapar &kmidi; extra toner för att åstadkomma köreffekter och eko). </para>

</sect1>

<sect1 id="effects">
<title
>Ljudeffekter </title>

<para
>Ljudeffekter ändrar ljudet på olika sätt, som jag inte alltid har helt klart för mig. Det finns fyra sätt ljudeffekter kan begäras, och två sätt som de kan styras. </para>

<para
>En midi-sång kan ange en ljudeffekt för alla instrument som spelar på vilken som helst av de 16 midi-kanalerna. Eller så kan den ange flera effekter för flera kanaler. När du trycker in panelens knapp <guibutton
>eff</guibutton
>, filtreras signalen för att åstadkomma midi-effekterna: korus, eko, celeste och phaser. Men det blir inga effekter om inte sången i midi-filen begär det. Två av standardeffekterna, harmoni och klarhet, är ännu inte implementerade med filter (Filtren kodades av Nicolas Witczak). </para>

<para
>Om du inte trycker in knappen <guibutton
>eff</guibutton
>, får du fortfarande några korus- och ekoeffekter på kanaler där det begärs, men det åstadkoms på ett annat sätt. Istället för att använda filter, skapas nu extra toner. De är något ostämda för koruseffekten, och något fördröjda för eko. Några justeringar till tonenveloppen och vibratot görs också. Med <guibutton
>eff</guibutton
> avstängd, fås inga kanaler med celeste eller phasereffekter. </para>

<para
>Ett annat sätt som ljudeffekter kan begäras är via en patch. Det vill säga att en instrumentpatch kan innehålla förslag på korus- och/eller ekonivå. AWE patcher anger i allmänhet effekter, medan Gravis-Forte patcher inte gör det (detta är orsaken till att AWE instrumentuppsättningar har en tendens att låta lite fylliga). Ljudeffekter som begärs på det här sättet skapas med metoden med extra toner, och påverkas inte av knappen <guibutton
>eff</guibutton
>. </para>

<para
>Som tredje metod, kan du begära effekter. Observera de fyra kryssrutorna till höger i panelen. Var och en av dem har tre tillstånd: normal (förvalt), extra, och av. De två kryssrutorna i mitten styr <guilabel
>korus</guilabel
> och <guilabel
>eko</guilabel
>. Om de ställs in till <guilabel
>normal</guilabel
>, hanteras ljudeffekter som beskrivits ovan. När de ställs in till <guilabel
>extra</guilabel
>, skapas extra toner för korus eller eko för alla instrument och alla kanaler, oavsett de effektfilter som begärs genom att klicka på <guilabel
>eff</guilabel
>. När de ställs in till <guilabel
>av</guilabel
>, skapas inga extra korus- eller ekotoner. </para>

<para
>Till sist, kan effekter begäras av ett systemspecifikt midi-meddelande i en midi-fil, en så kallad <quote
>sysex</quote
>. Detta är avsett för att för att styra maskinvaran för en speciell synthesizer. &kmidi; avkodar i viss utsträckning olika sysex för Roland GS och Yamaha XG syntar och gör sitt bästa för att ändra ljudet i enlighet med dem. Korus, eko och variationer av de här görs med metoden med <quote
>extra toner</quote
> och kan stängas av med kryssrutorna som just nämnts. Om celestevariation av koruseffekten begärs av en XG sysex, så används dock Witczaks celestefilter, under förutsättning att knappen <guibutton
>eff</guibutton
> är intryckt. </para>

</sect1>

<sect1 id="command-line-options">
<title
>Kommandoradsväljare</title>

<para
>Förutom att ange namnen på en eller flera midi-filer på kommandoraden, är nog inte innehållet i det här avsnittet särskilt användbart att känna till. Om du behöver de här väljarna, föredrar du nog att använda kommandoradversionen av det här programmet: <application
>timidity</application
>. </para>

<cmdsynopsis
><command
>kmidi</command
> <group
><option
>options</option
> <arg
>filnamn</arg
> </group
> </cmdsynopsis>

<para
>Använd &quot;-&quot; som filnamn för att läsa en midi-fil från <filename class="devicefile"
>standardinmatningen</filename
>. </para>

<variablelist>
<title
>Väljare:</title>
<varlistentry>
<term
><option
>-o</option
> <parameter
>filnamn</parameter
></term>
<listitem>
<para
>Skicka utmatning till filnamnet, som kan vara en fil, enhet eller HP-UX ljudserver, beroende på utmatningsläget som anges med väljaren <option
>-O</option
>. Det speciella filnamnet ``-'' gör att utmatningen skickas till <filename class="devicefile"
>standardutmatningen</filename
>. </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-O</option
> <parameter
>läge</parameter
></term>
<listitem>
<para
>Väljer utmatningsläget bland de alternativ som har tagits med vid kompileringen. Läget måste börja med en av identifierarna för utmatningslägen som stöds. Kör <application
>TiMidity</application
> med väljaren <option
>-h</option
> för att visa en lista. </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-s</option
> <parameter
>frek</parameter
></term>
<listitem>
<para
>Ställ in samplingsfrekvensen till <parameter
>frek</parameter
> (Hz eller kHz). Alla ljudenheter klarar inte av alla frekvenser, en ungefärlig frekvens kan väljas, beroende på implementeringen. </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-a</option
></term>
<listitem>
<para
>Aktivera utjämningsfiltret. Samplingar körs genom ett lågpassfilter innan de spelas, som minskar störningar vid låga omsamplingsfrekvenser. </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-f</option
></term>
<listitem>
<para
>Aktivera läget för snabb avklingning. Växlar snabba envelopper. Vissa midi-filer låter bättre när toner avklingar långsammare, det ger ett intryck av efterklang. </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-p</option
> <parameter
>n</parameter
></term>
<listitem>
<para
>Ställer in polyfoni (maximalt antal samtidiga röster). </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-A</option
> <parameter
>n</parameter
></term>
<listitem>
<para
>Förstärk volymen med <parameter
>n</parameter
> procent (kan orsaka klippning) </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-C</option
> <parameter
>n</parameter
></term>
<listitem>
<para
>Ställer in förhållandet mellan samplings- och styrfrekvenser. Det här avgör hur ofta envelopper beräknas om, små förhållanden ger bättre kvalitet men använder mer <acronym
>CPU</acronym
>-tid. </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-E</option
></term>
<listitem>
<para
>Aktiverar Witczaks effektfiler för körljud, ekoeffekter, fasning och celeste. </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-&num;</option
> <parameter
>n</parameter
></term>
<listitem>
<para
>Välj instrumentuppsättning </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-L</option
> <parameter
>kat</parameter
></term>
<listitem>
<para
>Lägg till katalog till sökvägen </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-c</option
> <parameter
>fil</parameter
></term>
<listitem>
<para
>Läs extra anpassningsfil </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-I</option
> <parameter
>n</parameter
></term>
<listitem>
<para
>Använd program <parameter
>n</parameter
> som standardvärde </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-P</option
> <parameter
>fil</parameter
></term>
<listitem>
<para
>Använd patchen <parameter
>fil</parameter
> för alla program </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-D</option
> <parameter
>n</parameter
></term>
<listitem>
<para
>Spela trummor på kanal <parameter
>n</parameter
> </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-Q</option
> <parameter
>n</parameter
></term>
<listitem>
<para
>Ignorera kanal <parameter
>n</parameter
> </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-F</option
></term>
<listitem>
<para
>Aktivera snabbpanorering </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-U</option
></term>
<listitem>
<para
>Tag bort instrument från minnet mellan midi-filer </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-i</option
> <parameter
>läge</parameter
></term>
<listitem>
<para
>Välj användargränssnitt (se <link linkend="user-interfaces"
>nedan</link
> för en lista) </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-B</option
> <parameter
>n</parameter
></term>
<listitem>
<para
>Ange antal buffertfragment. </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-h</option
></term>
<listitem>
<para
>Visa hjälpmeddelandet </para>
</listitem>
</varlistentry>
</variablelist>

<variablelist>
<title
>Tillgängliga utmatningslägen (<option
>-0</option
>)</title>
<varlistentry>
<term
><option
>-O</option
> <parameter
>d</parameter
></term>
<listitem>
<para
>&Linux; <filename class="devicefile"
>dsp</filename
>-enhet </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-O</option
> <parameter
>w</parameter
></term>
<listitem>
<para
>RIFF WAVE-fil </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><option
>-O</option
> <parameter
>r</parameter
></term>
<listitem>
<para
>obehandlad vågformsdata </para>
</listitem>
</varlistentry>
</variablelist>

<variablelist>
<title
>Val av utmatningsformat (lägg till för <option
>-O</option
>)</title>
<varlistentry>
<term
><parameter
>`8'</parameter
></term>
<listitem>
<para
>8-bitars samplingsbredd </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><parameter
>`1'</parameter
></term>
<listitem>
<para
>16-bitars samplingsbredd </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><parameter
>`U'</parameter
></term>
<listitem>
<para
>kodning med uLaw </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><parameter
>`l'</parameter
></term>
<listitem>
<para
>linjär kodning </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><parameter
>`M'</parameter
></term>
<listitem>
<para
>mono </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><parameter
>`S'</parameter
></term>
<listitem>
<para
>stereo </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><parameter
>`s'</parameter
></term>
<listitem>
<para
>utmatning med tecken </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><parameter
>`u'</parameter
></term>
<listitem>
<para
>utmatning utan tecken </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><parameter
>`x'</parameter
></term>
<listitem>
<para
>utmatning med växlade byte </para>
</listitem>
</varlistentry>
</variablelist>

<variablelist>
<title
>Tillgängliga gränssnitt (lägg till för <option
>-i</option
>)</title>
<varlistentry>
<term
><parameter
>q</parameter
></term>
<listitem>
<para
>&kmidi; &Qt;-gränssnitt </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><parameter
>d</parameter
></term>
<listitem>
<para
>enkelt gränssnitt </para>
</listitem>
</varlistentry>
</variablelist>

<variablelist>
<title
>Gränssnittsalternativ (lägg till för <option
>-i</option
><parameter
>?</parameter
> väljaren)</title>
<varlistentry>
<term
><parameter
>`v'</parameter
></term>
<listitem>
<para
>fler utskrifter (samlas på) </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><parameter
>`q'</parameter
></term>
<listitem>
<para
>mindre utskrifter (samlas på) </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><parameter
>`t'</parameter
></term>
<listitem>
<para
>spåra uppspelning </para>
</listitem>
</varlistentry>

<varlistentry>
<term
><parameter
>-i</parameter
></term>
<listitem>
<para
>välj användargränssnitt (se nedan för en lista) </para>
</listitem>
</varlistentry>
</variablelist>

</sect1>
</chapter>

<chapter id="questions-and-answers">
<title
>Vanliga frågor</title>

<qandaset>
<qandaentry>
<question>
<para
>Var skaffar jag en fullständigt instrumentuppsättning? </para>
</question>
<answer>
<para
>Var god se motsvarande <link linkend="patches"
>avsnitt</link
> i &kmidi;s installationskapitel. </para>
</answer>
</qandaentry>
</qandaset>

</chapter>

<chapter id="design">
<title
>Konstruktion </title>

<sect1 id="processes">
<title
>Processer </title>

<para
>&kmidi; är användargränssnittet som hanterar skärmvisningen och knapptryckningar, etc. Det kör som en separat process från &timidity;, som läser och spelar midi-filer. </para>
</sect1>

<sect1 id="synthesis-model">
<title
>Syntesmodell</title>

<para
>&timidity; har en tongenerator, två enveloppgeneratorer, tre lågfrekventa sinusvågsoscillatorer, ett lågpassfilter, och en ljudeffektenhet. (Lågpassfiltret används bara om &kmidi;s fjärde interpolationsläge väljs och knappen <quote
>filt</quote
> är intryckt, för närvarande fungerar det inte bra). </para>

<para
>Tongeneratorn samplar om instrumentpatcher för grundfrekvenserna som är lämpliga för enskilda toner som spelas (Interpolationsalgoritmen som används kan väljas med de fyra kryssrutorna i den övre panelen). </para>

<para
>Enveloppgeneratorerna modulerar varje ton med i tur och ordning: en attackfas, en hållfas, en avklingning och en släppfas. En av generatorerna påverkar ljudstyrkan, och de andra påverkar tonhöjden och/eller klippningsfrekvensen på lågpassfiltret. </para>

<para
>Lågfrekvensoscillatorerna modulerar ljudstyrkan (för tremolo), frekvensen (för vibrato), och lågpassfiltrets klippningsfrekvens (XG <quote
>rezosvep</quote
>). </para>

<para
>Effektenheten tillhandahåller eko, ostämda toner, efterklang, koruseffekt, celeste och phasereffekt. Eko (som görs genom att skapa extra ekotoner) och efterklang (som görs med ett filter) skapar midi-ekoeffekter. Ostämda toner (som görs genom att skapa extra toner med ändrad tonhöjd) och koruseffekt (som görs med ett filter) skapar midi-korus (Effektfilter är bara aktiverade när &kmidi;s knapp <guibutton
>eff</guibutton
> är intryckt. Eko och ostämt kan styras med de två kryssrutorna i mitten till höger i den nedre panelen, och från menyerna Korus och Ekoeffekter). </para>

<para
>Instrument kan ha antingen ett eller två tonelement, och för vart och ett av dessa, kan en instrumentuppsättning tillhandahålla separata patcher för olika tonstyrkeområden (vanligt för pianon) och för olika tonhöjdsområden. GUS instrumentuppsättningar tillhandahåller dock bara ett tonelement, och ett styrkeområde per instrument (Om du klickar på kryssrutan längst till höger i den nedre panelen, visar &kmidi;s informationsfönster namnen på patcherna, <computeroutput
>(2)</computeroutput
> om de har två tonelement, och tonstyrkeområdet när de laddas). </para>
</sect1>

<sect1 id="midi-implementation">
<title
>Midi-implementering </title>

<para
>Nästan alla midi-meddelanden och styrenheter som jag känner till är implementerade på något sätt (vilket betyder att de gör att något händer, men inte nödvändigtvis det som ska hända). NRPN-styrenheter för att ange attack- och avklingningstid är inte implementerade, eftersom jag ännu inte har hittat några midi-filer som använder dem. Flänsstyrenheten är inte implementerad (även om flänsning som begärs av en XG sysex är det). Bara ett fåtal av de maskinvaruorienterade styrenheterna i Roland- och Yamahaspecifika dumpar är implementerade. </para>

<para
>&timidity; kan hantera midi-filer som är avsedda att spelas på upp till fyra syntar, och hålla isär de fyra uppsättningarna med 16 kanaler för varje synt. I midi-filen måste syntarna dock väljas med portkommandon (antingen med Roland-GS eller Yamaha-XG sysex dumpar). Vissa midi-filer som är avsedda för flera syntar har inte portkommandon (Info-fönstret visar portkommandon om de finns). </para>

<para
>De vertikala staplarna i &kmidi; som visar kanalaktivitet är begränsad till två uppsättningar med 16 kanaler. Kanaldiagrammet med horisontella staplar för patcher är begränsad till bara en uppsättning med 16 kanaler. </para>
</sect1>

<sect1 id="volume">
<title
>Volym </title>

<para
>Jag har minskat volymnivåerna som &timidity; skapar en hel del, jämfört med den ursprungliga implementeringen. Det här minimera klippning och ger ett ökat dynamiskt omfång (Nu kan det tyvärr finnas vissa störningar vid låga volymer). Om du behöver högre volym, föreslår jag att du ökar den någon annanstans, antingen med &kmix; för att öka linjevolymen, mixervolymen för <filename class="devicefile"
>/dev/dsp</filename
>, eller öka volymen i hörlurar, förstärkta högtalare, eller något annat. </para>
</sect1>

<sect1 id="computation-issues">
<title
>Beräkningshänsyn</title>

<para
>&timidity; kan bli efter med att beräkna data att skicka till ljuddrivrutinen, och då uppstår pauser i musiken. &timidity; försöker förutse möjligheten för en paus genom att övervaka tillståndet för sina utmatningsbuffrar och buffrarna i ljuddrivrutinen, och när det inte finns mycket i dem försöker den komma ifatt genom att minimera beräkningarna som måste göras: den använder en grövre interpolationsrutin i återsamplingen, slutar göra extra eko- och ostämda toner för eko- och koruseffekter, och börjar avsluta toner tidigare, eller hoppar till och med över toner helt och hållet. Därför, beroende på midi-sång, instrumentuppsättning, hur snabbt systemet är, även om du inte hör pauser, kan du märka en kvalitetsförlust när &timidity; belastas mer. Lamporna i &kmidi;s huvudpanel ger en bild av hur desperat &timidity; har blivit i sina försök att hålla musiken igång. Tecken på desperation: bufferlampan går från hälsosamt grön till upptaget orange, interpolationslampan släcks (vilket betyder att linjär interpolation används för återsampling), ekolampan släcks, eller körlampan släcks (vilket betyder att inga extra eko eller ostämda toner spelas). </para>

<para
>Att övervaka utmatningsbuffrarna innebär att ljuddrivrutinen måste anropas för att ta reda på hur mycket data som har buffrats. Jag vet hur detta görs med Hannu Savolainens <acronym
>OSS</acronym
>-drivrutin (&Linux; och vissa andra system), kanske för äldre Sun-maskiner (det fungerade förut), men inte med andra drivrutiner. </para>

<para
>Man kan minska beräkningsbördan för &timidity; med olika manövrar: </para>

<orderedlist>
<listitem>
<para
>Reducera den tillåtna polyfonin (nummerinmatningsrutan i den nedre panelen). </para>
</listitem>
<listitem>
<para
>Stänga av knappen <guibutton
>eff</guibutton
>. </para>
</listitem>
<listitem>
<para
>Välja enklare återsamplingsinterpolation (en av kryssrutorna på den övre panelen, längs till vänster). </para>
</listitem>
<listitem>
<para
>Stänga av eko, ostämt, eller stereo, med de vänstra tre kryssrutorna på den nedre panelen. </para>
</listitem>
<listitem>
<para
>Välja inställningen <guimenuitem
>Torr</guimenuitem
> på menyn <guimenu
>Ekoeffekter</guimenu
>. </para>
</listitem>
</orderedlist>

<para
>Naturligtvis blir det i allmänhet någon motsvarande kvalitetsförlust. Att ha knappen <guibutton
>filt</guibutton
> intryckt kostar ingenting om du inte också har valt interpolationsinställningen <guibutton
>cspline</guibutton
> + <guibutton
>filter</guibutton
>. </para>

</sect1>

<sect1 id="memory-issues">
<title
>Minneshänsyn </title>

<para
>Det är möjligt att &timidity; kan använda en överdrivet stor mängd minne för patcher. Symptom på detta är att fönstersystemet blir mycket slött, eller kraschar. Det här är troligen bara ett problem om stora sf2 ljudteckensnitt med mer än 30 Mibyte används. Pianopatcherna i Personal Choice's PC400 ljudteckensnitt kan till exempel uppta 25 Mibyte vardera. Efter att ha spelat en lista med midi-filer som använder tre sådana pianon, så har 75 Mibyte minne används bara så där. I inställningsdialogrutan låter &kmidi; dig ange det maximala antalet Mibyte som används för att behålla patcher som använts för att spela tidigare midi-filer. När detta maximum överskrids, frigör &timidity; de patcher som inte har används på längst tid, och återger minne till systemet. Det förvalda maximala värdet är 60 Mibyte, som fungerar bra på mitt system (Jag har 48 Mibyte minne och 196 Mibyte cache). Att ställa in det här till ett lägre värde betyder att fler patcher måste laddas om från patchfiler när du spelar en lista med midi-sånger, som gör allt långsammare. Om du har gott om minne, kan du ställa in <guilabel
>no limit</guilabel
>. </para>

<para
>Om du tillåter tillräckligt med utrymme, läses hela ljudteckensnitt på en gång, istället för en patch i taget. Att ställa in det maximala värdet för lågt kan motverka sitt eget syfte, eftersom en hel ljudteckensnittsfil upptar mycket mindre minne totalt sett när hela filen läses, än när patcher läses individuellt (jag vet inte varför). </para>

<para
>För system med minst signifikant byte först, som x86, så används minnesmappning istället. Det här är mycket snabbare vid uppstart. Jag har inte kommit på ett sätt att göra detta för system med mest signifikant byte först. </para>

<para
>Efter att ha spelat varje midi-fil, rapporterar &kmidi; om hur mycket minne som för närvarande används av patcher i info-fönstret. </para>

<para
>Om du inte har mycket huvudminne eller cacheminne, kanske inte ett lågt maximalt värde för patchminnet förhindrar att &kmidi; kraschar systemet. Var därför försiktig med att använda stora ljudteckensnitt. </para>
</sect1>

</chapter>

<chapter id="license-and-credits">
<title
>Licenser och tack till</title>

<para
>&kmidi; använder Tuukka Toivonen's &timidity; 0.2i ljudmotor Copyright (C) 1995 Tuukka Toivonen <email
>toivonen@clinet.fi</email
>. I själva verket ingår en utökad version av Tuukkas originalprogram med fem andra alternativa användargränssnitt i &kmidi;s distribution (Se nedan för information om hur &timidity; kompileras). </para>

<para
>&kmidi; och &timidity; använder utökningen för AWE ljudteckensnitt gjord av Takashi Iwai <email
>iwai@dragon.mm.t.u-tokyo.ac.jp</email
> och utökningen för <acronym
>AMD</acronym
>-InterWave gjord av Greg Lee <email
>lee@hawaii.edu</email
> som gör att ljudteckensnitt (<literal role="extension"
>.sbk</literal
>/<literal role="extension"
>.sf2</literal
>-filer) och <acronym
>IW</acronym
> instrumentuppsättningar (<literal role="extension"
>.fff</literal
>/<literal role="extension"
>.dat</literal
>-filer) kan användas förutom Gravis/Forte <literal role="extension"
>.pat</literal
>-filer. </para>

</chapter>

<chapter id="copyright">
<title
>Copyright </title>

<para
>&kmidi; Copyright 1997 Bernd Johannes Wuebben <email
>wuebben@kde.org</email
> </para>

<para
>&kmidi; använder Tuukka Toivonen's &timidity; 0.2i spelmotor, Copyright &copy; 1995 Tukka Toivonen <email
>toivonen@clinet.fi</email
>. </para>
&underFDL; &underGPL; </chapter>

<appendix id="installation">
<title
>Installation</title>

<sect1 id="how-to-obtain-kmidi">
<title
>Hur man skaffar &kmidi;</title>

<para
>&kmidi; är en del av &kde;-projektet <ulink url="http://www.kde.org"
>http://www.kde.org</ulink
>. &kmidi; finns på <ulink url="ftp://ftp.kde.org/pub/kde/"
>ftp://ftp.kde.org/pub/kde/</ulink
>, &kde;-projektets huvudsakliga &FTP;-plats. </para>
</sect1>

<sect1 id="requirements">
<title
>Krav</title>

<para
>För att kompilera &kmidi; med lyckat resultat, behöver du lämpliga versioner av programbiblioteken i <literal
>kdelibs</literal
>. Alla bibliotek som krävs samt &kmidi; själv finns på <ulink url="ftp://ftp.kde.org/pub/kde/"
>ftp://ftp.kde.org/pub/kde</ulink
>. </para>

<para
>Alla standardtyper av &UNIX;-system ska fungera för att kompilera det <quote
>enkla</quote
> kommandoradgränssnittet för &timidity;. De övriga gränssnitten har särskilda krav (se de olika <filename
>README</filename
>-filerna i distributionen). &Motif;-gränssnittet fungerar förhållandevis bra med <application
>Lesstif</application
>, men bättre med &Motif;. </para>

</sect1>

<sect1 id="compilation-and-installation">

<title
>Kompilering och installation</title>

<para
>Om du har installerat &kmidi; tidigare, är det förnuftigt att flytta konfigurationskatalogen (troligen <filename
>&dollar;<envar
>KDEDIR</envar
>/share/apps/kmidi/config/</filename
>) innan den nya versionen installeras, eftersom filerna som ska finnas där har ändrats, och du säkert vill använda eller åtminstone titta på de nya versionerna. På samma sätt, innan versionen av &timidity; som inte stöder &kde; installeras, säkerhetskopiera <filename class="directory"
>/usr/local/lib/timidity/</filename
>. Å andra sidan, för en fullständigt ny installation ska du ta bort alla filer i de här två katalogerna, eftersom de gamla filerna kanske inte ersätts av nya versioner. </para>

<para
>Om du har hela kdemultimedia-distributionen, byt katalog till katalogen kdemultimedia och skriv </para>

<screen
><prompt
>&percnt;</prompt
><userinput
><command
>./configure</command
></userinput
></screen>

<para
>Som ett alternativ, för att inkludera alla andra användargränssnitt: <anchor id="user-interfaces"/> </para>

<screen
><prompt
>&percnt;</prompt
><userinput
><command
>./configure</command>
<option
>--enable-interface</option
>=<parameter
>ncurses</parameter
>,<parameter
>xaw</parameter
>,<parameter
>gtk</parameter
>,<parameter
>tcltk</parameter
>,<parameter
>slang</parameter
>,<parameter
>motif</parameter
></userinput
></screen>

<para
>Därefter, för att bygga alla multimediaprogram, stanna kvar i katalogen, eller för att bara bygga &kmidi;, <command
>cd</command
> till katalogen <filename class="directory"
>kmidi</filename
>, och skriv </para>

<screen
><prompt
>&percnt;</prompt
> <userinput
><command
>make</command
></userinput>
<prompt
>&percnt;</prompt
> <userinput
><command
>make</command
> <option
>install</option
></userinput
>
</screen>

<para
>Versionen av &timidity; som inte stöder &kde;, <command
>timidity</command
>, kompileras och installeras samtidigt som &kmidi;. Manualsidan <filename
>timidity.1</filename
> installeras dock inte automatiskt i <filename class="directory"
>/usr/man/man1/</filename
>. </para>

</sect1>

<sect1 id="patches">
<title
>Var kan man skaffa en fullständig uppsättning patcher?</title>

<para
>Det finns två sorters patcher som &kmidi;/&timidity; kan använda: <acronym
>GUS</acronym
>-patcher och AWE32 ljudteckensnitt (<literal role="extension"
>sf2</literal
>-filer). En uppsättning samplingar och parametrar för ett enstaka instrument, en patch, finns i en separat fil för <acronym
>GUS</acronym
>-patcher, men AWE ljudteckensnitt lägger allt i en enda <literal role="extension"
>.sf2</literal
>-fil (eller <literal role="extension"
>.sbk</literal
>). </para>

<para
>Jag rekommenderar <literal role="extension"
>.sf2</literal
> ljudteckensnitt, och bland dessa, Chaos-teckensnitten som nämns nedan, i turordning. </para>

<para
>Öppna &kmidi;s inställningsdialogruta för att se länkar till några webbsidor med instrumentuppsättningar. Här är några andra ställen att skaffa patcher: </para>

<para
>Dan Hollis <email
>goemon@anime.net</email
> har sammanställt en instrumentuppsättning. Besök gärna hans sida på <ulink url="http://www.anime.net/~goemon/timidity"
>http://www.anime.net/~goemon/timidity</ulink
> och hjälp honom göra den här till den bästa tillgängliga uppsättningen. </para>

<para
><emphasis
>Nyhet:</emphasis
> Jag har laddat upp den ovanstående uppsättningen till ftp.kde.org. Den finns för närvarande på <ulink url="ftp://fiwi02.wiwi.uni-tuebingen.de/pub/kde/stable/Beta2/apps/multimedia/sound/"
>ftp://fiwi02.wiwi.uni-tuebingen.de/pub/kde/stable/ Beta2/apps/multimedia/sound/</ulink
>, men jag förväntar mig att vi flyttar omkring den lite grand tills vi hittar en bra plats för den. Så leta bara runt lite grand på ftp.kde.org, om uppsättningen inte lägre finns på platsen som anges ovan, när du väl läser det här.</para>

<para
>Patcher finns också paketerade som deb- eller rpm-moduler på Sunsite-arkivet:</para>

<para
><itemizedlist>
<listitem>
<para
>Debian: <ulink url="ftp://sunsite.unc.edu/pub/Linux/distributions/debian/bo/source/sound/timidity-patches_0.1.tar.gz"
>timidity-patches_0.1.tar.gz</ulink
></para>
</listitem>
<listitem>
<para
>RPM: <ulink url="ftp://sunsite.unc.edu/pub/Linux/distributions/redhat/contrib/oldrpms/contrib-2.0.x/RPMS/timidity-patches-1-1.i386.rpm"
>timidity-patches-1-1.i386.rpm</ulink
></para>
</listitem>
<listitem>
<para
>RPM: <ulink url="ftp://sunsite.unc.edu/pub/Linux/distributions/redhat/contrib/oldrpms/contrib-2.0.x/SRPMS/timditiy-patches-1-1.src.rpm-try2"
>timidity-patches-1-1.src.rpm-try2</ulink
></para>
</listitem>
</itemizedlist>
</para>

<para
>Jag har inte (ännu) provat de ovanstående, och använder personligen Midia-uppsättningen tillsammans med några ytterligare patcher och ett antal ytterligare trummor. Midia-uppsättningen finns på: <ulink url="ftp://archive.cs.umbc.edu/pub/midia/"
>ftp://archive.cs.umbc.edu/pub/midia/</ulink
>.</para>

<para
>För ytterligare patcher och trummor: (skaffa gsdrum- och wow-patcherna) <ulink url="ftp://ftp.cdrom.com/pub/gus/sound/patches/files/"
>ftp://ftp/cdrom.com/pub/gus/sound/patches/files/</ulink
>.</para>

<para
>Vincent Pagel har sammanställt en uppsättning med patcher. Den här länken kan bara nås nattetid (Paris). <ulink url="ftp://sig.enst.fr/pub/midi/instruments/"
>ftp://sig.enst.fr/pub/midi/instruments/</ulink
>. Konfigurationsfilen som hör ihop med hans instrumentuppsättning finns <ulink url="ftp://sig.enst.fr/pub/midi/timidity_pagel.cfg"
>här</ulink
>.</para>

<para
>Titta också på <ulink url="http://www.clinet.fi/~toivonen/timidity/"
>Timiditys hemsida</ulink
>.</para>

<para
>Titta på <ulink url="bahamut.mm.t.u-tokyo.ac.jp/~iwai/midi.html#TiMidity"
>Takashis hemsida</ulink
>. Takashis hemsida rekommenderar AWE32 ljudteckensnittet på 8 Mibyte <literal
>chaos8m.sf2</literal
> och AWE32 ljudteckensnittet på 12 Mibyte <literal
>chaos12m.sf2</literal
>, tillgängliga på <ulink url="http://soback.kornet.nm.kr/~chaos/sbawe32/sbawe32.htm"
></ulink
>, som är mycket trevliga (de är paketerade som självuppackande <literal
>.exe</literal
>-filer).</para>

<sect2 id="patch-set-installation">
<title
>Installera instrumentuppsättningar</title>

<para
>Vissa av de ovanstående instrumentuppsättningarna levereras med en <literal role="extension"
>.cfg</literal
>-konfigurationsfil som liknar de .cfg-filer som levereras med KMidi och finns i <filename class="directory"
>KDEDIR/share/apps/kmidi/config</filename
>. &kmidi; har färdiga konfigurationsfiler för ett antal vanliga instrumentuppsättningar, som Midia-uppsättningen. För <literal role="extension"
>.sf2</literal
> ljudteckensnitt, tillhandahålls ett verktyg, <literal role="extension"
>sf2cfg</literal
>, som skapar en <literal role="extension"
>.cfg</literal
>-fil från ett <literal role="extension"
>.sf2</literal
>-teckensnitt. Det kompileras samtidigt som &timidity;.</para>

<para
>Det är inte nödvändigt att ge <literal role="extension"
>.cfg</literal
>-filer namn med filändelsen <literal role="extension"
>.cfg</literal
>. De är vanliga textfiler med en struktur som beskrivs i ett annat avsnitt i den här handboken.</para>

<para
>För att avsluta installationen av en fullständig instrumentuppsättning, redigera filen <filename
>timidity.cfg</filename
> och ange lämpliga konfigurationsfiler för uppsättningarna som laddades ner. Titta i <filename
>timidity.cfg</filename
> för ett exempel. Det är allt. Nu kan du fortsätta och spela övriga midi-filer som finns med i &kmidi;-distributionen (och förstås alla andra också).</para>

</sect2>

<sect2 id="miscellaneous">
<title
>Diverse</title>

<para
>Ibland märker du att &kmidi; inte kan hitta en patch för ett visst instrument (öppna info-fönstret för att se den här informationen). Om så är fallet, är allt du behöver göra att skaffa den saknade patchen och installera den genom att flytta patchen till katalogen patch/ och redigera instrumentuppsättningen i <literal role="extension"
>.cfg</literal
>-filen för att tala om för &kmidi; att nu är den nya patchen tillgänglig. </para>

<para
>Ibland låter ett visst instrument inte alls särskilt bra. Om så är fallet, skaffa helt enkelt en annan patch från någon av Ultrasound-arkiven och byt ut den mindre bra patchen mot en bättre. Som du förstår, är det helt din egen sak hur bra varje instrument låter. Du kan till och med göra dina egna patcher med verktyget <command
>pat2wav</command
>, som ingår i &kmidi;-distributionen.</para>
</sect2>
</sect1>
</appendix>

</book>
<!--
Local Variables:
mode: sgml
sgml-omittag: nil
sgml-shorttag: t
End:
-->

