<part id="kde-for-administrators">
<partinfo>
<authorgroup>
<author
><personname
> <firstname
>Waldo</firstname
> <surname
>Bastian</surname
> </personname
> <email
>bastian@kde.org</email
> </author>
<othercredit role="reviewer"
>&Philip.Rodrigues; &Philip.Rodrigues.mail; </othercredit>
</authorgroup>
</partinfo>

<title
>&kde; para Administradores</title>

<chapter id="kde-internals">
<title
>Detalhes do &kde;</title>

<sect1 id="kde-for-admins-overview">
<title
>Introdução</title>
<para
>por escrever</para>
</sect1>

<sect1 id="directory-layout">
<title
>Disposição das Pastas</title>

<para
>O &kde; define uma hierarquia de sistema de ficheiros que é usada pelo próprio ambiente do &kde;. assim como por todas as aplicações do &kde;. De um modo geral, o &kde; guarda todos os seus ficheiros numa árvore de pastas com uma estrutura fixa. </para>

<para
>Por omissão, o &kde; usa duas árvores de pastas:</para>

<itemizedlist>
<listitem
><para
>Uma ao nível do sistema (por exemplo, a <filename class="directory"
>/opt/kde3</filename
>).</para
></listitem>
<listitem
><para
>Uma ao nível do utilizador, na pasta pessoal do mesmo (normalmente a <filename class="directory"
> ~/.kde</filename
>)</para
></listitem>
</itemizedlist>

<para
>Como administrador do sistema, poderá criar árvores adicionais. Essas árvores adicionais poderão ser usadas no caso dos <link linkend="user-profiles"
>perfis</link
></para>

<informalexample
><para
>O &SuSE; &Linux; usa por exemplo:</para>

<itemizedlist>
<listitem
><para
><filename
class="directory"
>$<envar
>HOME</envar
>/.kde</filename
></para
></listitem>
<listitem
><para
><filename class="directory"
>/opt/kde3</filename
>. (Esta é específica do &SuSE;; as outras distribuições poderão usar a <filename class="directory"
>/usr</filename
> ou a <filename class="directory"
>/usr/kde3</filename
>)</para
></listitem>
<listitem
><para
><filename class="directory"
>/etc/opt/kde3</filename
>. (Isto foi adicionado pelo  &SuSE;).</para
></listitem>
</itemizedlist>

<para
>Se tiver a ferramenta KIOSK Admin v0.7 ou posterior, poderá verificar as árvores de pastas que são usadas com o seguinte comando: <userinput
><command
>kiosktool-kdedirs</command
> <option
>--check</option
></userinput
></para>
</informalexample>

<para
>O &kde; e as suas aplicações procuram os ficheiros, percorrendo todas as árvores de pastas do &kde;. As árvores de pastas são verificadas por ordem de precedência. Quando um ficheiro está presente em várias árvores de pastas, o ficheiro da última árvore é o que toma precedência. Normalmente, a estrutura localizada na pasta pessoal do utilizador tem a precedência maior. Esta é também a árvore de pastas em que as alterações são gravadas.</para>

<informalexample>
<para
>Para mais informações sobre o tipo &MIME; <literal
>text/plain</literal
>, são procurados os seguintes ficheiros:</para>

<itemizedlist>
<listitem
><para
><filename
class="directory"
>$<envar
>HOME</envar
>/.kde/share/mimelnk/text/plain.desktop</filename
></para
></listitem>
<listitem
><para
><filename
class="directory"
>/opt/kde3/share/mimelnk/text/plain.desktop</filename
></para
></listitem>
<listitem
><para
><filename
class="directory"
>/etc/opt/kde3/share/mimelnk/text/plain.desktop</filename
></para
></listitem>
</itemizedlist>

<para
>Se o utilizador fizer uma alteração, esta é aplicada em <filename class="directory"
>$<envar
>HOME</envar
>/.kde/share/mimelnk/text/plain.desktop</filename
></para>
</informalexample>

<para
>Para os ficheiros de configuração, a história é ligeiramente diferente. Se existirem vários ficheiros de configuração dispersos pelas árvores de pastas com o mesmo nome, o seu conteúdo será reunido. A ordem de precedência das árvores de pastas tem um papel importante aqui. Quando dois ficheiros definem a mesma chave de configuração, o ficheiro com a maior precedência determina o valor que é usado para a chave.</para>

<informalexample
><para
>Por exemplo, se existirem os seguintes dois ficheiros, com este conteúdo:</para>
<variablelist>
<varlistentry
><term
><filename
>$<envar
>HOME</envar
>/.kde/share/config/foobar</filename
></term>
<listitem
><programlisting
>Cor=vermelho
Forma=circulo
</programlisting>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename
>/etc/opt/kde3/share/config/foobar</filename
></term>
<listitem
><programlisting
>Cor=azul
Posicao=10,10
</programlisting>
</listitem>
</varlistentry>
</variablelist>

<para
>Os ficheiro serão reunidos para resultarem em:</para>

<programlisting
>Cor=vermelho
Forma=circulo
Posicao=10,10
</programlisting>

</informalexample>
</sect1>

<sect1 id="specifying-directories">
<title
>Indicar Pastas</title>

<para>

<segmentedlist>
<segtitle
>Variável de Ambiente</segtitle>
<segtitle
>Configurações de Exemplo</segtitle>
<segtitle
>Comentário</segtitle>

<seglistitem>
<seg
><envar
>KDEHOME</envar
></seg>
<seg
><filename class="directory"
>~/.kde</filename
></seg>
<seg
></seg>
</seglistitem>

<seglistitem>
<seg
><envar
>KDEROOTHOME</envar
></seg>
<seg
><filename class="directory"
>/root/.kde</filename
></seg>
<seg
>Uma variável diferente para evitar que o 'root' escreva na $KDEHOME do utilizador, após ter executado o <command
>su</command
>.</seg>
</seglistitem>

<seglistitem>
<seg
><envar
>KDEDIR</envar
></seg>
<seg
><filename class="directory"
>/opt/kde3</filename
>, <filename class="directory"
>/usr</filename
>, <filename class="directory"
>/usr/kde3</filename
></seg>
<seg
>Depende do distribuidor. É usado pelo &kde; 2. Se não estiver definido, recorre ao valor predefinido na compilação.</seg>
</seglistitem>

<seglistitem>
<seg
><envar
>KDEDIRS</envar
></seg>
<seg
><filename class="directory"
>/opt/kde3</filename
>, <filename class="directory"
>/usr</filename
>, <filename class="directory"
>/usr/kde3</filename
></seg>
<seg
>Novo no &kde;3. Poderá indicar várias localizações, separadas por dois-pontos (:). Se não estiver definida, baseia-se no valor da $<envar
>KDEDIR</envar
></seg>
</seglistitem>

</segmentedlist>
</para>
<para
>Não é <emphasis
>necessário</emphasis
> estar definido, os valores por omissão funcionam optimamente.</para>
<para
>Executar o &kde;2 com o &kde;3? Aponte o $<envar
>KDEDIR</envar
> para o &kde; 2 e o $<envar
>KDEDIRS</envar
> para o &kde; 3.</para>

<informalexample>
<para
>Um membro da equipa de uma universidade poderia ter a seguinte configuração:</para>
<programlisting
>KDEHOME='~/.kde3'
KDEROOTHOME='/root/.kde3'
KDEDIRS='/opt/kde_pessoal:/opt/kde3'
</programlisting>

</informalexample>

</sect1>

<sect1 id="user-profiles">
<title
>Perfis do Utilizador</title>

<para
>No exemplo anterior, o <filename class="directory"
>/opt/kde_pessoal</filename
> continha configurações e aplicações adicionais para os membros da equipa. Os <quote
>Perfis de Utilizadores</quote
> permitem-lhe adicionar esta pasta apenas para alguns utilizadores e não para outros. Adicione o seguinte ao ficheiro <filename
>/etc/kderc</filename
>:</para>

<programlisting
>[Directories-pessoal]
prefixes=/opt/kde_pessoal
</programlisting>

<para
>Isto cria um perfil chamado <quote
>pessoal</quote
> que adiciona a árvore de pastas <filename class="directory"
>/opt/kde_staff</filename
>. (Lembre-se que o &SuSE; &Linux; usa o <filename
>/etc/kde3rc</filename
> em vez do <filename
>/etc/kderc</filename
>. Agora que existe um perfil com nome, este poderá ser atribuído aos utilizadores.</para>

<para
>Para mapear os perfis nos utilizadores, é necessário indicar um ficheiro de mapeamento no <filename
>/etc/kderc</filename
>:</para>

<programlisting
>[Directories]
userProfileMapFile=/etc/perfil-utilizador-kde
</programlisting>

<para
>Agora é possível atribuir um perfil com base no nome do utilizador ou no grupo de &UNIX; a que este utilizador pertence.</para
> 

<para
>Para atribuir o perfil 'pessoal' a todos os utilizadores que façam parte do grupo de &UNIX; 'membros_pessoal', adicione o seguinte ao ficheiro <filename
>/etc/perfil-utilizador-kde</filename
>:</para>

<programlisting
>[General]
groups=membros_pessoal
[Groups]
membros_pessoal=pessoal
</programlisting>

<para
>Também é possível atribuir um perfil a um único utilizador:</para>

<programlisting
>[Users]
ze=pessoal
</programlisting>

</sect1>

<sect1 id="directory-layout-revisited">
<title
>Disposição das Pastas Revisitada</title>

<para
>Cada árvore de pastas usada pelo &kde; tem uma estrutura de pastas fixa. As pastas que não são relevantes para uma dada árvore ou não são simplesmente usadas poderão ser deixadas de parte. Por exemplo, as pastas usadas para os ficheiros temporários são encontradas em <filename class="directory"
>$<envar
>KDEHOME</envar
></filename
> mas não o são em mais nenhuma árvore de pastas.</para>

</sect1>

<sect1 id="architecture-specific-directories">
<title
>Pastas Específicas da Arquitectura</title>

<para
>Pastas específicas da arquitectura (SO e tipo de CPU):</para>

<variablelist>
<varlistentry>
<term
><filename class="directory"
>bin</filename
></term>
<listitem
><para
>Usada para os executáveis do &kde;.</para
></listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>lib</filename
></term>
<listitem
><para
>Usada para as bibliotecas do &kde;.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>lib/kde3</filename
></term>
<listitem
><para
>Esta pasta contém componentes, 'plugins' e outros objectos carregáveis para serem usados pelas aplicações do &kde; 3.<replaceable
>x</replaceable
>.</para
></listitem
> 
</varlistentry>
</variablelist>

</sect1>

<sect1 id="shared-directories">
<title
>Pastas Partilhadas</title>

<para
>Partilhado: Não específico a uma arquitectura, pode ser partilhado entre elas.</para>

<variablelist>
<varlistentry>
<term
><filename class="directory"
>share/applnk</filename
></term>
<listitem
><para
>Ficheiros <literal role="extension"
>.desktop</literal
> para o menu &kde; (antigo)</para
></listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/applications</filename
></term>
<listitem
><para
>Ficheiros <literal role="extension"
>.desktop</literal
> para o menu &kde; (desde o &kde; 3.2)</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/apps</filename
></term>
<listitem
><para
>Contém os ficheiros de dados específicos da aplicação. Cada aplicação tem uma sub-pasta aqui para guardar os ficheiros de dados adicionais.</para
></listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/config</filename
></term>
<listitem
><para
>Os ficheiros de configuração. Estes normalmente têm um nome baseado na aplicação a que pertencem, com as letras <quote
>rc</quote
>. Um caso especial é o do <filename
>kdeglobals</filename
>. Este ficheiro é lido por todas as aplicações do &kde;.</para
></listitem>
</varlistentry>

<varlistentry>
<term
><filename
class="directory"
>share/config/session</filename
></term>
<listitem
><para
>Esta pasta é usada pela gestão de sessões e só está normalmente disponível em <filename class="directory"
>$<envar
>KDEHOME</envar
></filename
>. No fim de uma sessão, as aplicações do &kde; guardam aqui o seu estado. Os nomes dos ficheiros consistem no nome da aplicação, seguido de um número. O gestor de sessões <command
>ksmserver</command
> guarda as referências a esses números, ao gravar uma sessão no <filename
>ksmserverrc</filename
>.</para
></listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/doc/HTML</filename
></term>
<listitem
><para
>Esta pasta contém a documentação das aplicações do &kde;. A documentação está classificada por língua e pela aplicação a que pertence. Normalmente, existem pelo menos dois ficheiros numa pasta: o <filename
>index.docbook</filename
>, que contém a documentação no formato DocBook não-formatado e o <filename
>index.cache.bz2</filename
>, que contém a mesma documentação, formatada como um &HTML; comprimido com o <command
>bzip2</command
>. A versão em &HTML; é usada pelo &khelpcenter;. Se faltar a versão em &HTML;, o &khelpcenter; irá gerá-la de novo a partir da versão em DocBook, se bem que este é um processo que leva tempo.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/icons</filename
></term>
<listitem
><para
>Sob esta pasta, encontram-se os ícones. Os ícones estão classificados por tema, dimensão e categoria de utilização.</para
></listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/mimelnk</filename
></term>
<listitem
><para
>Nesta pasta, são guardados os ficheiros <literal role="extension"
>.desktop</literal
> que descrevem os tipos &MIME;. O &kde; usa os tipos &MIME; para identificar o tipo de um ficheiro.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/services</filename
></term>
<listitem
><para
>Esta pasta contém os ficheiros <literal role="extension"
>.desktop</literal
> que descrevem os serviços. Os serviços são como as aplicações, só que são lançados por outras aplicações em vez de ser pelo utilizador. Os serviços não aparecem no menu do &kde;.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/servicetypes</filename
></term>
<listitem
><para
>Esta pasta contém os ficheiros <literal role="extension"
>.desktop</literal
> que descrevem os tipos de serviços. Um tipo de serviço normalmente representa uma dada interface de programação. As aplicações e serviços incluem, nos seus ficheiros <literal role="extension"
>
>.desktop</literal
>, os tipos de serviços que oferecem.</para
> </listitem
></varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/sounds</filename
></term>
<listitem
><para
>Esta pasta contém os ficheiros de som.</para
></listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/templates</filename
></term>
<listitem
><para
>Esta pasta contém os modelos para criar os ficheiros de vários tipos. Um modelo consiste num ficheiro <literal role="extension"
>.desktop</literal
> que descreve o ficheiro e que inclui uma referência para um ficheiro na sub-pasta <filename class="directory"
>.source</filename
>. Os modelos nesta pasta aparecem no menu <guimenu
>Criar um Novo</guimenu
>, disponível no ecrã e no gestor de ficheiros. Quando um utilizador selecciona um modelo no menu, é copiado o seu ficheiro de código.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/wallpapers</filename
></term>
<listitem
><para
>Esta pasta contém imagens que podem ser usadas como imagem de fundo</para
></listitem>
</varlistentry>

</variablelist>

</sect1>

<sect1 id="host-specific-directories">
<title
>Pastas Específicas da Máquina</title
> 

<para
>Existem três pastas específicas da máquina que estão ligadas simbolicamente a outros locais. Se as pastas não existirem já, serão criadas as seguintes pastas e ligações simbólicas com o utilitário <command
>lnusertemp</command
>:</para>

<variablelist>

<varlistentry>
<term
><filename
>$<envar
>KDEHOME</envar
>/socket-$<envar
>HOSTNAME</envar
></filename
></term>
<listitem
><para
>Normalmente é a <filename class="directory"
>/tmp/ksocket-$<envar
>USER</envar
>/</filename
>, que é usada por vários 'sockets' de &UNIX;.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename
>$<envar
>KDEHOME</envar
>/tmp-$<envar
>HOSTNAME</envar
></filename
></term>
<listitem
><para
>Normalmente igual a <filename class="directory"
>/tmp/kde-$<envar
>USER</envar
>/</filename
>, é usada para os ficheiros temporários.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename
>$<envar
>KDEHOME</envar
>/cache-$<envar
>HOSTNAME</envar
></filename
></term>
<listitem
><para
>Normalmente igual a <filename class="directory"
>/var/tmp/kdecache-$<envar
>USER</envar
>/</filename
>, é usada para os ficheiros em 'cache'.</para>
</listitem>
</varlistentry>
</variablelist>

<para
>Dado que a <filename class="directory"
>/tmp</filename
> e a <filename class="directory"
>/var/tmp</filename
> são escritas por toda a gente, existe uma possibilidade de que uma das pastas já exista mas que pertença a outro utilizador. Nesse caso, o <command
>lnusertemp</command
> irá criar uma nova pasta com um nome alternativo e uma ligação simbólica para esta em alternativa.</para>

</sect1>

<sect1 id="configuration-files">
<title
>Ficheiros de Configuração</title
> <para
>O &kde; usa um formato de ficheiros simples baseado em texto para todos os seus ficheiros de configuração. Consiste em pares chave-valor que são colocados em grupos. Todos os ficheiros de configuração do &kde; usam a codificação em <acronym
>UTF</acronym
>-8 para o texto fora do intervalo do <acronym
>ASCII</acronym
>.</para>

<para
>O início de um grupo é indicado pelo nome do mesmo, indicado entre parêntesis rectos. Todos os itens chave-valor que se seguem pertencem a esse grupo. O grupo termina quando começar outro grupo novo ou quando se chegar ao fim do ficheiro. Os itens no topo do ficheiro que não sejam antecedidos de um nome de grupo pertencem ao grupo por omissão.</para>

<informalexample
><para
>O exemplo seguinte mostra um ficheiro de configuração que consiste em dois grupos. O primeiro grupo contém as chaves <varname
>LargeCursor</varname
> e <varname
>SingleClick</varname
>, enquanto o segundo contém o <varname
>Show hidden files</varname
> e o <varname
>Sort by</varname
>:</para>

<programlisting
>[KDE]
LargeCursor=false
SingleClick=true
</programlisting>

<programlisting
>[KFileDialog Settings]
Show hidden files=false
Sort by=Name
</programlisting>
</informalexample>

<para
>Os itens de um grupo consistem numa chave e num valor separados por um sinal de igualdade. A chave poderá conter espaços e poderá ser seguida de opções colocadas entre parêntesis rectos. A parte a seguir ao sinal de igualdade é o valor do item. Todos os espaços em branco que rodeiam o sinal de igualdade são ignorados, assim como todos os espaços em branco finais. De forma concisa, o formato é:</para>

<programlisting
><replaceable
>item</replaceable
>=<replaceable
>valor</replaceable
>
</programlisting>

<para
>Se um valor for suporto incluir um espaço no início ou no fim, este poderá ser obtido se usar uma barra invertida seguida de um <quote
>s</quote
>.</para>

<para
>Existem outros códigos de barras invertidas; aqui está uma lista completa: <itemizedlist>
<listitem
><para
><token
>\s</token
> pode ser usado como espaço</para>
</listitem>
<listitem
><para
><token
>\t</token
> pode ser usado para incluir uma tabulação</para>
</listitem>
<listitem
><para
><token
>\r</token
> para um carácter de 'carriage return'</para>
</listitem>
<listitem
><para
><token
>\n</token
> para um carácter de 'linefeed' (linha nova)</para>
</listitem>
<listitem
><para
><token
>\\</token
> para incluir a própria barra invertida</para>
</listitem>
</itemizedlist
></para>

<informalexample
><para
>No exemplo seguinte, o valor do <varname
>Caption</varname
> começa com dois espaços enquanto o <varname
>Description</varname
> contém três linhas de texto. As mudanças de linha na notação das barras invertidas são usadas para separar as várias linhas.</para>

<programlisting
>[Preview Image]
Caption=\s O Meu Título
Description=Esta é\numa enorme\ndescrição.
</programlisting>
</informalexample>

<para
>As linhas em branco dos ficheiros de configuração são ignoradas, assim como as linhas que começam por um cardinal (<quote
>#</quote
>). O cardinal poderá ser usado para adicionar comentários aos ficheiros de configuração. Lembre-se que, quando uma aplicação do &kde; actualizar um ficheiro de configuração, os comentários <emphasis
>não</emphasis
> são mantidos.</para>

<para
>Poderão existir vários ficheiros de configuração com o mesmo nome na sub-pasta <filename class="directory"
>share/config</filename
> das várias estruturas de pastas do &kde;. Nesse caso, a informação em todos esses ficheiros de configuração é reunida chave-a-chave. Se a mesma chave de um dado grupo existir em mais do que um sítio, será usado o valor da chave lido na árvore de pastas com a maior precedência. Os ficheiros de configuração em <filename class="directory"
>$<envar
>KDEHOME</envar
></filename
> têm sempre a precedência maior. Se uma dada chave de um grupo em particular for definida várias vezes num único ficheiro, é usado o valor do último item.</para>

<informalexample>
<para
>Se o ficheiro <filename
>$<envar
>HOME</envar
>/.kde/share/config/xpto</filename
> contiver: <programlisting>
[OMeuGrupo]
Cor=vermelho
Forma=circulo
</programlisting
> e o <filename
>/etc/opt/kde3/share/config/xpto</filename
> contiver <programlisting>
[OMeuGrupo]
Cor=azul
Posicao=10,10
</programlisting
>, o resultado será: <programlisting
>[OMeuGrupo]
Cor=vermelho
Forma=circulo
Posicao=10,10
</programlisting>
</para>
</informalexample>

<informalexample>
<para
>Se o <filename
>$<envar
>HOME</envar
>/.kde/share/config/xpto</filename
> contiver <programlisting>
[OMeuGrupo]
Cor=vermelho
Forma=circulo
[OMeuGrupo]
Cor=verde
</programlisting
> e o <filename
>/opt/kde_pessoal/share/config/xpto</filename
> contiver <programlisting>
[OMeuGrupo]
Cor=purpura
Posicao=20,20
</programlisting
> e o <filename
>/etc/opt/kde3/share/config/xpto</filename
> contiver <programlisting>
[OMeuGrupo]
Cor=azul
Posicao=10,10
</programlisting
> o resultado será igual a: <programlisting
>[OMeuGrupo]
Cor=verde
Forma=circulo
Posicao=20,20
</programlisting>
</para>
</informalexample>

<para
>Para evitar que os utilizadores sejam capazes de alterar as configurações predefinidas, as opções podem ser marcadas como imutáveis. As opções podem ser definidas como imutáveis individualmente, por grupo ou por ficheiro. Um item individual poderá ser bloqueado se adicionar <userinput
>[$i]</userinput
> no fim da chave, &eg;: <programlisting
>Cor[$i]=azul
</programlisting>
</para>
<para
>Um grupo de itens poderá ser bloqueado se colocar <userinput
>[$i]</userinput
> ao nome do grupo, &eg;: <programlisting
>[OMeuGrupo][$i]
</programlisting>
</para>
<para
>Para bloquear o ficheiro por inteiro, inicie o ficheiro com um <userinput
>[$i]</userinput
> numa única linha, &ie;: <programlisting
>[$i]
</programlisting>
</para>

<informalexample>
<para
>Se o <filename
>$<envar
>HOME</envar
>/.kde/share/config/xpto</filename
> contiver: <programlisting>
[OMeuGrupo]
Cor=vermelho
Forma=circulo
</programlisting
> e o <filename
>/etc/opt/kde3/share/config/xpto</filename
> contiver: <programlisting>
[OMeuGrupo][$i]
Cor=azul
Posicao=10,10
</programlisting
>, o resultado será: <programlisting
>[OMeuGrupo]
Cor=azul
Posicao=10,10
</programlisting>
</para>
</informalexample>

<informalexample
><para
>Se o <filename
>$<envar
>HOME</envar
>/.kde/share/config/xpto</filename
> contains: <programlisting>
[OMeuGrupo]
Cor=red
Forma=circulo
</programlisting
> e o <filename
>/opt/kde_staff/share/config/xpto</filename
> contiver <programlisting>
[OMeuGrupo]
Cor=purpura
Forma=rectangulo
</programlisting
> e o <filename
>/etc/opt/kde3/share/config/xpto</filename
> contiver <programlisting>
[OMeuGrupo][$i]
Cor=blue
Posicao=10,10
</programlisting
> o resultado será <programlisting
>[OMeuGrupo]
Color=purpura
Forma=rectangulo
Posicao=10,10
</programlisting>
</para>
</informalexample>


<para
>A <quote
>Expansão da Linha de Comandos</quote
> poderá ser usada para oferecer valores predefinidos mais dinâmicos. Com a expansão da linha de comandos, o valor de uma chave de configuração poderá ser gerado a partir do valor de uma variável de ambiente ou do resultado de um comando da consola. Para activar a expansão da linha de comandos para um item de configuração, a chave deverá ser seguida de um <token
>[$e]</token
>. Normalmente, a forma expandida é gravada no ficheiro de configuração depois de ser usado pela primeira vez. Para evitar isso, é recomendado bloquear o item de configuração, usando o <token
>[$ie]</token
>. O utilizador não o poderá alterar, como é óbvio.</para>

<informalexample>
<para
>No exemplo seguinte, o valor do item <varname
>Maquina</varname
> é determinado a partir do resultado do programa <command
>hostname</command
>. Esta configuração está também bloqueada para garantir que o valor é sempre determinado dinamicamente.</para>

<para
>O valor do item <varname
>Email</varname
> é determinado pelo preenchimento dos valores das variáveis de ambiente $<envar
>USER</envar
> e $<envar
>HOST</envar
>. Quando o <systemitem class="username"
>ze</systemitem
> está ligado na máquina <systemitem class="systemname"
>maquina_ze</systemitem
>, isto irá resultar num valor igual a <literal
>ze@maquina_ze</literal
>. A configuração não fica bloqueada.</para>

<programlisting
>[Configuracao do E-Mail] 
Maquina[$ie]=$(hostname)
Email[$e]=${USER}@${HOST}
</programlisting>
</informalexample>

<para
>A maior parte dos itens de configuração poderá ser indexado com o código de uma língua. Nesse caso, a língua que o utilizador seleccionou para usar no ecrã é usada para procurar o valor da chave. Se a língua por omissão (o Inglês Americano) tiver sido escolhida ou se não existir nenhum índice que corresponda à língua seleccionada, será usado o item da chave sem índice.</para>

<informalexample>
<para
>No exemplo seguinte, o valor do item <varname
>Titulo</varname
> depende da língua. Se o utilizador tiver seleccionado o Português como língua (o código de língua <literal
>pt</literal
>), o valor do item será <quote
>A Minha Legenda</quote
>. Em todos os outros casos, será usado o valor <quote
>My Caption</quote
>.</para>

<programlisting
>[Antever a Imagem]
Titulo=My Caption
Titulo[pt]=A Minha Legenda
</programlisting>
</informalexample>

<informalexample>
<para
>Neste exemplo, o valor do item <varname
>Titulo</varname
> depende da língua. Se o utilizador tiver seleccionado o Português como língua (código de língua <literal
>pt</literal
>), o valor do item será <quote
>A Minha Legenda</quote
> Em todos os outros casos, será usado o valor <quote
>My Caption</quote
>.</para>

<programlisting
>[Antever a Imagem]
Titulo=My Caption
Titulo[pt]=A Minha Legenda
</programlisting>
</informalexample>

<para
>De um modo geral, os itens que podem aparecer num ficheiro de configuração não estão documentados. Com o &kde; 3.2, começou-se a alterar isso. Em <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/config.kcfg</filename
>, os ficheiros que nela se encontram oferecem uma descrição formal dos itens possíveis de um ficheiro de configuração. Estes são usados pelo novo Editor de Configuração do &kde;, quando estiverem disponíveis.</para>

<informalexample>
<para
>Aqui esta um ficheiro de exemplo de configuração em &XML;: <programlisting
><markup>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE kcfg SYSTEM "http://www.kde.org/standards/kcfg/1.0/kcfg.dtd"&gt;
&lt;kcfg&gt;
    &lt;kcfgfile name="korganizerrc"/&gt;
    &lt;group name="Geral"&gt;
         &lt;entry type="Bool" key="Gravação Automática"&gt;
             &lt;label&gt;Activa a gravação automática do calendário&lt;/label&gt;
             &lt;default&gt;true&lt;/default&gt;
         &lt;/entry&gt;
         &lt;entry type="Int" key="Intervalo de Gravação Automática"&gt;
             &lt;default&gt;10&lt;/default&gt;
         &lt;/entry&gt;
    &lt;/group&gt;
&lt;/kcfg&gt;
</markup
>
</programlisting>
</para>
<para
>Tem o mesmo efeito que: <programlisting
>[Geral]
Gravação Automática=false
Intervalo de Gravação Automática=25
</programlisting>
</para>
</informalexample>

</sect1>

<sect1 id="kde-startup-sequence">
<title
>Sequência de Arranque do &kde;</title>

<sect2 id="kdm">
<title
>&kdm;</title>

<para
>É sempre corrido como <systemitem class="username"
>root'</systemitem
>! Usa o <filename
>$<envar
>KDEDIR</envar
>/share/config/kdmrc</filename
> e o <filename
>/etc/X11/xdm/Xservers</filename
>. O último contém itens do género:</para>

<programlisting
>:0 local /usr/X11R6/bin/X :0 vt07
</programlisting>

<para
>Os ficheiros de arranque relevantes são também: </para>
<simplelist>
<member
>A secção [X-*-Core] no <filename
>kdmrc</filename
> </member>
<member
>Configuração - <filename
>/etc/X11/xdm/Xsetup</filename
> </member>
<member
>O utilizador introduz o utilizador &amp; a senha </member>
<member
>Arranque - <filename
>/etc/X11/xdm/Xstartup</filename
> - preparar como 'root' </member>
<member
>Sessão - <filename
>/etc/X11/xdm/Xsession</filename
> - inicia a sessão com o utilizador </member>
<member
>= Para uma sessão do KDE: <command
>kde</command
> ou <command
>startkde</command
> </member>
<member
>= Se presente, o <filename
>~/.xsession</filename
> ou o <filename
>~/.xinitrc</filename
> </member>
<member
>Reiniciar - <filename
>/etc/X11/xdm/Xreset</filename
> - após terminar a sessão </member>
</simplelist>

</sect2>

<sect2 id="startkde">
<title
>O Programa de Arranque do &kde;: <command
>startkde</command
></title>

<para
>A sequência de arranque do &kde; começa com o programa <filename
>startkde</filename
>. Na maioria dos casos, este programa é chamado pelo gestor de autenticação (&kdm;) logo que o utilizador se tenha autenticado. Existem duas linhas muito importantes no programa <filename
>startkde</filename
>:</para>

<programlisting
>LD_BIND_NOW=true kdeinit +kcminit +knotify and kwrapper
ksmserver $KDEWM
</programlisting>

<para
>A primeira linha inicia o processo-mestre <command
>kdeinit</command
>. O processo <command
>kdeinit</command
> é usado para iniciar todos os outros processos do &kde;. Ele apresenta o resultado do <command
>ps <option
>aux</option
></command
> como <computeroutput
>kdeinit: Running...</computeroutput
>. Os argumentos a seguir ao <command
>kdeinit</command
> são os nomes dos processos adicionais a iniciar. O <token
>+</token
> indica que o <command
>kdeinit</command
> necessita de esperar até que o processo termine. O <command
>kdeinit</command
> também inicia o <command
>dcopserver</command
>, o <command
>klauncher</command
> e o <command
>kded</command
>.</para>

<para
>A segunda das duas linhas diz ao <command
>kdeinit</command
> para iniciar o processo de gestão de sessões <command
>ksmserver</command
>. O gestor de sessões determina o tempo-de-vida da sessão. Quando este processo sair, o utilizador terminou a sua sessão.</para>

</sect2>
</sect1>

<sect1 id="background-processes">
<title
>Processos em Segundo-Plano</title>

<para
>Todos os serviços em segundo plano do &kde; são específicos do utilizador: ao contrário dos servidores de sistema, não são partilhados entre os utilizadores. Assim como também são únicos por  utilizador, também o são entre ambientes do servidor X. Os processos são:</para>

<variablelist>
<varlistentry>
<term
><command
>dcopserver</command
></term>
<listitem
><para
>Comunicação no ambiente de trabalho</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>kded</command
></term>
<listitem
><para
>Servidor genérico de serviços.</para>
<para
>Despoleta as actualizações da base de dados do <link linkend="ksycoca"
>Sycoca</link
>, sempre que necessário</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>kcminit</command
></term>
<listitem
><para
>Serviço de inicialização</para>
<para
>Veja em <xref linkend="kcminit"/> mais informações.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>klauncher</command
></term>
<listitem
><para
>Execução de programas (isto <emphasis
>não</emphasis
> é a janela obtida com <keycombo action="simul"
>&Alt;<keycap
>F2</keycap
> </keycombo
>!)</para>
<para
>Veja em <xref linkend="klauncher"/> mais informações.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>knotify</command
></term>
<listitem
><para
>Notificações do utilizador.</para>
<para
>Veja em <xref linkend="knotify"/> mais informações.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>ksmserver</command
></term>
<listitem
><para
>Gestão de sessão</para>
<para
>Veja em <xref linkend="ksmserver"/> mais informações.</para>
</listitem>
</varlistentry>

</variablelist>

<sect2 id="kdeinit">
<title
><command
>kdeinit</command
></title>
<para
>O <command
>kdeinit</command
> é usado para iniciar todos os programas do &kde;. O <command
>kdeinit</command
> pode iniciar os programas binários normais, assim como os módulos carregáveis do <command
>kdeinit</command
> (<acronym
>KLM</acronym
>s). Os <acronym
>KLM</acronym
>s funcionam como os programas binários mas poderão ser iniciados de forma mais eficiente. Os <acronym
>KLM</acronym
>s ficam em <filename class="directory"
>$<envar
>KDEDIR</envar
>/lib/kde3</filename
></para>

<para
>A desvantagem é que os programas que são iniciados desta forma aparecem como <computeroutput
><command
>kdeinit</command
></computeroutput
> no resultado do <command
>top</command
> e do <command
>ps</command
>. Use o <command
>top <option
>-c</option
></command
> ou o <command
>ps <option
>aux</option
></command
> para ver o nome real do programa:</para>

<screen
><prompt
>%</prompt
><userinput
><command
>ps <option
>aux</option
></command
></userinput>
<computeroutput>
jncp     23184  0.2  2.1 23428 11124 ?        S    21:41   0:00 kdeinit: Running...
jncp     23187  0.1  2.1 23200 11124 ?        S    21:41   0:00 kdeinit: dcopserver --nosid
jncp     23189  0.2  2.4 25136 12496 ?        S    21:41   0:00 kdeinit: klauncher
jncp     23192  0.7  2.8 25596 14772 ?        S    21:41   0:00 kdeinit: kded
jncp     23203  0.8  3.4 31516 17892 ?        S    21:41   0:00 kdeinit:
knotify
</computeroutput
>
</screen>

<para
>O <computeroutput
>kdeinit: Running...</computeroutput
> indica o processo-mestre do <command
>kdeinit</command
>. Os outros processos listados são os programas iniciados como <acronym
>KLM</acronym
>s.</para>

<para
>Quando o <command
>kdeinit</command
> é iniciado pela primeira vez, irá lançar o <command
>dcopserver</command
>, o <command
>klauncher</command
> e o <command
>kded</command
>, assim como vários programas adicionais que sejam indicados na sua linha de comandos no programa <command
>startkde</command
>, normalmente o <command
>kcminit</command
> e o <command
>knotify</command
>.</para>

</sect2>

<sect2 id="dcopserver">
<title
><command
>dcopserver</command
></title>

<para
>O <command
>dcopserver</command
> é um servidor que oferece serviços de comunicação entre processos (&DCOP;) a todas as aplicações do &kde;. Os serviços do &DCOP; estão acessíveis a partir da linha de comandos através do comando <command
>dcop</command
>. O &DCOP; é essencial para todas as aplicações do &kde;.</para>

<para
>Alguns ficheiros relacionados:</para>

<variablelist>
<varlistentry>
<term
><filename
>$<envar
>HOME</envar
>/.DCOPserver_$<envar
>HOSTNAME</envar
>_$<envar
>DISPLAY</envar
></filename
></term>
<listitem
><para
>Por exemplo <filename
>.DCOPserver_linux__0</filename
>. Controlado por $<envar
>DCOPAUTHORITY</envar
></para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename
>/tmp/.ICE-unix/dcop<replaceable
>pid</replaceable
>-<replaceable
>número</replaceable
></filename
></term>
<listitem
><para
>&eg; <filename
>dcop7634-1069677856</filename
>. Este é o ficheiro para o qual o <filename
>DCOPserver</filename
> aponta.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename
>$<envar
>HOME</envar
>/.ICEauthority</filename
></term>
<listitem
><para
>Informação de autorização controlada por $<envar
>ICEAUTHORITY</envar
></para>
</listitem>
</varlistentry>
</variablelist>

</sect2>

<sect2 id="kcminit">
<title
>kcminit</title>

<para
>O <command
>kcminit</command
> executa os serviços de inicialização no arranque. Os serviços de inicialização são referenciados nos ficheiros .desktop das aplicações ou serviços, através da linha <varname
>X-KDE-Init</varname
>:</para>

<programlisting
>[Desktop Entry]
Encoding=UTF-8
Exec=kcmshell energy
Icon=energy_star
Type=Application
X-KDE-Library=energy
X-KDE-Init=energy
</programlisting>

<para
>Os serviços de inicialização são normalmente usados para inicializar o 'hardware' com base nas configurações do utilizador.</para>

<para
>O <userinput
><command
>kcminit <option
>--list</option
></command
></userinput
> poderá ser usado para mostrar todos os serviços de inicialização e o <userinput
><command
>kcminit <replaceable
>serviço</replaceable
></command
></userinput
> poderão ser usados para executar explicitamente um serviço. Isto pode ser útil ao investigar os problemas no arranque.</para>

</sect2>

<sect2 id="klauncher">
<title
><command
>klauncher</command
></title>

<para
>O <command
>klauncher</command
> é um servidor responsável pela activação de serviços dentro do &kde;. Ele funciona intimamente com o processo-mestre <command
>kdeinit</command
> para iniciar os processos novos. As aplicações do &kde; comunicam com o <command
>klauncher</command
> através de &DCOP; para iniciar as aplicações ou serviços novos.</para>

<para
>É mais conhecido pela mensagem de erro: <computeroutput
><errortext
> KLauncher could not be reached via DCOP </errortext
></computeroutput
> (o KLauncher não pôde ser acedido através de DCOP), o que indica um problema sério com o <command
>dcopserver</command
> ou que o <command
>klauncher</command
> estoirou.</para>

<para
>O <command
>klauncher</command
> pode ser reiniciado se reiniciar o <command
>kdeinit</command
> a partir de uma janela de consulta. Certifique-se que as variáveis $<envar
>HOME</envar
>, $<envar
>DISPLAY</envar
> e as diversas $<envar
>KDEDIR(S)</envar
> estão correctas antes de o fazer!</para>

</sect2>

<sect2 id="knotify">
<title
><command
>knotify</command
></title>

<para
>A tarefa principal do <command
>knotify</command
> é reencaminhar as notificações de som para o servidor de som, assim como também fornece métodos de notificação alternativos.</para>

</sect2>


</sect1>

<sect1 id="ksmserver">
<title
>KSMServer</title>

<para
>O <command
>ksmserver</command
> é o gestor de sessões do &kde;. No arranque, o gestor de sessões lança as aplicações de arranque automático e repõe as aplicações a partir da sessão actual. As aplicações a arrancar automaticamente são indicadas pelos ficheiros <literal role="extension"
>.desktop</literal
> na pasta <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/autostart</filename
>. O arranque automático de uma aplicação poderá ser condicional, com base num item de configuração determinado pelo item <varname
>X-KDE-autostart-condition</varname
> no ficheiro <literal role="extension"
>.desktop</literal
>.</para>

<informalexample>
<para
>O ficheiro <filename
>ktip.desktop</filename
> por exemplo contém:</para>

<programlisting
>X-KDE-autostart-condition=ktiprc:TipOfDay:RunOnStart:true
</programlisting>

<para
>Isto significa que o ficheiro de configuração <filename
>ktiprc</filename
> irá verificar por um item <varname
>RunOnStart</varname
> na secção <varname
>[TipOfDay]</varname
>. Se não encontrar nenhum item, assume-se <literal
>true</literal
>, o que significa que o <application
>ktip</application
> é uma das aplicações que é iniciada automaticamente por omissão.</para>
</informalexample>

<para
>Algumas das aplicação iniciadas automaticamente pelo <command
>ksmserver</command
> são:</para>

<variablelist>

<varlistentry>
<term
><command
>kdesktop</command
></term>
<listitem
><para
>O ambiente de trabalho do &kde;</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>&kicker;</command
></term>
<listitem
><para
>O painel do &kde;</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>ktip</command
></term>
<listitem
><para
>Um programa com a dica do dia</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>kwrited</command
></term>
<listitem
><para
>Um utilitário para receber mensagens do sistema enviadas ao utilizador</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>&klipper;</term>
<listitem
><para
>Um utilitário para a área de transferência que fica atracado no painel</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>kalarm</command
></term>
<listitem
><para
>Um utilitário que recorda eventos e compromissos.</para>
</listitem>

</varlistentry>
</variablelist>

<para
>O <command
>kdesktop</command
>, por sua vez, inicia automaticamente as aplicações guardadas em <filename class="directory"
>$<envar
>KDEHOME</envar
>/Autostart</filename
>. O <command
>kdesktop</command
> irá abrir automaticamente os ficheiros gravados nesta pasta, incluindo os documentos, ficheiros binários ou aplicações, sob a forma de ficheiros <literal role="extension"
>.desktop</literal
>.</para>

<para
>O gestor de sessões do &kde; também repõe uma sessão anterior. Uma sessão contém uma colecção de aplicações, assim como a informação específica da aplicação que reflecte o estado das aplicações na altura em que a sessão foi gravada.l As sessões são gravadas no ficheiro de configuração <filename
>ksmserverrc</filename
>, que contém referências à informação de estado específica da aplicação. A informação de estado específica da aplicação é gravada em <filename class="directory"
>$<envar
>KDEHOME</envar
>/share/config/session</filename
>. A informação de estado do &kwin; contém a localização das janelas de todas as aplicações na sessão. </para>

</sect1>

<sect1 id="environment-variables">
<title
>Variáveis de ambiente</title>

<para
>Algumas variáveis de ambiente importantes utilizadas pelo &kde;:</para>

<variablelist>

<varlistentry>
<term
>$<envar
>KDEDIR</envar
></term>
<listitem
><para
>Tem de estar definida, se a <envar
>KDEDIRS</envar
> não o estiver e tem de apontar para a raiz da árvore de instalação do &kde;. Permite ao &kde; encontrar os seus dados, como os ícones, menus e bibliotecas.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDEDIRS</envar
></term>
<listitem
><para
>Sobrepõe-se ao <envar
>KDEDIR</envar
> e permite-lhe indicar várias pastas onde o &kde; poderá procurar pelos seus dados. É útil se você quiser ou tiver de instalar alguns programas num prefixo diferente do resto do &kde;.</para
> 
</listitem>
</varlistentry>

<varlistentry
><term
><envar
>$KDEHOME</envar
></term
><listitem
><para
>Se não estiver definida, o &kde; usa a <filename class="directory"
>~/.kde</filename
> como pasta onde se encontrar os dados pessoais.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDEROOTHOME</envar
></term
><listitem
><para
>Se não estiver definida, o &kde; usa a <filename class="directory"
>~root/.kde</filename
> como pasta para os dados pessoais do <systemitem class="username"
>root</systemitem
>. Foi introduzida para evitar que o &kde; sobreponha acidentalmente os dados do utilizador com permissões de 'root', quando este tiver executado um programa do &kde; depois de mudar com o <command
>su</command
> para <systemitem class="username"
>root</systemitem
>.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDEWM</envar
></term
><listitem
><para
>Se a variável <envar
>KDEWM</envar
> tiver sido definida, então será usada como o gestor de janelas do &kde; dentro do programa <command
>startkde</command
>, em vez do &kwin;.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_LANG</envar
></term
><listitem
><para
>Sobrepõe-se à configuração da língua do &kde;, &eg; <userinput
>KDE_LANG=pt kprograma &amp;</userinput
> inicia um programa com a tradução para Português, se estiverem instalados os ficheiros necessários.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_MULTIHEAD</envar
></term
><listitem
><para
>Defina esta variável como <literal
>true</literal
> para indicar que o &kde; está a correr num sistema com vários monitores.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_FORK_SLAVES</envar
></term>
<listitem
><para
>(Desde o &kde; 3.2.3) Defina esta variável para criar <acronym
>KIO</acronym
>-slaves directamente a partir do processo da aplicação em si. Por omissão, os <acronym
>KIO</acronym
>-slaves são originados a partir do <command
>klauncher</command
>/<command
>kdeinit</command
>. Esta opção é útil se o <acronym
>KIO</acronym
>-slave correr no mesmo ambiente que a aplicação. Este poderá ser o caso com o <application
>Clearcase</application
>.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_HOME_READONLY</envar
></term>
<listitem
><para
>Utilize esta variável para indicar que a sua pasta pessoal está montada apenas para leitura.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_NO_IPV6</envar
></term
><listitem
><para
>(Desde o &kde; 3.2.3) - Active esta variável para desactivar o suporte a <acronym
>IPv6</acronym
> e as procuras de <acronym
>DNS</acronym
> em <acronym
>IPv6</acronym
>.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_IS_PRELINKED</envar
></term
><listitem
><para
>(Desde o &kde; 3.2) - Active esta variável para indicar que os seus executáveis e bibliotecas do &kde; estão 'prelinked'. Isto desliga o <command
>kdeinit</command
>.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_UTF8_FILENAMES</envar
></term
><listitem
><para
>Se esta variável de ambiente estiver definida, o &kde; irá assumir que todos os nomes de ficheiros estão na codificação <acronym
>UTF-8</acronym
>, independentemente da configuração regional.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_FULL_SESSION</envar
></term
><listitem
><para
>(Desde o &kde; 3.2) É configurada automaticamente como 'true' (verdadeiro) pelo &kde;; é usada  &eg; pelo &konqueror; para saber se deverá ficar em memória para poder ser reutilizado ao ser fechado. Se não estiver definida, o &konqueror; irá sair depois de ter sido fechado (&eg;, o &kdesu; faz isso; também é útil para a depuração).</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDESYCOCA</envar
></term
><listitem
><para
>Permite-lhe definir a localização e o nome do ficheiro da 'cache' de configuração do sistema do &kde;.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDETMP</envar
></term
><listitem
><para
>Permite-lhe indicar uma localização diferente de <filename class="directory"
>/tmp</filename
> para o &kde; guardar os seus ficheiros temporários.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDEVARTMP</envar
></term
><listitem
><para
>Permite-lhe indicar uma localização diferente de <filename class="directory"
>/var/tmp</filename
> para o &kde; armazenar os seus ficheiros variáveis.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>XDG_DATA_HOME</envar
></term
><listitem
><para
>(Desde o &kde; 3.2) Define a pasta de base, em relação à qual os ficheiros de dados específicos do utilizador deverão estar armazenados. Por omissão, é igual à <filename class="directory"
>$<envar
>HOME</envar
>/.local/share</filename
></para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>XDG_DATA_DIRS</envar
></term
><listitem
><para
>(Desde o &kde; 3.2) Define o conjunto, ordenado pela preferência, de pastas de base nas quais procurar por ficheiros de dados, para além da pasta de base definida em <filename class="directory"
>$<envar
>XDG_DATA_HOME</envar
></filename
>. Por omissão é a <literal
>/usr/local/share/:/usr/share/</literal
></para>

<para
>O &kde; adiciona as localizações da $<envar
>KDEDIRS</envar
> e dos perfis também. É usada para os ficheiros de menu <literal role="extension"
>.desktop</literal
> e <literal role="extension"
>.directory</literal
>. Os ficheiros <literal role="extension"
>.desktop</literal
> em <filename class="directory"
>$<envar
>XDG_DATA_DIRS</envar
>/applications</filename
>. Os ficheiros <literal role="extension"
>.directory</literal
> em $XDG_DATA_DIRS/desktop-directories </para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>XDG_CONFIG_HOME</envar
></term
><listitem
><para
>(&kde; 3.2) - Define a pasta de base, em relação à qual deverão ser gravados os ficheiros de configuração específicos do utilizador. Por omissão é a <filename class="directory"
>$<envar
>HOME</envar
>/.config</filename
>.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>XDG_CONFIG_DIRS</envar
></term
><listitem
><para
>(&kde; 3.2) - Define o conjunto, ordenado pela preferência, de pastas de base nas quais procura pelos ficheiros de configuração, para além da pasta de base em $<envar
>XDG_CONFIG_HOME</envar
>. O valor por omissão é <filename class="directory"
>/etc/xdg</filename
>. O &kde; adiciona as localizações do $<envar
>KDEDIRS</envar
> e dos perfis. É usada pelas descrições do <literal role="extension"
>.menu</literal
> em <filename class="directory"
>$<envar
>XDG_CONFIG_DIRS</envar
>/menus</filename
>. </para>
</listitem>
</varlistentry>
</variablelist>

</sect1>

<sect1 id="the-kdeinit-mystery">
<title
>O Mistério do 'kdeinit'</title>

<!-- FIXME: Add more words. Fix markup -->

<para
>O <command
>kdeinit</command
> é usado para iniciar todos os programas do &kde;. O <command
>kdeinit</command
> pode iniciar os programas binários normais, assim como os módulos carregáveis do <command
>kdeinit</command
> (<acronym
>KLM</acronym
>s). Os <acronym
>KLM</acronym
>s funcionam como os programas binários mas poderão ser iniciados de forma mais eficiente. Os <acronym
>KLM</acronym
>s ficam em <filename class="directory"
>$<envar
>KDEDIR</envar
>/lib/kde3</filename
></para>

<para
>A desvantagem é que os programas que são iniciados desta forma aparecem como <computeroutput
><command
>kdeinit</command
></computeroutput
> no resultado do <command
>top</command
> e do <command
>ps</command
>. Use o <command
>top <option
>-c</option
></command
> ou o <command
>ps <option
>aux</option
></command
> para ver o nome real do programa:</para>

<screen
><prompt
>%</prompt
> <userinput
><command
>ps aux | grep jncp</command
></userinput>
<computeroutput>
jncp  26061  0.0  2.2 24284 11492 ?       S    21:27   0:00 kdeinit: 
jncp  26064  0.0  2.2 24036 11524 ?       S    21:27   0:00 kdeinit: 
jncp  26066  0.1  2.5 26056 12988 ?       S    21:27   0:00 kdeinit: 
jncp  26069  0.4  3.2 27356 16744 ?       S    21:27   0:00 kdeinit: kded
jncp  26161  0.2  2.7 25344 14096 ?       S    21:27   0:00 kdeinit: 
jncp  26179  1.1  3.4 29716 17812 ?       S    21:27   0:00 kdeinit: kicker
jncp  26192  0.4  3.0 26776 15452 ?       S    21:27   0:00 kdeinit: 
jncp  26195  1.0  3.5 29200 18368 ?       S    21:27   0:00 kdeinit: 
</computeroutput
>
</screen>
<para
>Como poderá já ter notado, isto tem outro efeito colateral, tornando difícil matar um processo que esteja a causar problemas:</para>

<screen
><prompt
>%</prompt
> <userinput
><command
>killall kdesktop</command
></userinput>
<computeroutput
>kdesktop: no process killed</computeroutput
></screen>

<para
>Poderá ser tentado a experimentar um <userinput
><command
>killall kdeinit</command
></userinput
>, mas se matar todos os processos do 'kdeinit', irá ter o efeito de encerrar todo o &kde;. Ou seja, destruição total!</para>

<para
>Existem duas soluções simples para isto:</para>

<screen
><prompt
>%</prompt
> <userinput
><command
>kdekillall kdesktop</command
></userinput>
ou o bom velho
<prompt
>%</prompt
> <userinput
><command
>kill 26195</command
></userinput
></screen>
<para
>O <command
>kdekillall</command
> faz parte do pacote <acronym
>SDK</acronym
> do &kde;.</para>

</sect1>

</chapter>

<chapter id="customizing-kde">
<title
>Personalizar o &kde;</title>


<sect1 id="desktop-icons">
<title
>Ícones do Ecrã</title>

<para
>O &kde; utiliza várias tipos de ícones:</para>
<itemizedlist>
<listitem
><para
>Documentos</para>
</listitem>
<listitem
><para
>Atalhos para Páginas Web (utilizando ficheiro <literal role="extension"
>.desktop</literal
>)</para>
</listitem>
<listitem
><para
>Atalhos para Aplicações (utilizando ficheiro <literal role="extension"
>.desktop</literal
>)</para>
</listitem>
<listitem
><para
>Dispositivos - Discos, Partições e Periféricos: <itemizedlist>
<listitem
><para
>Explicitamente utilizando ficheiro <literal role="extension"
>.desktop</literal
></para>
</listitem>
<listitem
><para
>Automático via o 'io-slave' devices://</para>
</listitem>
</itemizedlist>
</para>
</listitem>
<listitem
><para
>Específico do fornecedor (por exemplo, O Meu Computador da &SuSE;)</para>
</listitem>
</itemizedlist>

<sect2 id="desktop-icons-websites">
<title
>Páginas Web</title>
<para
>As Ligações aos 'Sites' Web, usando o ficheiro <literal role="extension"
>.desktop</literal
>: <menuchoice
><guimenu
>Criar um Novo</guimenu
><guisubmenu
>Ficheiro</guisubmenu
><guimenuitem
>Atalho para Localização (URL)</guimenuitem
></menuchoice
>. Altere o ícone com as janelas de <guilabel
>Propriedades</guilabel
>. O ficheiro <literal role="extension"
>.desktop</literal
> resultante: <programlisting
>[Desktop Entry]
Encoding=UTF-8
Icon=/opt/kde3/share/apps/kdesktop/pics/ksslogo.png
Type=Link
URL=http://www.kde.org/
</programlisting>
</para>
</sect2>

<sect2 id="desktop-icons-applications">
<title
>Aplicações</title>

<para
>Atalhos para Aplicações, usando o ficheiro <literal role="extension"
>.desktop</literal
>: <menuchoice
><guimenu
>Criar um Novo</guimenu
><guisubmenu
>Ficheiro</guisubmenu
><guimenuitem
>Atalho para Aplicação</guimenuitem
></menuchoice
>. Terá de indicar você mesmo os detalhes. Arraste a partir do Menu do &kde;: Tanto poderá copiar ou criar uma ligação simbólica, o que será muito mais simples</para>

<!-- Perhaps legacy and translated should be the other way around, but -->
<!-- this is how it appears in Waldo's presentation. Need to check -->
<!-- this -->

<programlisting
>[Desktop Entry]<co id="boilerplate"/>
Encoding=UTF-8
GenericName=IRC Client<co id="generic-desc"/>
GenericName[af]=Irc Kli&euml;t
GenericName[de]=IRC Programm
GenericName[pt]=Programa de IRC
...
GenericName[zu]=Umthengi we IRC<co id="legacy"/>
SwallowExec=<co id="translated"/>
Name=KSirc
Name[af]=Ksirc
Name[de]=KSirc
...
</programlisting>

<calloutlist>
<callout arearefs="boilerplate"
><para
>Sempre igual</para>
</callout>
<callout arearefs="generic-desc"
><para
>Descrição genérica traduzida, não utilizada no ecrã</para>
</callout>
<callout arearefs="legacy"
><para
>Legado, pode ser removido</para>
</callout>
<callout arearefs="translated"
><para
>Nome traduzido tal como aparece no ecrã</para>
</callout>
</calloutlist>

<para
>Ícones do Ecrã</para>
<programlisting
>...
Name[zu]=Ksirc
MimeType=<co id="co-mimetype"/>
Exec=ksirc %i %m<co id="co-exec"/>
Icon=ksirc<co id="co-icon"/>
TerminalOptions=<co id="co-terminaloptions"/>
Path=<co id="co-path"/>
Type=Application<co id="co-type"/>
Terminal=0<co id="co-terminal"/>
X-KDE-StartupNotify=true<co id="co-x-kde-startupnotify"/>
X-DCOP-ServiceType=Multi<co id="co-x-dcop-servicetype"/>
Categories=Qt;KDE;Network<co id="co-categories"/>
</programlisting>

<calloutlist>
<callout arearefs="co-mimetype"
><para
>Tipos &MIME; suportados, não utilizado no ecrã</para>
</callout>
<callout arearefs="co-exec"
><para
>A linha de comando a executar</para>
</callout>
<callout arearefs="co-icon"
><para
>O ícone, do tema de ícones ou localização completa</para>
</callout>
<callout arearefs="co-terminaloptions"
><para
>Apenas utilizado se for necessário o terminal</para>
</callout>
<callout arearefs="co-path"
><para
>Pasta de trabalho do comando</para>
</callout>
<callout arearefs="co-type"
><para
>Também sempre igual</para>
</callout>
<callout arearefs="co-terminal"
><para
>Utilize 'true' se o terminal for necessário, aplicação de texto</para>
</callout>
<callout arearefs="co-x-kde-startupnotify"
><para
>Mostrar o cursor saltitante, desactive se não funcionar.</para>
</callout>
<callout arearefs="co-x-dcop-servicetype"
><para
>A aplicação iniciou-se bem? Remova-a se não funcionar</para>
</callout>
<callout arearefs="co-categories"
><para
>Categorias do Menu do &kde; não usadas no ecrã</para>
</callout>
</calloutlist>



</sect2>

<sect2 id="desktop-icons-exec">
<title
>A opção <varname
>Exec</varname
> nos ficheiros <literal role="extension"
>.desktop</literal
></title>

<para
>A seguir ao comando, poderá ter vários elementos de substituição que poderão ser alterados para os valores actuais do programa, aquando da sua execução: <variablelist>
<varlistentry>
<term
>%f</term
> <listitem
><para
>Um único nome de ficheiro; é usado ao largar um ficheiro no ícone ou nas associações de ficheiros.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%F</term>
<listitem
><para
>Uma lista de ficheiros; use para as aplicações que poderão abrir vários ficheiros locais de uma vez.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%u</term>
<listitem
><para
>Um único &URL;: se a aplicação conseguir lidar com &eg; &URL;s de &FTP; ou &HTTP; ela própria, caso contrária, o &kde; fará isso por ela.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%U</term>
<listitem
><para
>Uma lista de &URL;s;; irá obter o ficheiro primeiro e passará depois um ficheiro local para a aplicação (!!)</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%d</term>
<listitem
><para
>A pasta do ficheiro a abrir; é útil se a aplicação necessitar de ter o ficheiro na pasta de trabalho local.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%D</term>
<listitem
><para
>Uma lista de pastas, o que não é muito prático.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%i</term
> 
<listitem
><para
>O ícone; opção <option
>--icon</option
>; a aplicação do &kde; irá usar o ícone da linha <varname
>Icon</varname
>= na barra de tarefas.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%m</term>
<listitem
><para
>O mini-ícone legado.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%c</term
> 
<listitem
><para
>O título;  opção <option
>--caption</option
>; a aplicação do &kde; irá usar o nome da linha <varname
>Name</varname
>= na barra de tarefas.</para>
</listitem>
</varlistentry>

</variablelist>
</para>

<informalexample>
<para
>Exemplos: <segmentedlist>
<segtitle
>Linha <varname
>Exec</varname
></segtitle>
<segtitle
>Comando executado</segtitle>
<seglistitem
><seg
>ksirc %i</seg
><seg
><command
>ksirc --icon ksirc</command
></seg>
</seglistitem>
<seglistitem
><seg
>cd %d; kedit $(basename %f)</seg
><seg
><command
>cd /tmp; kedit ficheiro.txt</command
></seg>
</seglistitem>
</segmentedlist>
</para>
</informalexample>

<!--Dont' know what this refers to: -->
<!--See What's This (Shift-F1) in Properties Dialog-->

</sect2>

<sect2 id="desktop-icons-devices">
<title
>Dispositivos</title>
<para
>Atalhos para os Dispositivos, usando o ficheiro <literal role="extension"
>.desktop</literal
>: o Criar um Novo -> Dispositivo </para>
</sect2>

<sect2 id="where-to-define">
<title
>Onde Definir</title>

<para
>Vários sítios onde definir Ícones de Ecrã: <itemizedlist>

<listitem
><para
><filename class="directory"
>~/Desktop</filename
>: copiado de <filename class="directory"
>/etc/skel/Desktop</filename
></para
></listitem>

<listitem
><para
><filename class="directory"
>$<envar
>KDEDIR</envar
>/apps/kdesktop/Desktop</filename
> (junto)</para
></listitem>

<listitem
><para
><filename class="directory"
>$<envar
>KDEDIR</envar
>/apps/kdesktop/DesktopLinks</filename
> (copiado)</para
></listitem>

<listitem
><para
>Dispositivos de Ícones (juntos dinamicamente)</para
></listitem>

<listitem
><para
>Específico da Distribuição; o SUSE Linux copia certos ícones no startkde.theme a partir do <filename class="directory"
>/opt/kde3/share/config/SuSE/default/</filename
></para
></listitem>

</itemizedlist>
</para>
</sect2>
</sect1>

<sect1 id="kde-menu">
<title
>Menu do &kde;</title>

<sect2 id="how-it-works">
<title
>Como Funciona</title>

<para
>No &kde; 3.2, foi introduzido um formato de menus comum em <ulink url="http://freedesktop.org/Standards/menu-spec/"
>http://freedesktop.org/Standards/menu-spec/</ulink
></para>
<para
>Antes do &kde; 3.2: <itemizedlist>

<listitem
><para
>Uma estrutura em pastas sob a <filename class="directory"
>share/applnk</filename
></para
></listitem>

<listitem
><para
>A estrutura das pastas representa a estrutura do menu</para
></listitem>

<listitem
><para
>Cada ficheiro <literal role="extension"
>.desktop</literal
> representa uma única aplicação</para
></listitem>

</itemizedlist>
</para>

<para
>Era difícil reorganizar a estrutura no &kde; 3.2, daí o novo formato de menus: <itemizedlist>
<listitem
><para
>Define a estrutura num único ficheiro .menu</para
></listitem>
<listitem
><para
>É baseado em categorias</para
></listitem>
<listitem
><para
>é partilhado entre o <acronym
>GNOME</acronym
> e o &kde;</para
></listitem>
<listitem
><para
>Suporta o estilo de menus do 'applnk' à mesma</para
></listitem>
</itemizedlist>
</para>

<informalexample>
<para
>Exemplo de <filename
>applications.menu</filename
>: <programlisting
><markup>
        &lt;Menu&gt;
            &lt;Name&gt;Office&lt;/Name&gt;
            &lt;Directory&gt;suse-office.directory&lt;/Directory&gt;
            &lt;Include&gt;
                &lt;Filename&gt;Acrobat Reader.desktop&lt;/Filename&gt;
                &lt;Filename&gt;kde-kpresenter.desktop&lt;/Filename&gt;
                &lt;Filename&gt;kde-kword.desktop&lt;/Filename&gt;
            &lt;/Include&gt;
        &lt;Menu&gt;
</markup
>
</programlisting>
</para>
<para
>Entrada de menu com 3 aplicações: <itemizedlist>

<listitem
><para
><filename
>/usr/share/applications/Acrobat Reader.desktop</filename
></para
></listitem>

<listitem
><para
><filename
>/opt/kde3/share/applications/kde/kpresenter.desktop</filename
></para
></listitem>

<listitem
><para
><filename
>/opt/kde3/share/applications/kde/kword.desktop</filename
></para
></listitem>

</itemizedlist>
</para>
</informalexample>
</sect2>

<sect2 id="stored-where">
<title
>Armazenado Onde?</title>

<para
>Os ficheiros <literal role="extension"
>.menu</literal
> descrevem a estrutura do menu. Os ficheiros ficam armazenados em <filename class="directory"
>$<envar
>KDEDIR</envar
>/etc/xdg/menus</filename
> e em <filename class="directory"
>/etc/xdg/menus</filename
>. Estes armazenam a estrutura a nível do sistema e são controlados pela $<envar
>XDG_CONFIG_DIRS</envar
>. A <filename class="directory"
>$<envar
>HOME</envar
>/.config/menus</filename
> guarda as alterações específicas do utilizador na estrutura do menu e é controlada pelo $<envar
>XDG_CONFIG_HOME</envar
>. Para mais informações, veja em <ulink url="http://www.freedesktop.org/Standards/basedir-spec"
>http://www.freedesktop.org/Standards/basedir-spec</ulink
>.</para>

<para
>Os ficheiros <literal role="extension"
>.desktop</literal
> descrevem as aplicações e estão gravados em: <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/applications</filename
>, <filename class="directory"
>/usr/share/applications</filename
>, <filename class="directory"
>/usr/local/share/applications</filename
>. Estes são os ficheiros <literal role="extension"
>.desktop</literal
> a nível da aplicação e são controlados pela $<envar
>XDG_DATA_DIRS</envar
>.</para>

<para
>A <filename class="directory"
>$<envar
>HOME</envar
>/.local/applications</filename
> contém ficheiros <literal role="extension"
>.desktop</literal
> específicos do utilizador, bem como as alterações feitas pelo mesmo. É controlada pela $<envar
>XDG_DATA_HOME</envar
>. Para mais informações, veja em <ulink url="http://www.freedesktop.org/Standards/basedir-spec"
>http://www.freedesktop.org/Standards/basedir-spec</ulink
></para>


<para
>Os ficheiros <literal role="extension"
>.directory</literal
> descrevem os submenus e que estão organizados em: <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/desktop-directories</filename
>, <filename class="directory"
>/usr/share/desktop-directories</filename
>, <filename class="directory"
>/usr/local/share/desktop-directories</filename
>. Estes são os ficheiros de menu <literal role="extension"
>.directory</literal
> a nível do sistema e que são controlados pela $<envar
>XDG_DATA_DIRS</envar
>. As alterações específicas do utilizador são guardadas em <filename class="directory"
>$<envar
>HOME</envar
>/.local/desktop-directories</filename
>. Estas são controladas pela $<envar
>XDG_DATA_HOME</envar
>. Para mais informações, veja em <ulink url="http://www.freedesktop.org/Standards/basedir-spec"
>http://www.freedesktop.org/Standards/basedir-spec</ulink
></para>

<informalexample>
<para
>Exemplo de <filename
>applications.menu</filename
>: <programlisting
><markup>
             &lt;Menu&gt;
                        &lt;Name&gt;Art&lt;/Name&gt;
                        &lt;Directory&gt;suse-edutainment-art.directory&lt;/Directory&gt;
                        &lt;Include&gt;
                                &lt;Category&gt;X-SuSE-Art&lt;/Category&gt;
                        &lt;/Include&gt;
                &lt;/Menu&gt;
</markup
>
</programlisting>
</para>

<para
>O <literal
>Art</literal
> é o nome interno deste menu. O <filename
>suse-edutainment-art.directory</filename
> define o nome o ícone deste menu e inclui todas as aplicações que têm a <literal
>X-SuSE-Art</literal
> listada como categoria, &eg;: <programlisting
>Categories=Qt;KDE;Education;X-SuSE-Art
</programlisting
></para>

<para
>O <filename
>suse-edutainment-art.directory</filename
> define o nome e o ícone deste menu: <programlisting
>[Desktop Entry]
Name=Art e Cultura
Icon=kcmsystem
</programlisting>
</para>
</informalexample>
</sect2>

<sect2 id="common-pitfalls">
<title
>Erros Comuns</title>

<para
>As aplicações <emphasis
>fora</emphasis
> do menu <emphasis
>não</emphasis
> existem em relação às outras aplicações ou associações de ficheiros: Se remover uma aplicação do menu, o &kde; assume que não a quer usar.</para>

<para
>Quando as aplicações não são desejadas no menu, tanto as poderá colocar no menu <filename
>.hidden</filename
> ou num menu dedicado com <programlisting>
NoDisplay=true
</programlisting
> no ficheiro <literal role="extension"
>.directory</literal
></para>
</sect2>

<sect2 id="essential-menus">
<title
>Menus Essenciais</title>

<para
>O <filename class="directory"
>$<envar
>KDEDIR</envar
>/etc/xdg/menus/applications-merged/</filename
> contém o <filename
>kde-essential.menu</filename
>, que inclui alguns menus essenciais que não são mostrados normalmente no menu do &kde; em si: <itemizedlist>
<listitem
><para
>O Centro de Controlo tem um menu de Configuração escondido, cujo conteúdo está definido pelo <filename
>kde-settings.menu</filename
> e cujo ícone e nome está definido em <filename
>kde-settings.directory</filename
></para>
</listitem>
<listitem
><para
>O Centro de Informação tem um menu de Informação escondido, cujo conteúdo está definido pelo <filename
>kde-information.menu</filename
> e cujo ícone e nome está definido em <filename
>kde-information.directory</filename
>.</para>
</listitem>

<listitem
><para
>Os protectores de ecrã contêm um menu escondido Sistema/Protectores de Ecrã, cujo conteúdo está definido em <filename
>kde-screensavers.menu</filename
> e cujo nome e ícone está indicado em <filename
>kde-system-screensavers.directory</filename
>. O <filename
>$<envar
>KDEDIR</envar
>/share/desktop-directories/kde-system-screensavers.directory</filename
> contém: <programlisting
>NoDisplay=true
</programlisting>
</para>
</listitem>
</itemizedlist
></para>
</sect2>

<sect2 id="old-style-menus">
<title
>Menus de Estilo Antigo</title>

<para
>O &kde; continua a suportar os menus antigos que se baseiam na estrutura em pastas em <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/applnk</filename
> (a nível do sistema) e em <filename class="directory"
>$<envar
>HOME</envar
>/.kde/share/applnk</filename
> (a nível do utilizador). Isto verifica-se, a menos que o ficheiro <literal role="extension"
>.desktop</literal
> tenha uma linha  <varname
>Categories</varname
>=. Nesse caso, as categorias determinam a posição no menu.</para>
</sect2>

<sect2 id="ksycoca">
<title
><application
>KSycoca</application
></title>
<para
>O <application
>KSycoca</application
> coloca em 'cache' a estrutura do menu e a informação sobre todas as aplicações possíveis. Poderá reconstruir a base de dados com o comando <userinput
><command
>kbuildsycoca</command
></userinput
>. A base de dados construída fica em <filename class="directory"
>/var/tmp/kdecache-${<envar
>USER</envar
>}/ksycoca</filename
>. É actualizada automaticamente pelo <application
>KDED</application
>, é verificada aquando do arranque do &kde; e o <application
>KDED</application
> vai verificando as suas alterações enquanto se mantém ligado.</para>

<para
>Para desactivar a vigia de alterações (dado que poderá ser incómoda com o NFS), adicione o seguinte ao <filename
>kdedrc</filename
>: <programlisting
>[General]
CheckSycoca=false
</programlisting>
</para>

<para
>Para forçar a regeneração, execute <userinput
><command
>touch $<envar
>KDEDIR</envar
>/share/services/update_ksycoca</command
></userinput
>.</para>

</sect2>

<sect2 id="kmenuedit">
<title
>&kmenuedit;</title>

<para
>O &kmenuedit; é destinado para uma configuração de um único utilizador. As alterações na estrutura do menu são gravadas em <filename
>~/.config/menus/applications-kmenuedit.menu</filename
>, enquanto as alterações nas aplicações são gravadas em <filename class="directory"
>~/.local/share/applications/</filename
>; finalmente, as alterações nos submenus (ícone e nome) são gravadas em <filename class="directory"
>~/.local/share/desktop-directories/</filename
>. A Ferramenta de Administração do KIOSK usa o &kmenuedit; e copia as alterações acima para os locais referentes ao perfil ou ao sistema. </para>

</sect2>

</sect1>

<!-- This section might be redundant. If it isn't, it needs some screenies -->
<sect1 id="kde-panel">
<title
>Painel do &kde;</title>

<para
>O painel do &kde; também é conhecido por &kicker;. Este é modular e consiste nos seguintes componentes: <itemizedlist>
<listitem
><para
>'Applets'</para
></listitem>
<listitem
><para
>Botões de aplicações</para
></listitem>
<listitem
><para
>Botões Especiais</para
></listitem>
</itemizedlist>
</para>

<para
>Por omissão, o painel contém as seguintes 'applets': <itemizedlist
> <listitem
><para
>Paginador - mostra os ecrãs virtuais</para
></listitem
> <listitem
><para
>Barra de Tarefas</para
></listitem
> <listitem
><para
>Bandeja do Sistema</para
></listitem
> <listitem
><para
>Relógio</para
></listitem
> </itemizedlist
> e os seguintes botões especiais: <itemizedlist>
<listitem
><para
>Menu do &kde;</para
></listitem>
<listitem
><para
>Botão do Ecrã</para
></listitem>
</itemizedlist>
</para>

<para
>Também são adicionados vários botões de aplicações, desde que o espaço o permita: <itemizedlist>
<listitem
><para
>Botão de Pasta Pessoal</para
></listitem>
<listitem
><para
>Botão de Navegação</para
></listitem>
<listitem
><para
>Botão KMail</para
></listitem>
</itemizedlist>
</para>
</sect1>

<sect1 id="file-associations">
<title
>Associações de Ficheiros</title>

<para
>As associações de ficheiros atribuem um tipo de ficheiro a uma ou mais aplicações. O tipo do ficheiro é definido através do seu tipo &MIME;. Os tipos &MIME; que são conhecidos pelo &kde; estão guardados em <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/mimelnk</filename
> e o ficheiro <literal role="extension"
>.desktop</literal
> de cada aplicação contém uma lista de tipos &MIME; que são suportados por essa aplicação.</para>

<informalexample>
<para
><filename
>kview.desktop</filename
>: <programlisting
>MimeType=image/gif;image/x-xpm;image/x-xbm;image/jpeg;
image/x-bmp;image/png;image/x-ico;image/x-portable-bitmap;
image/x-portable-pixmap;image/x-portable-greymap;
image/tiff;image/jp2
</programlisting>
</para>

<para
><filename
>kuickshow.desktop</filename
>: <programlisting
>MimeType=image/gif;image/x-xpm;image/x-xbm;image/jpeg;
image/png;image/tiff;image/x-bmp;image/x-psd;image/x-eim;
image/x-portable-bitmap;image/x-portable-pixmap;
image/x-portable-greymap
</programlisting>
</para>

<para
>Ambos podem abrir o 'image/gif'. Qual deles é que é usado para abrir um ficheiro <literal role="extension"
>.gif</literal
>?</para>

<para
>A aplicação com a maior preferência!. O <filename
>kview.desktop</filename
> contém <programlisting>
InitialPreference=3
</programlisting
> enquanto que o <filename
>kuickshow.desktop</filename
> contém <programlisting>
InitialPreference=6
</programlisting
> Como tal, o &kuickshow; será usado para abrir os ficheiros <literal role="extension"
>.gif</literal
>. </para>

<para
>Como é que se pode tornar o &kview; a aplicação por omissão?</para>

<para
>Um utilizador poderá alterar a associação de ficheiros no &kcontrolcenter;. Estas alterações são guardadas no <filename
>$<envar
>HOME</envar
>/.kde/share/config/profilerc</filename
>. Para usar a mesma configuração em vários utilizadores, guarde estas configurações na pasta de perfil do utilizador ou na pasta de configuração global do &kde;, de modo a usá-la por omissão em vários utilizadores.</para>

</informalexample>

</sect1>

</chapter>

<chapter id="locking-down-kde">
<title
>Bloquear o &kde;</title>

<sect1 id="how-it-works-the-basics">
<title
>Como Funciona - As Bases</title>

<para
>As funcionalidades de bloqueio do &kde; estão centradas nas seguintes opções:</para>

<itemizedlist>
<listitem
><para
><link linkend="immutable-configuration-options"
>Tornar opções de configuração imutáveis</link
></para
></listitem>
<listitem
><para
><link linkend="action-restrictions"
>Restrição das acções específicas</link
></para
></listitem>
<listitem
><para
><link linkend="url-restrictions"
>Restringir o acesso a certos &URL;s</link
></para
></listitem>
<listitem
><para
><link linkend="configuration-modules"
>Restringir o acesso a certos módulos de configuração</link
></para
></listitem>
</itemizedlist>

</sect1>

<sect1 id="immutable-configuration-options">
<title
>Opções de Configuração Imutáveis</title>
<subtitle
>Bloquear o &kde;</subtitle>

<para
>As opções imutáveis permitem ao administrador de sistemas oferecer opções por omissão que não podem ser alteradas pelo utilizador.</para>

<para
>As opções de configuração já existente do utilizador serão ignoradas, a partir do momento que uma opção de configuração seja tornada imutável.</para>

<para
>As opções poderão ser controladas com base em cada item, em cada grupo ou num ficheiro por inteiro.</para>

<para
>Se um ficheiro ou um grupo for imutável, todas as opções de configuração para esse ficheiro ou grupo serão imutáveis, mesmo aquelas para as quais o administrador de sistemas não tem nada predefinido.</para>

<note
><para
>O suporte nas aplicações para as opções imutáveis poderá variar de aplicação para aplicação. Ainda que o utilizador não seja capaz de tornar as alterações permanentes para as opções imutáveis, o utilizador verá à mesma uma opção de configuração para poder fazer essa alteração.</para
></note>

</sect1>

<sect1 id="action-restrictions">
<title
>Restrições de Acções</title>

<para
>As aplicações do &kde; estão criadas em torno do conceito de uma acção. As acções poderão ser activadas de várias formas, tipicamente através dos menus, das barras de ferramentas ou de um atalho de teclado. O <action
>Gravar o Documento</action
> é um exemplo de uma acção. Se você conhecer o nome interno de uma acção, é possível restringir uma acção. Quando uma acção for restrita, não irá aparecer mais no menu ou na barra de ferramentas. O nome interno para a acção <action
>Gravar o Documento</action
> é <option
>action/file_save</option
>. A plataforma de bloqueio também oferece um conjunto de restrições mais abstractas que poderão ser usadas para desactivar as funcionalidades que não sejam cobertas por uma dada acção. Um exemplo é a restrição <option
>shell_access</option
> que desactiva todas as funcionalidades que iriam permitir o acesso ao utilizador a uma linha de comandos de &UNIX;.</para>

<example>
<title
>Restringir o Acesso dos Utilizadores às Linhas de Comandos</title>

<para
>Para evitar que o utilizador aceda a uma linha de comandos, poderá restringir a acção <option
>shell_access</option
>, se adicionar o seguinte ao <filename
>kdeglobals</filename
>: </para
> 

<screen
>[KDE Action Restrictions]
shell_access=false</screen>

<para
>Dado que isto afecta o menu do &kde; e as aplicações disponíveis, é necessário forçar uma actualização da base de dados 'sycoca':</para>

<screen
><userinput
><command
>touch</command
> <filename
>$<envar
>KDEDIR</envar
>/share/services/update_ksycoca</filename
></userinput
></screen>

<para
>Agora, ligue-se de novo ao &kde; e verifique os seguintes pontos:</para>

<itemizedlist>
<listitem
><para
>O &kmenu;</para
></listitem>
<listitem
><para
>No &konqueror;, a opção <menuchoice
><guimenu
>Ferramentas</guimenu
><guimenuitem
>Abrir um Terminal</guimenuitem
></menuchoice
></para
></listitem>
<listitem
><para
>O comando de execução com o <keycombo action="simul"
>&Alt;<keycap
>F2</keycap
></keycombo
></para
></listitem>
</itemizedlist>
</example>
<para
>A documentação completa sobre as acções disponíveis poderá ser encontrada em <ulink url="http://www.kde.org/areas/sysadmin/"
>http://www.kde.org/areas/sysadmin/</ulink
>.</para>

<para
>Algumas das acções mais interessantes estão indicadas em baixo:</para>

<variablelist>
<varlistentry>
<term
><option
>action/options_configure</option
></term>
<listitem
><para
>A opção <guimenuitem
>Configurar</guimenuitem
> do menu de <guimenu
>Configuração</guimenu
></para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>action/help_report_bug</option
></term>
<listitem
><para
>A opção <guimenuitem
>Comunicar um Erro</guimenuitem
> do menu <guimenu
>Ajuda</guimenu
>.</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>action/kdesktop_rmb</option
></term>
<listitem
><para
>O menu do &RMB; do ecrã.</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>action/kicker_rmb</option
></term>
<listitem
><para
>O menu do &RMB; para o painel.</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>user/root</option
></term>
<listitem
><para
>Esconde todas as acções ou aplicações que necessitem do acesso do <systemitem class="username"
>root</systemitem
>.</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>shell_access</option
></term>
<listitem
><para
>Esconde todas as acções ou aplicações que fornecem o acesso à linha de comandos.</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>print/system</option
></term>
<listitem
><para
>Desactiva a opção para seleccionar a infra-estrutura de impressão.</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>lock_screen</option
></term>
<listitem
><para
>Se o utilizador poderá bloquear o ecrã</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>start_new_session</option
></term>
<listitem
><para
>Se o utilizador poderá iniciar uma segunda sessão do X (veja também o &kdm;)</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>opengl_screensavers</option
></term>
<listitem
><para
>Se é permitido usar os protectores de ecrã com OpenGL.</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>manipulatescreen_screensavers</option
></term>
<listitem
><para
>Permitir os protectores de ecrã que não escondem o ecrã por inteiro</para
></listitem>
</varlistentry>
</variablelist>

</sect1>

<sect1 id="url-restrictions">
<title
>Restrições de &URL;s</title>

<para
>Existem três tipos de restrições que poderão ser aplicados aos &URL;s:</para>

<variablelist>
<varlistentry>
<term
>listar</term>
<listitem
><para
>Para controlar se é permitido fazer a listagem de uma pasta.</para
></listitem>
</varlistentry>
<varlistentry>
<term
>abrir</term>
<listitem
><para
>Para controlar se certos &URL;s podem ser abertos</para
></listitem>
</varlistentry>
<varlistentry>
<term
>Redireccionar</term>
<listitem
><para
>Para controlar se um &URL; poderá abrir outro &URL;, seja automaticamente ou através de uma hiperligação.</para
></listitem>
</varlistentry>
</variablelist>

<para
>As regras são validadas pela ordem em que são definidas. A última regra que se aplica a um &URL; define se o &URL; poderá ser acedido.</para>

<para
>As seguintes regras desactivam a abertura de &URL;s de HTTP e HTTPS fora do domínio <systemitem class="domainname"
>.companhia.com</systemitem
>:</para>

<screenco
><areaspec>
<area id="url_commas" coords="3"/>
<area id="url_rule1" coords="3"/>
<area id="url_rule2" coords="4"/>
</areaspec>
<screen
>[KDE URL Restrictions]
rule_count=2
rule_1=open,,,,http,,,false
rule_2=open,,,,http,*.empresa.com,,true</screen
></screenco>

<calloutlist>
<callout arearefs="url_commas">
<para
>As primeiras quatro vírgulas saltam o critério de selecção respeitante ao &URL;.de origem. Esta parte só é necessária com as regras do tipo de redireccionamento.</para
> 
</callout>
<callout arearefs="url_rule1"
><para
>A <option
>rule_1</option
> proíbe a abertura de qualquer &URL; de HTTP ou HTTPS</para
></callout>
<callout arearefs="url_rule2"
><para
>A <option
>rule_2</option
> permite a abertura de quaisquer &URL;s de HTTP e HTTPS no domínio <systemitem class="domainname"
>.empresa.com</systemitem
>. Repare que a sequência especial <token
>*</token
> só é permitida no início de um domínio.</para
></callout>
</calloutlist>

<para
>As regras seguintes fazem com que o utilizador não navegue mais nas pastas do sistema de ficheiros local que estejam fora da sua pasta $<envar
>HOME</envar
>:</para>

<screenco
><areaspec>
<area id="home_rule1" coords="3"/>
<area id="home_rule2" coords="4"/>
</areaspec>
<screen
>[KDE URL Restrictions]
rule_count=2
rule_1=list,,,,file,,,false
rule_2=list,,,,file,,$HOME,true</screen
></screenco>

<calloutlist>
<callout arearefs="home_rule1"
><para
>A <option
>rule_1</option
> proíbe a listagem de qualquer pasta local</para
></callout>
<callout arearefs="home_rule2"
><para
>A <option
>rule_2</option
> permite a abertura de ficheiros sob a pasta de $<envar
>HOME</envar
> dos próprios utilizadores.</para
></callout>
</calloutlist>

<para
>A $<envar
>HOME</envar
> e a $<envar
>TMP</envar
> são valores especiais para indicar a pasta pessoal dos utilizadores e a pasta temporária deste, &eg; <filename class="directory"
>/tmp/kde-ze</filename
></para>

<para
>As regras seguintes fazem com que o utilizador não consiga mais abrir os ficheiros locais fora da sua pasta $<envar
>HOME</envar
>:</para>

<screenco
><areaspec>
<area id="local_rule1" coords="3"/>
<area id="local_rule2" coords="4"/>
<area id="local_rule3" coords="5"/>
</areaspec>
<screen
>[KDE URL Restrictions]
rule_count=3
rule_1=open,,,,file,,,false
rule_2=open,,,,file,,$HOME,true
rule_3=open,,,,file,,$TMP,true</screen
></screenco>

<calloutlist>
<callout arearefs="local_rule1"
><para
>A <option
>regra_1</option
> proíbe a abertura de qualquer ficheiro local</para
></callout>
<callout arearefs="local_rule2"
><para
>A <option
>regra_2</option
> permite a abertura de ficheiros sob a pasta de $<envar
>HOME</envar
> dos próprios utilizadores.</para
></callout>
<callout arearefs="local_rule3"
><para
>A <option
>regra_3</option
> permite abrir os ficheiros na pasta temporária do &kde; para o utilizador. Isto é necessário para certas  aplicações do &kde; que transferem primeiro um ficheiro ou documento para a pasta temporária e depois a abrem numa aplicação.</para
></callout>
</calloutlist>


<para
>A opção de redireccionamento controla se os documentos de uma dada localização poderão referenciar, seja de forma automática ou manual via uma hiperligação, outra localização determinada. Está presente um conjunto de regras predefinidas como medida de segurança geral. Por exemplo, os documentos localizados na Internet não poderão referenciar os documentos guardados localmente.</para>

<para
>Por exemplo, se quiser dar ao servidor da Intranet <systemitem class="systemname"
>www.empresa.com</systemitem
> a possibilidade de referenciar os ficheiros locais, poderia ser indicada a seguinte regra:</para>

<screen
>[KDE URL Restrictions]
rule_count=1
rule_1=redirect,http,www.empresa.com,,file,,,true</screen>

<para
>Em vez de indicar um protocolo por nome, também é possível indicar um grupo completo de protocolos. Para isso, foram definidos os seguintes grupos:</para>

<variablelist>
<varlistentry>
<term
>:local</term>
<listitem
><para
>Os protocolos que acedem à informação armazenada localmente, como por exemplo o file:/, o man:/, o fonts:/ e o floppy:/</para
></listitem>
</varlistentry>
<varlistentry>
<term
>:internet</term>
<listitem
><para
>Os protocolos comuns da Internet como o HTTP e o FTP</para
></listitem>
</varlistentry>
</variablelist>

<para
>A informação sobre os protocolos está armazenada nos ficheiros <literal role="extension"
>*.protocol</literal
> que se encontram em <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/services</filename
>.</para>

<para
>O item <option
>Class</option
>= define o grupo a que pertence um determinado protocolo: <userinput
><command
>grep</command
> <option
>Class=</option
> <filename
>$<envar
>KDEDIR</envar
>/share/services/*.protocol</filename
></userinput
></para>

<para
>Regras gerais:</para>

<itemizedlist>
<listitem
><para
>Os protocolos :local poderão referenciar qualquer outro protocolo</para
></listitem>
<listitem
><para
>É sempre permitido referenciar um protocolo :internet</para
></listitem>
<listitem
><para
>Nem todos os protocolos fazem parte de um grupo, como por exemplo o fish:/.</para
></listitem>
</itemizedlist>

</sect1>

<sect1 id="configuration-modules">
<title
>Módulos de Configuração</title>

<para
>O &kde; tem módulos de configuração para personalizar vários aspectos do ambiente do &kde;. Os módulos de configuração aparecem no Centro de Controlo, na janela de Configuração de uma aplicação ou em ambos.</para>

<informalexample>
<para
>O módulo de configuração do 'proxy' aparece no Centro de Controlo mas também como parte da janela para <guilabel
>Configurar o Konqueror</guilabel
> do &konqueror;</para>

<para
>Os módulos de configuração Individuais poderão ser iniciados com o comando <command
>kcmshell</command
> <replaceable
>módulo</replaceable
></para>

<para
>Para iniciar o módulo do 'Proxy', escreva:</para>
<itemizedlist>
<listitem
><para
><command
>kcmshell</command
> <filename
>kde-proxy.desktop</filename
></para
></listitem>
<listitem
><para
><command
>kcmshell</command
> proxy</para
></listitem>
</itemizedlist>

<para
><note
><para
>Nem todas as aplicações usam módulos de configuração, dado que a janela de configuração faz parte integral da aplicação em si.</para
></note
></para>
</informalexample>

<para
>Todos os módulos de configuração fazem parte, de forma restrita, do menu do &kde;.</para>

<itemizedlist>
<listitem>
<para
>Os módulos que estão visíveis no Centro de Controlo têm normalmente um ficheiro <literal role="extension"
>.desktop</literal
> na pasta <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/applications/kde</filename
> e estão ordenados sob o menu <guimenu
>Preferências-Módulos</guimenu
> (<guimenu
>Settings-Modules</guimenu
>) com o ficheiro <filename
>kde-settings.menu</filename
>, incluído a partir do <filename
>kde-essential.menu</filename
></para>
<screen
><userinput
><command
>kbuildsycoca</command
> <option
>--menutest</option
> 2&gt; /dev/null | <command
>grep</command
> Settings-Modules</userinput
></screen>
</listitem>
<listitem>
<para
>Os módulos específicos das aplicações têm normalmente um ficheiro <literal role="extension"
>.desktop</literal
> em <filename
>$<envar
>KDEDIR</envar
>/share/applnk/.hidden</filename
> que corresponde ao menu escondido .hidden, incluído como resultado do <markup
>&lt;KDELegacyDirs/&gt;</markup
></para>
<screen
><userinput
><command
>kbuildsycoca</command
> <option
>--menutest</option
> 2&gt; /dev/null | <command
>grep</command
> .hidden</userinput
></screen>
</listitem>
<listitem
><para
>No &kde; 3.3 é possível editar o Centro de Controlo com o <application
>kcontroledit</application
>. O <application
>kcontroledit</application
> funciona como o <application
>kmenuedit</application
> e altera apenas para o utilizador actual. Use o <application
>kiosktool</application
> para alterar para todos.</para
></listitem
> 
</itemizedlist>

<para
>Os módulos de configuração individuais poderão ser desactivados se adicionar o seguinte ao <filename
>kdeglobals</filename
>:</para>

<screen
>[KDE Control Module Restrictions]
<replaceable
>id-modulo</replaceable
>=false</screen>
<para
>Por exemplo, para desactivar o módulo do 'proxy', use</para>
<screen
>[KDE Control Module Restrictions]
kde-proxy.desktop=false</screen>
<para
>Verifique o Centro de Controlo e a janela para <guilabel
>Configurar o Konqueror</guilabel
> para confirmar se a configuração do 'proxy' ainda lá continua.</para>

</sect1>
<!-- 
<sect1 id="making-it-work">
<title
>Making it Work</title>

Making It Work
KDE 3.2: Set $KDEDIRS from startkde script
Distribute profiles to all clients

</para>
</sect1>
-->
</chapter>

<chapter id="the-lazy-admin">
<title
>O Administrador Preguiçoso</title>

<!-- This section appears to need quite a lot of additional words to -->
<!-- make sense. Perhaps it would be better to comment it out if it -->
<!-- can't be updated before the next release (Phil) -->
<!-- FIXME: Commented it out until it's got some more content fleshing it -->
<!-- out (Lauri)

<sect1 id="lazy-admin-overview">
<title
>Overview</title>

<para>
The Lazy Admin
Overview
Deployment
	How to get &kde; available on many clients
Remote Desktop Sharing
Take a look at someone else desktop
DCOP
	The DCOP command line tool makes it possible to control &kde; applications from the command line
KDialog
	A versatile tool to use standard &kde; dialogs in your own scripts



Deployment
Thin Clients
Installing Software
= AutoYaST
= KickStart
Maintaining Settings
= /etc/kderc, other settings
= Use rsync to copy files around
= Shared filesystem such as NFS
o store profiles themselves on NFS



http://www.suse.de/~nashif/autoinstall/index.html

</para>
</sect1>
-->
<sect1 id="remote-desktop-sharing">
<title
>Partilha Remota de Ecrã</title>

<para
>A partilha de ecrãs remotos permite aos utilizadores remotos verem e, opcionalmente, controlar o ecrã do utilizador actual. O utilizador remoto necessita de receber um convite, sendo possível criar um convite protegido por senha. Isto é ideal para as equipas de suporte técnico ou pelos administradores para ganharem acesso ao ambiente de trabalho dos utilizadores para resolverem problemas ou para resolverem um problema ou ainda guiar o utilizador por um determinado procedimento.</para>

<para
>A partilha de ecrãs remotos envolve duas aplicações: o &krfb; (o 'frame buffer' remoto do &kde;, um servidor de VNC) e o &krdc; (ligação remota ao ecrã do &kde;, um cliente de VNC.)</para>

<para
>O &krfb; pode ser usado por qualquer utilizador para criar e gerir convites. Os convites criam uma senha única que permite ao destinatário ligar-se ao seu computador. Por omissão, é válido para apenas uma única ligação e expira ao fim de uma hora sem utilização.</para>

<para
>As ligações recebidas são tratadas pelo módulo 'kinetd' do 'kded'. Poderá usar o comando <userinput
><command
>dcop</command
> kded kinetd services</userinput
> para ver se está a correr. O &krfb; fica à espera de ligações no porto 5900 por omissão. Quando for recebida uma ligação, irá aparecer uma janela a pedir a confirmação para o utilizador actual.</para>

<!-- TODO: Write a bit more here, with a walk through maybe? -->

</sect1>

<sect1 id="kde-diy">
<title
>Faça Você Mesmo no &kde; - Crie as Suas Próprias Ferramentas</title>

<sect2 id="dcop">
<title
>DCOP</title>

<para
>O Desktop COmmunication Protocol, <acronym
>DCOP</acronym
>, é um mecanismo leve para a comunicação entre processos. O <acronym
>DCOP</acronym
> permite ao utilizador interagir com os programas que estão a correr no momento. O &kde; oferece dois programas para usar o <acronym
>DCOP</acronym
>: o <application
>dcop</application
>, um programa para a linha de comandos e o <application
>kdcop</application
>, um programa gráfico. </para>
<para
>Algumas notas sobre a utilização de <command
>dcop</command
>: </para>

<para>
<itemizedlist>
<listitem>
<para
><command
>dcop</command
> [opções] [aplicação[objecto [função [arg1] [arg2] ... ] ] ] </para>
</listitem>
<listitem>
<para
>As aplicações que podem abrir mais que uma janela de cada vez serão listadas como &lt;aplicação&gt;-<acronym
>PID</acronym
> </para>
</listitem>
<listitem>
<para
>Todos os argumentos fazem distinção entre maiúsculas e minúsculas. O 'setFullScreen' e o 'setfullscreen' são funções diferentes. </para>
</listitem>
<listitem>
<para
>O elemento de expressões regulares '*' pode ser usado nos argumentos da aplicação e dos objectos. <screen
><prompt
>&percnt; </prompt
><userinput
><command
>dcop</command
><option
> kon*</option
></userinput>
konqueror-16006
konsole-8954
</screen>
</para>
</listitem>

</itemizedlist>

</para>

<para
>Seguem-se alguns exemplos de comandos e dos seus resultados: </para>

<informalexample>
<screen
><prompt
>&percnt; </prompt
><userinput
><command
>dcop</command
><option
> konsole*</option
></userinput>
konsole-8954
</screen>
<para
>Uma &konsole; está a correr com o <acronym
>PID</acronym
> 8954.</para>

<screen
><prompt
>&percnt; </prompt
><userinput
><command
>dcop</command
><option
> konsole-8954</option
></userinput>
KBookmarkManager-.../share/apps/kfile/bookmarks.xml
KBookmarkManager-.../share/apps/konqueror/bookmarks.xml
KBookmarkNotifier
KDebug
MainApplication-Interface
konsole (default)
konsole-mainwindow#1
ksycoca
session-1
session-2
session-3
session-4
</screen>
<para
>Aqui pode ver que há quatro sessões a correr.</para>

<screen
><prompt
>&percnt; </prompt
><userinput
><command
>dcop</command
><option
> konsole-8954</option
><option
> konsole</option
></userinput>
QCStringList interfaces()
QCStringList functions()
int sessionCount()
QString currentSession()
QString newSession()
QString newSession(QString type)
QString sessionId(int position)
void activateSession(QString sessionId)
void nextSession()
void prevSession()
void moveSessionLeft()
void moveSessionRight()
bool fullScreen()
void setFullScreen(bool on)
ASYNC reparseConfiguration()
</screen>
<para
>Aqui estão as opções para o programa principal do &konsole;. </para>

<screen
><prompt
>&percnt; </prompt
><userinput
><command
>dcop</command
><option
> konsole-8954</option
><option
> session-1</option
></userinput>
QCStringList interfaces()
QCStringList functions()
bool closeSession()
bool sendSignal(int signal)
void clearHistory()
void renameSession(QString name)
QString sessionName()
int sessionPID()
QString schema()
void setSchema(QString schema)
QString encoding()
void setEncoding(QString encoding)
QString keytab()
void setKeytab(QString keyboard)
QSize size()
void setSize(QSize size)
</screen>
<para
>Aqui estão as opções para a primeira sessão, a 'session-1'.</para>

<screen
><prompt
>&percnt; </prompt
><userinput
><command
>dcop</command
><option
> konsole-8954</option
><option
> konsole</option
><option
> setFullScreen</option
><parameter
> true</parameter
></userinput
>
</screen>
<para
>Coloca a &konsole; em modo de ecrã total.</para>

</informalexample>

<para
>Quando existe mais que uma aplicação/objecto, qual é que deverá usar? Existe alguma referência? </para>
<screen
><prompt
>&percnt; </prompt
><userinput
><command
>echo</command
><option
> $KONSOLE_DCOP</option
></userinput>
DCOPRef(konsole-7547,konsole)

<prompt
>&percnt; </prompt
><userinput
><command
>dcop</command
><option
> $KONSOLE_DCOP</option
><option
> newSession</option
></userinput>
session-6

<prompt
>&percnt; </prompt
><userinput
><command
>dcopstart</command
><option
> konsole</option
></userinput>
konsole-9058


#!/bin/sh
konsole=$(dcopstart konsole-script)
session=$(dcop $konsole konsole currentSession)
dcop $konsole $session renameSession Local

session=$(dcop $konsole konsole newSession)
dcop $konsole $session renameSession Remote

session=$(dcop $konsole konsole newSession)
dcop $konsole $session renameSession Code
dcop $konsole $session sendSession 'cd /my/work/directory'

</screen>

</sect2>

<sect2 id="kdialog">
<title
>KDialog</title>
<subtitle
>Faça-você-mesmo no &kde; - Crie as Suas Próprias Ferramentas</subtitle>

<para
>Você poderá usar as janelas do &kde; nos seus próprios programas para combinar o poder da programação no &UNIX; com a facilidade de uso do &kde;.</para>

<screen
><userinput
><command
>kdialog</command
> <option
>--msgbox 'Tem correio novo!'</option
></userinput
></screen>

<screen
><userinput
><command
>kdialog</command
> <option
>--title 'Correio Novo'</option
> <option
>--msgbox 'Tem correio novo!'</option
></userinput
></screen>

<para
>A componente do <application
>KDialog</application
> poderá ser substituída através da opção <option
>--caption</option
></para>

<screen
><userinput
><command
>kdialog</command
> <option
>--title 'Correio Novo'</option
> <option
>--msgbox 'Tem correio novo!'</option
> <option
>--dontagain ficheiro:chave</option
></userinput
></screen>

<para
>Regista na configuração se deve mostrar de novo, no ficheiro <filename
>$<envar
>KDEHOME</envar
>/share/config/ficheiro</filename
> (registando nesse ficheiros as seguintes linhas:</para>

<screen
>[Notification Messages]
chave=false</screen>

<para
>Em vez do <option
>--msgbox</option
> poderá também usar o <option
>--sorry</option
> e o <option
>--error</option
>, quando for apropriado. Por exemplo, poderá usar o <command
>kdialog</command
> <option
>--sorry 'A rede está inacessível'</option
> ou o <command
>kdialog</command
> <option
>--error 'A caixa de correio não pôde ser aberta'</option
>.</para>

<para
>Também é possível criar mensagens que aceitem uma resposta 'sim' ou 'não'.</para>

<screen
>O <command
>kdialog</command
> <option
>--yesno 'Deseja ligar-se à Internet?'</option
> <command
>echo</command
> <returnvalue
>$?</returnvalue
></screen>

<informaltable>
<tgroup cols="2">
<thead>
<row>
<entry
>Valor Devolvido</entry>
<entry
>Significado</entry>
</row>
</thead>
<tbody>
<row
><entry
>0</entry
><entry
>Sim, OK, Continuar</entry
></row>
<row
><entry
>1</entry
><entry
>Não</entry
></row>
<row
><entry
>2</entry
><entry
>Cancelar</entry
></row>
</tbody>
</tgroup>
</informaltable>

<para
>Certifique-se que guarda o resultado numa variável se não o usar directamente, dado que o próximo comando irá preencher o $? com um valor novo. Poderá usar o <option
>--dontagain</option
> aqui também, dado que irá recordar a escolha do utilizador e devolvê-la-á das próximas vezes sem mostrar a janela de novo.</para>

<para
>As outras variações são:</para>

<variablelist>
<varlistentry>
<term
><option
>--warningyesno</option
></term>
<listitem>
<para
>como o <option
>--yesno</option
>, mas com um ícone diferente</para>
</listitem>
</varlistentry>
<varlistentry>
<term
><option
>--warningcontinuecancel</option
></term>
<listitem
><para
>Com os botões <guibutton
>Continuar</guibutton
> e <guibutton
>Cancelar</guibutton
>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term
><option
>--warningyesnocancel</option
></term>
<listitem
><para
>Com os botões <guibutton
>Sim</guibutton
>, <guibutton
>Não</guibutton
> e <guibutton
>Cancelar</guibutton
>. Por exemplo:</para>
<screen
><command
>kdialog</command
> <option
>--warningyesnocancel 'Deseja gravar as alterações?'</option
></screen>
</listitem>
</varlistentry>
</variablelist>

<screen
><command
>kdialog</command
> <option
>--inputbox "Indique o seu nome:" "OSeuNome"</option
></screen>

<para
>O resultado é impresso no 'stdout'; para o colocar numa variável, poderá escrever algo do género <userinput
>nome=$(kdialog --inputbox "Indique o seu nome:" "OSeuNome")</userinput
>. O último argumento é opcional e é usado para preencher antecipadamente a janela.</para>

<screen
><userinput
><varname
>senha</varname
>=$(<command
>kdialog</command
> <option
>--password "Indique a sua senha:"</option
>)</userinput
></screen>

<para
>A opção <option
>--dontagain</option
> não funciona com o <option
>--inputbox</option
> ou o <option
>--password</option
></para>

<para
>Existem duas janelas que permitem ao utilizador fazer uma selecção numa lista:</para>

<variablelist>
<varlistentry>
<term
><option
>--menu</option
></term>
<listitem>
<para
>Permite ao utilizador seleccionar um único item de uma lista.</para>
</listitem>
</varlistentry>
<varlistentry>
<term
><option
>--checklist</option
></term>
<listitem>
<para
>Permite ao utilizador seleccionar um ou mais itens de uma lista.</para>
</listitem>
</varlistentry>
</variablelist>

<screen
><userinput
><varname
>cidade</varname
>=$(<command
>kdialog</command
> <option
>--menu "Seleccione uma cidade" a Londres b Madrid c Paris d Lisboa</option
>)</userinput
></screen>

<para
>O <varname
>$cidade</varname
> irá devolver <returnvalue
>a</returnvalue
>, <returnvalue
>b</returnvalue
>, <returnvalue
>c</returnvalue
> ou <returnvalue
>d</returnvalue
>.</para>

<screen
><userinput
><varname
>cidade</varname
>=$(<command
>kdialog</command
> <option
>--checklist "Seleccione as cidades" a Londres off b Madrid on c Paris on d Lisboa off</option
>)</userinput
></screen>

<para
>Madrid e Paris irão estar pré-seleccionados. O resultado com Madrid e Paris seleccionados será <returnvalue
>"b"</returnvalue
> <returnvalue
>"c"</returnvalue
>.</para>

<para
>Se adicionar a opção <option
>--separate-output</option
>, irá colocar o <returnvalue
>b</returnvalue
> e o <returnvalue
>c</returnvalue
> cada um na sua linha, tornando o resultado mais simples de processar.</para>

<screen
>file=$(kdialog --getopenfilename $HOME)
file=$(kdialog --getopenfilename $HOME "*.png *.jpg|Ficheiros de Imagem")
file=$(kdialog --getsavefilename $HOME/GraveMe.png)
file=$(kdialog --getexistingdirectory $HOME)</screen>

</sect2>

</sect1>

</chapter>
&groupware-with-kontact; </part>

<!-- Keep this comment at the end of the file
Local variables:
mode: xml
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:nil
sgml-general-insert-case:lower
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:0
sgml-indent-data:true
sgml-parent-document:("index.docbook" "book" "part")
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
