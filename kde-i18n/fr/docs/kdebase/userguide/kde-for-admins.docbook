<part id="kde-for-administrators">
<partinfo>
<authorgroup>
<author
><personname
> <firstname
>Waldo</firstname
> <surname
>Bastian</surname
> </personname
> <email
>bastian@kde.org</email
> </author>
<othercredit role="reviewer"
>&Philip.Rodrigues; &Philip.Rodrigues.mail; </othercredit>
</authorgroup>
</partinfo>

<title
>&kde; pour les administrateurs</title>

<chapter id="kde-internals">
<title
>Au cœur de &kde;</title>

<sect1 id="kde-for-admins-overview">
<title
>Vue d'ensemble</title>
<para
>À écrire</para>
</sect1>

<sect1 id="directory-layout">
<title
>Disposition des dossiers</title>

<para
>&kde; définit une hiérarchie de systèmes de fichiers que l'environnement &kde; lui-même ainsi que toutes les applications &kde; utilisent. En général, &kde; stocke tous ses fichiers dans une arborescence de dossiers avec une structure fixe. </para>

<para
>Par défaut, &kde; utilise deux arborescences :</para>

<itemizedlist>
<listitem
><para
>une au niveau du système (par exemple <filename class="directory"
>/opt/kde3</filename
>),</para
></listitem>
<listitem
><para
>une au niveau utilisateur dans le dossier personnel de l'utilisateur (généralement <filename class="directory"
> ~/.kde</filename
>).</para
></listitem>
</itemizedlist>

<para
>En tant qu'administrateur système, vous pouvez créer des branches additionnelles. Les arborescences additionnelles peuvent être utilisées en tant que <link linkend="user-profiles"
>profils</link
></para>

<informalexample
><para
>&SuSE; &Linux;, par exemple, utilise :</para>

<itemizedlist>
<listitem
><para
><filename
class="directory"
>$<envar
>HOME</envar
>/.kde</filename
></para
></listitem>
<listitem
><para
><filename class="directory"
>/opt/kde3</filename
>. (ceci est propre à &SuSE;, il se peut que d'autres distributions emploient <filename class="directory"
>/usr</filename
> ou <filename class="directory"
>/usr/kde3</filename
>)</para
></listitem>
<listitem
><para
><filename class="directory"
>/etc/opt/kde3</filename
>. (ceci a été ajouté par &SuSE;).</para
></listitem>
</itemizedlist>

<para
>Si vous avez installé la version 0.7 ou supérieure de l'outil d'administration KIOSK, vous pouvez vérifier quelles sont les arborescences de dossiers utilisées avec la commande suivante : <userinput
><command
>kiosktool-kdedirs</command
> <option
>--check</option
></userinput
></para>
</informalexample>

<para
>&kde; et les applications &kde; applications examinent les fichiers en analysant toutes les arborescences de dossiers &kde;. Ces dernières sont vérifiées par ordre de priorité. Quand un fichier est présent dans plusieurs arborescences de dossiers, le fichier provenant de la dernière arborescence prend la priorité. Normalement, l'arborescence située dans le dossier personnel de l'utilisateur a la priorité la plus élevée. C'est également l'arborescence de dossiers dans laquelle les changements sont enregistrés.</para>

<informalexample>
<para
>Pour obtenir des informations sur le type &MIME; <literal
>text/plain</literal
>, une recherche est effectuée sur les fichiers suivants :</para>

<itemizedlist>
<listitem
><para
><filename
class="directory"
>$<envar
>HOME</envar
>/.kde/share/mimelnk/text/plain.desktop</filename
></para
></listitem>
<listitem
><para
><filename
class="directory"
>/opt/kde3/share/mimelnk/text/plain.desktop</filename
></para
></listitem>
<listitem
><para
><filename
class="directory"
>/etc/opt/kde3/share/mimelnk/text/plain.desktop</filename
></para
></listitem>
</itemizedlist>

<para
>Si un utilisateur apporte un changement, celui-ci est écrit dans <filename class="directory"
>$<envar
>HOME</envar
>/.kde/share/mimelnk/text/plain.desktop</filename
></para>
</informalexample>

<para
>Pour les fichiers de configuration, les choses sont un peu différentes. Si des fichiers de configuration multiples du même nom sont trouvés dans les arborescences de dossiers, leur contenu est combiné. L'ordre de priorité des arborescences de dossiers joue un rôle ici. Quand deux fichiers définissent la même clé de configuration, le fichier ayant la priorité la plus élevée est utilisé pour la clé.</para>

<informalexample
><para
>Par exemple, si les deux fichiers suivants existent, avec ces contenus :</para>
<variablelist>
<varlistentry
><term
><filename
>$<envar
>HOME</envar
>/.kde/share/config/foobar</filename
></term>
<listitem
><programlisting
>Color=red
Shape=circle
</programlisting>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename
>/etc/opt/kde3/share/config/foobar</filename
></term>
<listitem
><programlisting
>Position=10,10
</programlisting>
</listitem>
</varlistentry>
</variablelist>

<para
>Les fichiers seront fusionnés pour produire :</para>

<programlisting
>Color=red
Shape=circle
Position=10,10
</programlisting>

</informalexample>
</sect1>

<sect1 id="specifying-directories">
<title
>Spécifier des dossiers</title>

<para>

<segmentedlist>
<segtitle
>Variable d'environnement</segtitle>
<segtitle
>Exemples de réglage(s)</segtitle>
<segtitle
>Commentaire</segtitle>

<seglistitem>
<seg
><envar
>KDEHOME</envar
></seg>
<seg
><filename class="directory"
>~/.kde</filename
></seg>
<seg
></seg>
</seglistitem>

<seglistitem>
<seg
><envar
>KDEROOTHOME</envar
></seg>
<seg
><filename class="directory"
>/root/.kde</filename
></seg>
<seg
>Variable différente pour empêcher root d'écrire dans la variable $KDEHOME de l'utilisateur après avoir exécuté <command
>su</command
>.</seg>
</seglistitem>

<seglistitem>
<seg
><envar
>KDEDIR</envar
></seg>
<seg
><filename class="directory"
>/opt/kde3</filename
>, <filename class="directory"
>/usr</filename
>, <filename class="directory"
>/usr/kde3</filename
></seg>
<seg
>Dépend du distributeur. Utilisée par &kde; 2. Si elle n'est pas définie, revient à une valeur compilée en dur par défaut.</seg>
</seglistitem>

<seglistitem>
<seg
><envar
>KDEDIRS</envar
></seg>
<seg
><filename class="directory"
>/opt/kde3</filename
>, <filename class="directory"
>/usr</filename
>, <filename class="directory"
>/usr/kde3</filename
></seg>
<seg
>Nouvelle dans &kde;3. Peut répertorier des emplacements multiples séparés par un caractère « : ». Si elle n'est pas définie, revient à $<envar
>KDEDIR</envar
></seg>
</seglistitem>

</segmentedlist>
</para>
<para
>N'a pas <emphasis
>besoin</emphasis
> d'être définie, les valeurs par défaut fonctionnent de manière satisfaisante.</para>
<para
>Vous exécutez &kde;2 en parallèle avec &kde;3 ? Faites pointer $<envar
>KDEDIR</envar
> sur &kde; 2 et $<envar
>KDEDIRS</envar
> sur &kde; 3.</para>

<informalexample>
<para
>Un membre du personnel d'une université pourrait avoir les réglages suivants :</para>
<programlisting
>KDEHOME='~/.kde3'
KDEROOTHOME='/root/.kde3'
KDEDIRS='/opt/kde_staff:/opt/kde3'
</programlisting>

</informalexample>

</sect1>

<sect1 id="user-profiles">
<title
>Profils utilisateur</title>

<para
>Dans l'exemple précédent, <filename class="directory"
>/opt/kde_staff</filename
> contenait des réglages et des applications additionnels pour des membres du personnel. Les <quote
>profils utilisateur</quote
> vous permettent de n'ajouter ce dossier que pour certains utilisateurs et non pour d'autres. Ajoutez ce qui suit à <filename
>/etc/kderc</filename
> :</para>

<programlisting
>[Directories-staff]
prefixes=/opt/kde_staff
</programlisting>

<para
>Ceci crée un profil nommé « staff », qui ajoute l'arborescence de dossier <filename class="directory"
>/opt/kde_staff</filename
>. (Notez que &SuSE; &Linux; utilise <filename
>/etc/kde3rc</filename
> au lieu de <filename
>/etc/kderc</filename
>). Maintenant que nous avons un profil nommé, il est possible de l'affecter à des utilisateurs.</para>

<para
>Pour faire correspondre des profils à des utilisateurs, il faut spécifier un fichier de correspondance dans <filename
>/etc/kderc</filename
> :</para>

<programlisting
>[Directories]
userProfileMapFile=/etc/kde-user-profile
</programlisting>

<para
>Il est à présent possible d'affecter un profil en fonction soit du nom de l'utilisateur, soit du groupe &UNIX; dont l'utilisateur fait partie.</para
> 

<para
>Pour affecter le profil « staff » à tous les utilisateurs qui sont membres du groupe staff_members &UNIX;, ajouter ce qui suit à <filename
>/etc/kde-user-profile</filename
> :</para>

<programlisting
>[General]
groups=staff_members
[Groups]
staff_members=staff
</programlisting>

<para
>Il est également possible d'affecter un profil à un seul utilisateur :</para>

<programlisting
>[Users]
bastian=staff
</programlisting>

</sect1>

<sect1 id="directory-layout-revisited">
<title
>Disposition des dossiers revisitée</title>

<para
>Chaque arborescence de dossiers qu'emploie &kde; a une structure de dossier fixe. Il est néanmoins possible de laisser de côté les dossiers sans rapport avec un dossier donné ou qui ne sont simplement pas utilisés. Par exemple, les dossiers auxquels les fichiers temporaires font appel se trouvent habituellement sous <filename class="directory"
>$<envar
>KDEHOME</envar
></filename
>, mais non dans n'importe quelle autre arborescence de dossiers.</para>

</sect1>

<sect1 id="architecture-specific-directories">
<title
>Dossiers propres à une architecture</title>

<para
>Dossiers propres à une architecture (type de système d'exploitation et de processeur) :</para>

<variablelist>
<varlistentry>
<term
><filename class="directory"
>bin</filename
></term>
<listitem
><para
>Utilisé pour les exécutables &kde;.</para
></listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>lib</filename
></term>
<listitem
><para
>Utilisé pour les bibliothèques &kde;.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>lib/kde3</filename
></term>
<listitem
><para
>Ce dossier contient des composants, modules externes et autres objets qu'il est possible de charger au moment de l'exécution, à l'usage des applications &kde; 3.<replaceable
>x</replaceable
>.</para
></listitem
> 
</varlistentry>
</variablelist>

</sect1>

<sect1 id="shared-directories">
<title
>Dossiers partagés</title>

<para
>Partagé : non propre à une architecture, peut être partagé entre différentes architectures.</para>

<variablelist>
<varlistentry>
<term
><filename class="directory"
>share/applnk</filename
></term>
<listitem
><para
>fichiers <literal role="extension"
>.desktop</literal
> pour le menu &kde; (ancien)</para
></listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/applications</filename
></term>
<listitem
><para
>fichiers <literal role="extension"
>.desktop</literal
> pour le menu &kde; (depuis &kde; 3.2)</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/apps</filename
></term>
<listitem
><para
>Contient des fichiers de données propres à une application. Chaque application a ici un sous-dossier pour stocker des fichiers de données additionnels.</para
></listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/config</filename
></term>
<listitem
><para
>Fichiers de configuration. Les fichiers de configuration sont normalement nommés après l'application à laquelle ils appartiennent, plus les lettres <quote
>rc</quote
>. Un cas spécial est <filename
>kdeglobals</filename
>. Ce fichier est lu par toutes les applications &kde;.</para
></listitem>
</varlistentry>

<varlistentry>
<term
><filename
class="directory"
>share/config/session</filename
></term>
<listitem
><para
>Ce dossier est utilisé par la gestion de session et n'est normalement disponible que sous <filename class="directory"
>$<envar
>KDEHOME</envar
></filename
>. À la fin d'une session, les applications &kde; y enregistrent leur état. Les noms des fichiers se composent du nom de l'application suivi d'un nombre. Le gestionnaire de session <command
>ksmserver</command
> stocke les références à ces nombres lors de l'enregistrement d'une session dans <filename
>ksmserverrc</filename
>.</para
></listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/doc/HTML</filename
></term>
<listitem
><para
>Ce dossier contient de la documentation pour les applications &kde;. La documentation est classifiée par langue et selon l'application à laquelle elle appartient. Normalement, on trouve au moins deux fichiers dans un dossier : <filename
>index.docbook</filename
>, qui contient la documentation au format DocBook non formaté et <filename
>index.cache.bz2</filename
>, qui contient la même documentation au format &HTML; compactée sous <command
>bzip2</command
>. La version &HTML; est celle qu'utilise le &centreAide;. Si elle est absente, le &centreAide; la régénère à partir de la version DocBook, mais c'est un processus qui prend du temps.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/icons</filename
></term>
<listitem
><para
>Sous ce dossier, sont stockées les icônes. Les icônes sont classées par catégories de thème, dimension et utilisation.</para
></listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/mimelnk</filename
></term>
<listitem
><para
>Dans ce dossier, sont stockés les fichiers <literal role="extension"
>.desktop</literal
> qui décrivent les types &MIME;. &kde; fait appel aux types &MIME; pour identifier le type d'un fichier.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/services</filename
></term>
<listitem
><para
>Ce dossier contient les fichiers <literal role="extension"
>.desktop</literal
>, qui décrivent des services. Les services sont comme les applications, mais ce sont habituellement d'autres applications au lieu de l'utilisateur qui les lancent. Ils n'apparaissent pas dans le menu &kde;</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/servicetypes</filename
></term>
<listitem
><para
>Ce dossier contient les fichiers <literal role="extension"
>.desktop</literal
> qui décrivent les servicetypes. Un servicetype représente d'ordinaire une certaine interface de programmation. Les applications et les services regroupent dans leurs fichiers <literal role="extension"
>
>.desktop</literal
> les servicetypes qu'ils fournissent.</para
> </listitem
></varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/sounds</filename
></term>
<listitem
><para
>Ce dossier contient les fichiers son.</para
></listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/templates</filename
></term>
<listitem
><para
>Ce dossier contient les modèles permettant de créer des fichiers de divers types. Un modèle se compose d'un fichier <literal role="extension"
>.desktop</literal
>, qui décrit le fichier et renferme une référence à un fichier dans le sous-dossier <filename class="directory"
>.source</filename
>. Les modèles de ce dossier apparaissent dans le menu <guimenu
>Créer un nouveau</guimenu
> disponible sur le bureau et dans l'explorateur de fichiers. Quand un utilisateur sélectionne un modèle dans le menu, son fichier source est copié.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename class="directory"
>share/wallpapers</filename
></term>
<listitem
><para
>Ce dossier contient des images que l'on peut employer comme fond d'écran.</para
></listitem>
</varlistentry>

</variablelist>

</sect1>

<sect1 id="host-specific-directories">
<title
>Dossiers propres à un hôte</title
> 

<para
>Il y a trois dossiers propres à un hôte, qui sont l'objet d'un lien symbolique vers d'autres emplacements. Si les dossiers n'existent pas déjà, les liens symboliques et les dossiers suivants seront créés à l'aide de l'utilitaire <command
>lnusertemp</command
> :</para>

<variablelist>

<varlistentry>
<term
><filename
>$<envar
>KDEHOME</envar
>/socket-$<envar
>HOSTNAME</envar
></filename
></term>
<listitem
><para
>Habituellement, <filename class="directory"
>/tmp/ksocket-$<envar
>USER</envar
>/</filename
> est utilisé pour divers sockets &UNIX;.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename
>$<envar
>KDEHOME</envar
>/tmp-$<envar
>HOSTNAME</envar
></filename
></term>
<listitem
><para
>Habituellement, <filename class="directory"
>/tmp/kde-$<envar
>USER</envar
>/</filename
> est utilisé pour les fichiers temporaires.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename
>$<envar
>KDEHOME</envar
>/cache-$<envar
>HOSTNAME</envar
></filename
></term>
<listitem
><para
>Habituellement, <filename class="directory"
>/var/tmp/kdecache-$<envar
>USER</envar
>/</filename
> : est utilisé pour les fichiers mis en cache.</para>
</listitem>
</varlistentry>
</variablelist>

<para
>Du fait que les deux fichiers <filename class="directory"
>/tmp</filename
> et <filename class="directory"
>/var/tmp</filename
> sont universellement inscriptibles, il est possible que les dossiers ci-dessus existent déjà, mais qu'ils soient la propriété d'un autre utilisateur. Dans ce cas, l'utilitaire <command
>lnusertemp</command
> crée un nouveau dossier avec un autre nom et un lien vers celui-ci à la place.</para>

</sect1>

<sect1 id="configuration-files">
<title
>Fichiers de configuration</title
> <para
>&kde; utilise un format de fichiers de type texte simple pour tous ses fichiers de configuration. Il se compose de paires clé-valeur qui sont placées dans des groupes. Tous les fichiers de configuration &kde; font appel à l'encodage <acronym
>UTF</acronym
>-8 pour le texte en dehors de la plage <acronym
>ASCII</acronym
>.</para>

<para
>Le début d'un groupe est indiqué par un nom de groupe qui est placé entre crochets. Tous les éléments clé-valeur qui suivent appartiennent au groupe. Le groupe se termine soit quand un autre groupe commence, soit quand la fin du fichier est atteinte. Les éléments situés au début du fichier qui ne sont pas précédés d'un nom de groupe appartiennent au groupe par défaut.</para>

<informalexample
><para
>L'exemple suivant montre un fichier de configuration qui se compose de deux groupes. Le premier groupe contient les clés <varname
>LargeCursor</varname
> et <varname
>SingleClick</varname
>, tandis que le second groupe contient les clés <varname
>Show hidden files</varname
> et <varname
>Sort by</varname
> :</para>

<programlisting
>[KDE]
LargeCursor=false
SingleClick=true
</programlisting>

<programlisting
>[KFileDialog Settings]
Show hidden files=false
Sort by=Name
</programlisting>
</informalexample>

<para
>Les éléments d'un groupe se composent d'une clé et d'une valeur séparées par un signe égal. La clé peut contenir des espaces et être suivie d'options placées entre crochets. La partie après le signe égal est la valeur de l'élément. Tout blanc entourant le signe égal est ignoré, comme s'il s'agissait d'un espace de fin quelconque. En bref, le format est :</para>

<programlisting
><replaceable
>élément</replaceable
>=<replaceable
>valeur</replaceable
>
</programlisting>

<para
>Si une valeur est censée inclure un espace au début ou à la fin, il est possible de l'obtenir à l'aide d'une barre oblique inverse suivie d'un <quote
>s</quote
>.</para>

<para
>Il y a plusieurs autres codes de barres obliques inverses. En voici une liste complète : <itemizedlist>
<listitem
><para
><token
>\s</token
> peut servir d'espace,</para>
</listitem>
<listitem
><para
><token
>\t</token
> peut servir à insérer une tabulation,</para>
</listitem>
<listitem
><para
><token
>\r</token
> pour un caractère retour chariot,</para>
</listitem>
<listitem
><para
><token
>\n</token
> pour un caractère saut de ligne (retour à la ligne),</para>
</listitem>
<listitem
><para
><token
>\\</token
> pour insérer la barre oblique inverse proprement dite.</para>
</listitem>
</itemizedlist
></para>

<informalexample
><para
>Dans l'exemple suivant, la valeur de l'élément <varname
>Caption</varname
> commence par deux espaces, tandis que l'élément <varname
>Description</varname
> contient trois lignes de texte. Les sauts de ligne en notation barre oblique inverse sont utilisés pour séparer les différentes lignes.</para>

<programlisting
>[Preview Image]
Caption=\s Ma légende
Description=Ceci est\nune très longue\ndescription.
</programlisting>
</informalexample>

<para
>Les lignes vides dans les fichiers de configuration sont ignorées, puisque ce sont des lignes qui commencent par un caractère dièse (« # »). Le caractère dièse peut être utilisé pour ajouter des commentaires aux fichiers de configuration. On notera que quand une application &kde; met à jour un fichier de configuration, les commentaires <emphasis
>ne</emphasis
> sont <emphasis
>pas</emphasis
> préservés.</para>

<para
>Il peut y avoir de multiples fichiers de configuration du même nom dans le sous-dossier <filename class="directory"
>share/config</filename
> des diverses arborescences de dossiers &kde;. Dans ce cas, les informations de tous ces fichiers de configuration sont combinées selon un principe clé par clé. Si la même clé au sein d'un groupe donné est définie dans plusieurs endroits, la valeur clé lue depuis l'arborescence des dossiers ayant la priorité la plus élevée sera utilisée. Les fichiers de configuration sous <filename class="directory"
>$<envar
>KDEHOME</envar
></filename
> ont toujours la priorité la plus élevée. Si une clé dans un groupe donné est définie plusieurs fois dans un seul fichier, la valeur du dernier élément est utilisée.</para>

<informalexample>
<para
>Si <filename
>$<envar
>HOME</envar
>/.kde/share/config/foobar</filename
> contient : <programlisting>
[MyGroup]
Color=red
Shape=circle
</programlisting
> et si <filename
>/etc/opt/kde3/share/config/foobar</filename
> contient <programlisting>
[MyGroup]
Color=blue
Position=10,10
</programlisting
>, le résultat sera : <programlisting
>[MyGroup]
Color=red
Shape=circle
Position=10,10
</programlisting>
</para>
</informalexample>

<informalexample>
<para
>Si <filename
>$<envar
>HOME</envar
>/.kde/share/config/foobar</filename
> contient <programlisting>
[MyGroup]
Color=red
Shape=circle
[MyGroup]
Color=green
</programlisting
> et si <filename
>/opt/kde_staff/share/config/foobar</filename
> contient <programlisting>
[MyGroup]
Color=purple
Position=20,20
</programlisting
> et si <filename
>/etc/opt/kde3/share/config/foobar</filename
> contient <programlisting>
[MyGroup]
Color=blue
Position=10,10
</programlisting
>, le résultat sera : <programlisting
>[MyGroup]
Color=green
Shape=circle
Position=20,20
</programlisting>
</para>
</informalexample>

<para
>Pour empêcher les utilisateurs de pouvoir annuler les réglages par défaut, il est possible de marquer ces réglages comme immuables. On peut rendre les réglages immuables individuellement, par groupe ou par fichier. Un élément individuel peut être verrouillé en ajoutant <userinput
>[$i]</userinput
> à côté de la clé, &pex; : <programlisting
>Color[$i]=blue
</programlisting>
</para>
<para
>On peut verrouiller un groupe d'éléments en plaçant <userinput
>[$i]</userinput
> à côté du nom du groupe, &pex; : <programlisting
>[MyGroup][$i]
</programlisting>
</para>
<para
>Pour verrouiller le fichier entier, commencez-le par <userinput
>[$i]</userinput
> sur une seule ligne, &cad; : <programlisting
>[$i]
</programlisting>
</para>

<informalexample>
<para
>Si <filename
>$<envar
>HOME</envar
>/.kde/share/config/foobar</filename
> contient : <programlisting>
[MyGroup]
Color=red
Shape=circle
</programlisting
> et si <filename
>/etc/opt/kde3/share/config/foobar</filename
> contient : <programlisting>
[MyGroup][$i]
Color=blue
Position=10,10
</programlisting
>, le résultat sera : <programlisting
>[MyGroup]
Color=blue
Position=10,10
</programlisting>
</para>
</informalexample>

<informalexample
><para
>Si <filename
>$<envar
>HOME</envar
>/.kde/share/config/foobar</filename
> contient : <programlisting>
[MyGroup]
Color=red
Shape=circle
</programlisting
> et si <filename
>/opt/kde_staff/share/config/foobar</filename
> contient <programlisting>
[MyGroup]
Color=purple
Shape=rectangle
</programlisting
> et si <filename
>/etc/opt/kde3/share/config/foobar</filename
> contient <programlisting>
[MyGroup][$i]
Color=blue
Position=10,10
</programlisting
> le résultat sera <programlisting
>[MyGroup]
Color=purple
Shape=rectangle
Position=10,10
</programlisting>
</para>
</informalexample>


<para
>On peut faire intervenir ce qu'on appelle l'« expansion du shell » pour fournir plus de valeurs par défaut dynamiques. Avec l'expansion du shell, la valeur d'une clé de configuration peut être construite à partir de la valeur d'une variable d'environnement ou de la sortie d'une commande shell. Pour activer l'expansion du shell pour un élément de configuration, la clé doit être suivie de <token
>[$e]</token
>. Normalement, la forme étendue est écrite dans le fichier de configuration de l'utilisateur après la première utilisation. Pour empêcher cela, il est recommandé de verrouiller l'élément de configuration à l'aide de <token
>[$ie]</token
>. L'utilisateur ne peut évidemment pas le changer ensuite.</para>

<informalexample>
<para
>Dans l'exemple suivant, la valeur de l'élément <varname
>Host</varname
> est déterminée par la sortie du programme <command
>hostname</command
> Ce paramètre est également verrouillé pour garantir que la valeur est toujours déterminée dynamiquement.</para>

<para
>La valeur concernant l'élément <varname
>Email</varname
> est déterminée en remplissant les valeurs des variables d'environnement $<envar
>USER</envar
> et $<envar
>HOST</envar
>. Quand <systemitem class="username"
>joseph</systemitem
> est connecté sur <systemitem class="systemname"
>joseph_host</systemitem
>, on obtient une valeur égale à <literal
>joseph@joseph_host</literal
>. Le paramètre n'est pas verrouillé.</para>

<programlisting
>[Mail Settings] 
Host[$ie]=$(hostname)
Email[$e]=${USER}@${HOST}
</programlisting>
</informalexample>

<para
>La plupart des éléments de configuration peuvent être indexés avec un code de langue. Dans ce cas, la langue que l'utilisateur a choisie sur le bureau sert à rechercher la valeur de la clé. Si l'on a choisi la langue par défaut (anglais américain) ou s'il n'a pas d'index qui correspond à la langue choisie, l'élément clé sans index est utilisé.</para>

<informalexample>
<para
>Dans l'exemple suivant, la valeur de l'élément <varname
>Caption</varname
> dépend de la langue. Si l'utilisateur a choisi le français (code de langue <literal
>fr</literal
>), la valeur de l'élément sera « Ma légende ». Dans tous les autres cas, la valeur « My Caption » sera utilisée.</para>

<programlisting
>[Preview Image]
Caption=My Caption
Caption[fr]=Ma légende
</programlisting>
</informalexample>

<informalexample>
<para
>Dans cet exemple, la valeur de l'élément <varname
>Caption</varname
> dépend de la langue. Si l'utilisateur a choisi le français (code de langue <literal
>fr</literal
>), la valeur de l'élément sera « Ma légende ». Dans tous les autres cas, la valeur « My Caption » sera utilisée.</para>

<programlisting
>[Preview Image]
Caption=My Caption
Caption[fr]=Ma légende
</programlisting>
</informalexample>

<para
>En général, les éléments susceptibles d'apparaître dans un fichier de configuration ne sont pas documentés. &kde; 3.2 a permis de commencer à changer cet état de choses. Dans <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/config.kcfg</filename
>, se trouvent des fichiers qui fournissent une description formelle des éléments possibles dans un fichier de configuration. Le nouvel éditeur de configuration &kde; s'en sert quand ils sont disponibles.</para>

<informalexample>
<para
>Voici un exemple de fichier de configuration &XML; : <programlisting
><markup>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE kcfg SYSTEM "http://www.kde.org/standards/kcfg/1.0/kcfg.dtd"&gt;
&lt;kcfg&gt;
    &lt;kcfgfile name="korganizerrc"/&gt;
    &lt;group name="General"&gt;
         &lt;entry type="Bool" key="Auto Save"&gt;
             &lt;label&gt;Enable automatic saving of calendar&lt;/label&gt;
             &lt;default&gt;true&lt;/default&gt;
         &lt;/entry&gt;
         &lt;entry type="Int" key="Auto Save Interval"&gt;
             &lt;default&gt;10&lt;/default&gt;
         &lt;/entry&gt;
    &lt;/group&gt;
&lt;/kcfg&gt;
</markup
>
</programlisting>
</para>
<para
>Il a le même effet que : <programlisting
>[General]
Auto Save=false
Auto Save Interval=25
</programlisting>
</para>
</informalexample>

</sect1>

<sect1 id="kde-startup-sequence">
<title
>Séquence de démarrage de &kde;</title>

<sect2 id="kdm">
<title
>&kdm;</title>

<para
>Il s'exécute toujours en tant que <systemitem class="username"
>root</systemitem
> et utilise <filename
>$<envar
>KDEDIR</envar
>/share/config/kdmrc</filename
> et <filename
>/etc/X11/xdm/Xservers</filename
>. Ce dernier contient des éléments comme :</para>

<programlisting
>:0 local /usr/X11R6/bin/X :0 vt07
</programlisting>

<para
>D'autres fichiers sont utiles au démarrage : </para>
<simplelist>
<member
>La section [X-*-Core] dans <filename
>kdmrc</filename
> </member>
<member
>Configuration - <filename
>/etc/X11/xdm/Xsetup</filename
> </member>
<member
>L'utilisateur entre le nom d'utilisateur et le mot de passe </member>
<member
>Démarrage - <filename
>/etc/X11/xdm/Xstartup</filename
> - en tant que superutilisateur </member>
<member
>Session - <filename
>/etc/X11/xdm/Xsession</filename
> - démarre la session en tant qu'utilisateur </member>
<member
>= Pour une session KDE : <command
>kde</command
> ou <command
>startkde</command
> </member>
<member
>= Si présent <filename
>~/.xsession</filename
> ou <filename
>~/.xinitrc</filename
> </member>
<member
>Reset - <filename
>/etc/X11/xdm/Xreset</filename
> - après que la session soit terminée </member>
</simplelist>

</sect2>

<sect2 id="startkde">
<title
>Le script de démarrage &kde; : <command
>startkde</command
></title>

<para
>La séquence de démarrage de &kde; commence par le script <filename
>startkde</filename
>. Dans la plupart des cas, il est appelé depuis le gestionnaire d'affichage (&kdm;) une fois que l'utilisateur a été authentifié. On trouve deux lignes très importantes dans le script <filename
>startkde</filename
> :</para>

<programlisting
>LD_BIND_NOW=true kdeinit +kcminit +knotify and kwrapper
ksmserver $KDEWM
</programlisting>

<para
>La première ligne commence par le processus maître <command
>kdeinit</command
>. Le processus maître <command
>kdeinit</command
> est utilisé pour démarrer tous les autres processus &kde;. Il apparaît dans la sortie de <command
>ps <option
>aux</option
></command
> en tant que <computeroutput
>kdeinit: Running...</computeroutput
>. Les arguments placés après <command
>kdeinit</command
> sont les noms des processus additionnels à démarrer. Le <token
>+</token
> indique que <command
>kdeinit</command
> doit attendre que le processus ait terminé. <command
>kdeinit</command
> démarre aussi <command
>dcopserver</command
>, <command
>klauncher</command
> et <command
>kded</command
>.</para>

<para
>La seconde ligne demande à <command
>kdeinit</command
> de démarrer le processus du gestionnaire de session <command
>ksmserver</command
>. Le gestionnaire de session détermine la durée de vie de la session. Quand ce processus se termine, l'utilisateur est déconnecté.</para>

</sect2>
</sect1>

<sect1 id="background-processes">
<title
>Processus d'arrière-plan</title>

<para
>Tous les services d'arrière-plan de &kde; sont propres à l'utilisateur : contrairement aux démons système, ils ne sont pas partagés entre les utilisateurs. Ils sont non seulement particuliers à chaque utilisateur, mais également à chaque affichage du serveur X. Les processus sont :</para>

<variablelist>
<varlistentry>
<term
><command
>dcopserver</command
></term>
<listitem
><para
>Communication avec le bureau</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>kded</command
></term>
<listitem
><para
>Démon générique des services.</para>
<para
>Active les mises à jour de la base de données <link linkend="ksycoca"
>Sycoca</link
> lorsque c'est nécéssaire</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>kcminit</command
></term>
<listitem
><para
>Service d'initialisation</para>
<para
>Voir <xref linkend="kcminit"/> pour plus d'informations.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>klauncher</command
></term>
<listitem
><para
>Lancement du programme (ce n'est <emphasis
>pas</emphasis
> la boîte de dialogue <keycombo action="simul"
>&Alt;<keycap
>F2</keycap
> </keycombo
> !)</para>
<para
>Voir <xref linkend="klauncher"/> pour plus d'informations.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>knotify</command
></term>
<listitem
><para
>Notifications à l'utilisateur.</para>
<para
>Voir <xref linkend="knotify"/> pour plus d'informations.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>ksmserver</command
></term>
<listitem
><para
>Gestion de la session</para>
<para
>voir <xref linkend="ksmserver"/> pour plus d'informations.</para>
</listitem>
</varlistentry>

</variablelist>

<sect2 id="kdeinit">
<title
><command
>kdeinit</command
></title>
<para
><command
>kdeinit</command
> sert à démarrer tous les autres programmes &kde;. <command
>kdeinit</command
> peut démarrer les fichiers des programmes exécutables normaux ainsi que les modules chargeables <command
>kdeinit</command
> (<acronym
>KLM</acronym
>). Les <acronym
>KLM</acronym
> fonctionnent exactement comme les fichiers exécutables des programmes, mais peuvent être démarrés plus efficacement. Les <acronym
>KLM</acronym
> résident dans <filename class="directory"
>$<envar
>KDEDIR</envar
>/lib/kde3</filename
>.</para>

<para
>L'inconvénient est que les programmes démarrés de cette manière apparaissent en tant que <computeroutput
><command
>kdeinit</command
></computeroutput
> dans la sortie de <command
>top</command
> et <command
>ps</command
>. Utilisez <command
>top <option
>-c</option
></command
> ou <command
>ps <option
>aux</option
></command
> pour voir le nom véritable du programme :</para>

<screen
><prompt
>%</prompt
><userinput
><command
>ps <option
>aux</option
></command
></userinput>
<computeroutput>
waba     23184  0.2  2.1 23428 11124 ?        S    21:41   0:00 kdeinit: Running...
waba     23187  0.1  2.1 23200 11124 ?        S    21:41   0:00 kdeinit: dcopserver --nosid
waba     23189  0.2  2.4 25136 12496 ?        S    21:41   0:00 kdeinit: klauncher
waba     23192  0.7  2.8 25596 14772 ?        S    21:41   0:00 kdeinit: kded
waba     23203  0.8  3.4 31516 17892 ?        S    21:41   0:00 kdeinit:
knotify
</computeroutput
>
</screen>

<para
><computeroutput
>kdeinit: Running...</computeroutput
> indique le processus maître <command
>kdeinit</command
>. Les autres processus répertoriés sont les programmes démarrés en tant que <acronym
>KLM</acronym
>.</para>

<para
>Lorsque <command
>kdeinit</command
> démarre pour la première fois, il lance <command
>dcopserver</command
>, <command
>klauncher</command
> et <command
>kded</command
>, ainsi que des programmes additionnels spécifiés sur sa ligne de commande dans le script <command
>startkde</command
>, normalement <command
>kcminit</command
> et <command
>knotify</command
>.</para>

</sect2>

<sect2 id="dcopserver">
<title
><command
>dcopserver</command
></title>

<para
><command
>dcopserver</command
> est un démon qui fournit des fonctions de communication inter-processus (&DCOP;) à toutes les applications &kde;. Les fonctions &DCOP; sont accessibles depuis l'interpréteur de commandes via l'outil en ligne de commande <command
>dcop</command
>. &DCOP; est essentiel pour la totalité des applications &kde;.</para>

<para
>Certains fichiers connexes :</para>

<variablelist>
<varlistentry>
<term
><filename
>$<envar
>HOME</envar
>/.DCOPserver_$<envar
>HOSTNAME</envar
>_$<envar
>DISPLAY</envar
></filename
></term>
<listitem
><para
>&pex; <filename
>.DCOPserver_linux__0</filename
>. Contrôlé par $<envar
>DCOPAUTHORITY</envar
></para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename
>/tmp/.ICE-unix/dcop<replaceable
>pid</replaceable
>-<replaceable
>nombre</replaceable
></filename
></term>
<listitem
><para
>&pex; <filename
>dcop7634-1069677856</filename
>. C'est le fichier sur lequel le fichier <filename
>DCOPserver</filename
> ci-dessus pointe.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><filename
>$<envar
>HOME</envar
>/.ICEauthority</filename
></term>
<listitem
><para
>Informations d'autorisation contrôlées par $<envar
>ICEAUTHORITY</envar
></para>
</listitem>
</varlistentry>
</variablelist>

</sect2>

<sect2 id="kcminit">
<title
>kcminit</title>

<para
><command
>kcminit</command
> exécute les services d'initialisation pendant le démarrage. Les services d'initialisation sont spécifiés dans les fichiers <filename
>.desktop</filename
> des applications ou des services via la ligne <varname
>X-KDE-Init</varname
> :</para>

<programlisting
>[Desktop Entry]
Encoding=UTF-8
Exec=kcmshell energy
Icon=energy_star
Type=Application
X-KDE-Library=energy
X-KDE-Init=energy
</programlisting>

<para
>Les services d'intialisation servent généralement à initialiser le matériel en fonction de paramètres spécifiés par l'utilisateur.</para>

<para
><userinput
><command
>kcminit <option
>--list</option
></command
></userinput
> peut être utilisé pour montrer tous les services d'initialisation et <userinput
><command
>kcminit <replaceable
>service</replaceable
></command
></userinput
> pour exécuter un seul service de façon explicite. Ce comportement peut être utile lorsqu'on fait une analyse des problèmes de démarrage.</para>

</sect2>

<sect2 id="klauncher">
<title
><command
>klauncher</command
></title>

<para
><command
>klauncher</command
> est un démon respondable de l'activation des services au sein de &kde;. Il opère en liaison étroite avec le processus maître <command
>kdeinit</command
> pour démarrer de nouveaux processus. Les applications &kde; communiquent avec <command
>klauncher</command
> au travers de &DCOP; afin de démarrer de nouveaux services ou applications.</para>

<para
>Le plus connu des messages d'erreur : <computeroutput
><errortext
> KLauncher could not be reached via DCOP </errortext
></computeroutput
> qui indique soit un problème grave avec le <command
>dcopserver</command
>, soit que <command
>klauncher</command
> a « planté ».</para>

<para
><command
>klauncher</command
> peut être redémarré en redémarrant <command
>kdeinit</command
> depuis d'une fenêtre de console. Assurez-vous que $<envar
>HOME</envar
>, $<envar
>DISPLAY</envar
> et les diverses $<envar
>KDEDIR</envar
> sont définies correctement en faisant cela !</para>

</sect2>

<sect2 id="knotify">
<title
><command
>knotify</command
></title>

<para
>La tâche principale de <command
>knotify</command
> est de transmettre les notifications sonores au serveur de son. Elle fournit également des méthodes de notification de remplacement.</para>

</sect2>


</sect1>

<sect1 id="ksmserver">
<title
>KSMServer</title>

<para
><command
>ksmserver</command
> est le gestionnaire de session de &kde;. Au démarrage, le gestionnaire de session lance les applications démarrant automatiquement et restaure les applications de la session précédente. Les applications à démarrer automatiquement sont indiquées par les fichiers <literal role="extension"
>.desktop</literal
> dans le dossier <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/autostart</filename
>. Quelle soit à démarrer automatiquement ou non, il est possible de rendre conditionnelle une application en fonction de certains éléments de configuration déterminés par l'élément <varname
>X-KDE-autostart-condition</varname
> dans le fichier <literal role="extension"
>.desktop</literal
>.</para>

<informalexample>
<para
>Le fichier <filename
>ktip.desktop</filename
>, &pex;, contient :</para>

<programlisting
>X-KDE-autostart-condition=ktiprc:TipOfDay:RunOnStart:true
</programlisting>

<para
>Cela signifie qu'une vérification est effectuée sur le fichier de configuration <filename
>ktiprc</filename
> pour rechercher un élément <varname
>RunOnStart</varname
> dans la section <varname
>[TipOfDay]</varname
>. Si elle ne trouve aucun élément de ce genre, <literal
>true</literal
> est supposé, ce qui signifie que <application
>ktip</application
> est une des applications démarrées automatiquement par défaut.</para>
</informalexample>

<para
>Certaines des applications démarrées automatiquement par <command
>ksmserver</command
> sont :</para>

<variablelist>

<varlistentry>
<term
><command
>kdesktop</command
></term>
<listitem
><para
>Le bureau &kde;</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>&kicker;</command
></term>
<listitem
><para
>Le tableau de bord de &kde;</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>ktip</command
></term>
<listitem
><para
>Un programme d'astuces du jour</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>kwrited</command
></term>
<listitem
><para
>Un utilitaire permettant de recevoir les messages du système envoyés à l'utilisateur</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>&klipper;</term>
<listitem
><para
>Un utilitaire presse-papiers qui s'intègre au tableau de bord</para>
</listitem>
</varlistentry>

<varlistentry>
<term
><command
>kalarm</command
></term>
<listitem
><para
>Un utilitaire qui avertit des événements et des rendez-vous prochains</para>
</listitem>

</varlistentry>
</variablelist>

<para
><command
>kdesktop</command
> démarre à son tour les applications stockées dans <filename class="directory"
>$<envar
>KDEHOME</envar
>/Autostart</filename
>. <command
>kdesktop</command
> ouvre automatiquement tout fichier stocké dans ce dossier, y compris les documents, fichiers exécutables ou applications sous forme de fichiers <literal role="extension"
>.desktop</literal
>.</para>

<para
>Le gestionnaire de session &kde; restaure également une des sessions précédentes. Une session contient une collection d'applications, ainsi que des informations propres à une application qui reflètent l'état des applications au moment où la session a été enregistrée. Les sessions sont stockées dans le fichier de configuration <filename
>ksmserverrc</filename
>, qui contient des références aux informations d'état propres à une application. Les informations d'état propres à une application sont enregistrées dans <filename class="directory"
>$<envar
>KDEHOME</envar
>/share/config/session</filename
>. Les informations d'état de &kwin; contiennent l'emplacement des fenêtres d'application de toutes les autres applications de la session. </para>

</sect1>

<sect1 id="environment-variables">
<title
>Variables d'environnement</title>

<para
>Quelques variables d'environnement importantes que &kde; utilise :</para>

<variablelist>

<varlistentry>
<term
>$<envar
>KDEDIR</envar
></term>
<listitem
><para
>Doit être positionnée si <envar
>KDEDIRS</envar
> n'est pas définie et doit pointer sur la racine de l'arborescence d'installation de &kde;. Permet à &kde; de chercher ses données comme les icônes, les menus et les bibliothèques.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDEDIRS</envar
></term>
<listitem
><para
>Annule <envar
>KDEDIR</envar
> et vous permet de spécifier de multiples dossiers où &kde; recherche ses données. Utile si vous voulez ou devez installer certains programmes avec un préfixe autre que le reste de &kde;.</para
> 
</listitem>
</varlistentry>

<varlistentry
><term
><envar
>$KDEHOME</envar
></term
><listitem
><para
>Si elle n'est pas définie, &kde; utilise <filename class="directory"
>~/.kde</filename
> comme dossier où sont stockées les données personnelles.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDEROOTHOME</envar
></term
><listitem
><para
>Si elle n'est pas définie, &kde; utilise <filename class="directory"
>~root/.kde</filename
> comme dossier pour les données personnelles de <systemitem class="username"
>root</systemitem
>. A été introduite pour empêcher &kde; d'écraser accidentellement les données utilisateur ayant des droits d'accès root quand l'utilisateur exécute un programme &kde; après être passé avec <command
>su</command
> à <systemitem class="username"
>root</systemitem
>.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDEWM</envar
></term
><listitem
><para
>Si la variable d'environnement <envar
>KDEWM</envar
> a été définie, alors elle sera utilisée comme gestionnaire de fenêtres de &kde; dans le script <command
>startkde</command
> à la place de &kwin;.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_LANG</envar
></term
><listitem
><para
>Annule la configuration de la langue de &kde;, &pex; <userinput
>KDE_LANG=fr kprogram &amp;</userinput
> démarre un programme comportant une traduction en français si les fichiers nécessaires sont installés.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_MULTIHEAD</envar
></term
><listitem
><para
>Définissez cette variable à <literal
>true</literal
> pour indiquer que &kde; tourne sur un système « multifonctions » (<foreignphrase
>multi-head</foreignphrase
>).</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_FORK_SLAVES</envar
></term>
<listitem
><para
>(Depuis &kde; 3.2.3) Définissez cette variable pour donner naissance à des processus esclaves <acronym
>KIO</acronym
> directement depuis le processus de l'application lui-même. Par défaut, les esclaves <acronym
>KIO</acronym
> sont générés à l'aide de <command
>klauncher</command
>/<command
>kdeinit</command
>. Cette option est utile si l'esclave <acronym
>KIO</acronym
> doit s'exécuter dans le même environnement que l'application. Ce peut être le cas avec <application
>Clearcase</application
>.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_HOME_READONLY</envar
></term>
<listitem
><para
>Définissez cette variable pour indiquer que votre dossier personnel est monté en lecture seule.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_NO_IPV6</envar
></term
><listitem
><para
>(Depuis &kde; 3.2.3) - Définissez cette variable pour désactiver la prise en charge d'<acronym
>IPv6</acronym
> et les recherches <acronym
>DNS</acronym
> <acronym
>IPv6</acronym
>.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_IS_PRELINKED</envar
></term
><listitem
><para
>(Depuis &kde; 3.2) - Définissez cette variable pour indiquer que vous avez prélié vos exécutables et vos bibliothèques &kde;. Cela désactivera <command
>kdeinit</command
>.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_UTF8_FILENAMES</envar
></term
><listitem
><para
>Si cette variable d'environnement est définie, &kde; part du principe que tous les noms de fichiers sont encodés en <acronym
>UTF-8</acronym
>, quelle que soit la locale C actuelle.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDE_FULL_SESSION</envar
></term
><listitem
><para
>(Depuis &kde; 3.2) Définie automatiquement à <literal
>true</literal
> au démarrage de &kde;, elle est utilisée par &konqueror;, &pex;, pour savoir s'il doit envisager de rester en mémoire pour une réutilisation future au moment de sa fermeture. Si elle n'est pas définie, &konqueror; sort après avoir été fermé (&pex; &kdesu; le fait, c'est également utile pour le débogage).</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDESYCOCA</envar
></term
><listitem
><para
>Vous permet de spécifier le chemin d'accès et le nom du fichier de cache de configuration système &kde; généré.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDETMP</envar
></term
><listitem
><para
>Permet de spécifier un autre chemin d'accès que <filename class="directory"
>/tmp</filename
> où &kde; stocke ses fichiers temporaires.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>KDEVARTMP</envar
></term
><listitem
><para
>Permet de spécifier un autre chemin d'accès que <filename class="directory"
>/var/tmp</filename
> où &kde; stocke ses fichiers de variables.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>XDG_DATA_HOME</envar
></term
><listitem
><para
>(Depuis &kde; 3.2) Définit le dossier de base précisant où les fichiers de données propres à l'utilisateur devraient être stockés. Par défaut, il s'agit de <filename class="directory"
>$<envar
>HOME</envar
>/.local/share</filename
>.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>XDG_DATA_DIRS</envar
></term
><listitem
><para
>(Depuis &kde; 3.2) Définit l'ensemble des dossiers de base définis par ordre de préférence pour rechercher les fichiers de données en plus du dossier de base <filename class="directory"
>$<envar
>XDG_DATA_HOME</envar
></filename
>. Par défaut, il s'agit de <literal
>/usr/local/share/:/usr/share/</literal
>.</para>

<para
>&kde; ajoute des emplacements à partir de $<envar
>KDEDIRS</envar
> ainsi que des profils. Utilisée pour les fichiers de menu <literal role="extension"
>.desktop</literal
> et <literal role="extension"
>.directory</literal
>. Les fichiers <literal role="extension"
>.desktop</literal
> sous <filename class="directory"
>$<envar
>XDG_DATA_DIRS</envar
>/applications</filename
>. Les fichiers <literal role="extension"
>.directory</literal
> sous $XDG_DATA_DIRS/desktop-directories. </para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>XDG_CONFIG_HOME</envar
></term
><listitem
><para
>(&kde; 3.2) - Définit le dossier de base précisant où les fichiers de configuration propres à l'utilisateur devraient être stockés. Par défaut, il s'agit de <filename class="directory"
>$<envar
>HOME</envar
>/.config</filename
>.</para>
</listitem>
</varlistentry>

<varlistentry
><term
>$<envar
>XDG_CONFIG_DIRS</envar
></term
><listitem
><para
>(&kde; 3.2) - Définit l'ensemble des dossiers de base définis par ordre de préférence pour rechercher les fichiers de données en plus du dossier de base $<envar
>XDG_CONFIG_HOME</envar
>. Le dossier par défaut est <filename class="directory"
>/etc/xdg</filename
>. &kde; ajoute des emplacements à partir de $<envar
>KDEDIRS</envar
> et des profils également. Utilisée par les descriptions <literal role="extension"
>.menu</literal
> dans <filename class="directory"
>$<envar
>XDG_CONFIG_DIRS</envar
>/menus</filename
>. </para>
</listitem>
</varlistentry>
</variablelist>

</sect1>

<sect1 id="the-kdeinit-mystery">
<title
>Le mystère kdeinit</title>

<!-- FIXME: Add more words. Fix markup -->

<para
><command
>kdeinit</command
> sert à démarrer tous les autres programmes &kde;. <command
>kdeinit</command
> peut démarrer les fichiers des programmes exécutables normaux ainsi que les modules chargeables <command
>kdeinit</command
> (<acronym
>KLM</acronym
>). Les <acronym
>KLM</acronym
> fonctionnent exactement comme les fichiers exécutables des programmes, mais peuvent être démarrés plus efficacement. Les <acronym
>KLM</acronym
> résident dans <filename class="directory"
>$<envar
>KDEDIR</envar
>/lib/kde3</filename
>.</para>

<para
>L'inconvénient est que les programmes démarrés de cette manière apparaissent en tant que <computeroutput
><command
>kdeinit</command
></computeroutput
> dans la sortie de <command
>top</command
> et <command
>ps</command
>. Utilisez <command
>top <option
>-c</option
></command
> ou <command
>ps <option
>aux</option
></command
> pour voir le nom véritable du programme :</para>

<screen
><prompt
>%</prompt
> <userinput
><command
>ps aux | grep bastian</command
></userinput>
<computeroutput>
bastian  26061  0.0  2.2 24284 11492 ?       S    21:27   0:00 kdeinit: Running...
bastian  26064  0.0  2.2 24036 11524 ?       S    21:27   0:00 kdeinit: dcopserver
bastian  26066  0.1  2.5 26056 12988 ?       S    21:27   0:00 kdeinit: klauncher
bastian  26069  0.4  3.2 27356 16744 ?       S    21:27   0:00 kdeinit: kded
bastian  26161  0.2  2.7 25344 14096 ?       S    21:27   0:00 kdeinit: ksmserver
bastian  26179  1.1  3.4 29716 17812 ?       S    21:27   0:00 kdeinit: kicker
bastian  26192  0.4  3.0 26776 15452 ?       S    21:27   0:00 kdeinit: klipper
bastian  26195  1.0  3.5 29200 18368 ?       S    21:27   0:00 kdeinit: kdesktop
</computeroutput
>
</screen>
<para
>Ceci a un autre effet de bord, il complique la suppession un process qui cause des problèmes :</para>

<screen
><prompt
>%</prompt
> <userinput
><command
>killall kdesktop</command
></userinput>
<computeroutput
>kdesktop: no process killed</computeroutput
></screen>

<para
>Vous pouvez essayer <userinput
><command
>killall kdeinit</command
></userinput
>, pour tuer tous les process kdeinit qui aura pour effet d'arrêter tout &kde;. Une véritable destruction totale !</para>

<para
>Il y a deux solutions simples pour ceci :</para>

<screen
><prompt
>%</prompt
> <userinput
><command
>kdekillall kdesktop</command
></userinput>
ou le bon vieux
<prompt
>%</prompt
> <userinput
><command
>kill 26195</command
></userinput
></screen>
<para
><command
>kdekillall</command
> fait partie du paquet <acronym
>SDK</acronym
> de &kde;.</para>

</sect1>

</chapter>

<chapter id="customizing-kde">
<title
>Personnaliser &kde;</title>


<sect1 id="desktop-icons">
<title
>Icônes du bureau</title>

<para
>&kde; utilise plusieurs types d'icônes :</para>
<itemizedlist>
<listitem
><para
>Documents</para>
</listitem>
<listitem
><para
>Liens vers des sites web (en utilisant le fichier <literal role="extension"
>.desktop</literal
>)</para>
</listitem>
<listitem
><para
>Liens vers des applications (en utilisant le fichier <literal role="extension"
>.desktop</literal
>)</para>
</listitem>
<listitem
><para
>Périphériques - Disques, partitions, &etc; : <itemizedlist>
<listitem
><para
>Explicite en utilisant le fichier <literal role="extension"
>.desktop</literal
></para>
</listitem>
<listitem
><para
>Automatique via devices:// io-slave</para>
</listitem>
</itemizedlist>
</para>
</listitem>
<listitem
><para
>Propre au fournisseur (&pex; My Computer de &SuSE;)</para>
</listitem>
</itemizedlist>

<sect2 id="desktop-icons-websites">
<title
>Sites web</title>
<para
>Liens vers des sites web en utilisant le fichier <literal role="extension"
>.desktop</literal
> : <menuchoice
><guimenu
>Créer un nouveau</guimenu
><guimenuitem
>Lien vers une URL...</guimenuitem
></menuchoice
>. Changez d'icône à l'aide des boîtes de dialogue <guilabel
>Propriétés</guilabel
>. Le fichier obtenu <literal role="extension"
>.desktop</literal
> : <programlisting
>[Desktop Entry]
Encoding=UTF-8
Icon=/opt/kde3/share/apps/kdesktop/pics/ksslogo.png
Type=Link
URL=http://www.kde.org/
</programlisting>
</para>
</sect2>

<sect2 id="desktop-icons-applications">
<title
>Applications</title>

<para
>Liens vers des applications en utilisant le fichier <literal role="extension"
>.desktop</literal
> : <menuchoice
><guimenu
>Créer un nouveau</guimenu
><guimenuitem
>Lien vers une application...</guimenuitem
></menuchoice
>. Vous devez fournir les détails vous-même. Faites glisser depuis le menu &kde; : copiez ou liez (cette action crée un lien symbolique), beaucoup plus facile.</para>

<!-- Perhaps legacy and translated should be the other way around, but -->
<!-- this is how it appears in Waldo's presentation. Need to check -->
<!-- this -->

<programlisting
>[Desktop Entry]<co id="boilerplate"/>
Encoding=UTF-8
GenericName=IRC Client<co id="generic-desc"/>
GenericName[af]=Irc Kli&euml;t
GenericName[de]=IRC Programm
...
GenericName[zu]=Umthengi we IRC<co id="legacy"/>
SwallowExec=<co id="translated"/>
Name=KSirc
Name[af]=Ksirc
Name[de]=KSirc
...
</programlisting>

<calloutlist>
<callout arearefs="boilerplate"
><para
>Texte stéréotypé</para>
</callout>
<callout arearefs="generic-desc"
><para
>Description traduite de manière générique, non utilisée sur le bureau</para>
</callout>
<callout arearefs="legacy"
><para
>Hérité, ne peut pas être supprimé</para>
</callout>
<callout arearefs="translated"
><para
>Nom traduit, tel qu'il apparaît sur le bureau</para>
</callout>
</calloutlist>

<para
>Icônes du bureau</para>
<programlisting
>...
Name[zu]=Ksirc
MimeType=<co id="co-mimetype"/>
Exec=ksirc %i %m<co id="co-exec"/>
Icon=ksirc<co id="co-icon"/>
TerminalOptions=<co id="co-terminaloptions"/>
Path=<co id="co-path"/>
Type=Application<co id="co-type"/>
Terminal=0<co id="co-terminal"/>
X-KDE-StartupNotify=true<co id="co-x-kde-startupnotify"/>
X-DCOP-ServiceType=Multi<co id="co-x-dcop-servicetype"/>
Categories=Qt;KDE;Network<co id="co-categories"/>
</programlisting>

<calloutlist>
<callout arearefs="co-mimetype"
><para
>Types &MIME; pris en charge, non utilisé sur le bureau</para>
</callout>
<callout arearefs="co-exec"
><para
>La ligne de commande à exécuter</para>
</callout>
<callout arearefs="co-icon"
><para
>L'icône, provenant du thème des icônes ou du chemin d'accès complet</para>
</callout>
<callout arearefs="co-terminaloptions"
><para
>Utilisée seulement si un terminal est nécessaire</para>
</callout>
<callout arearefs="co-path"
><para
>Dossier de travail pour une commande</para>
</callout>
<callout arearefs="co-type"
><para
>Texte plus stéréotypé</para>
</callout>
<callout arearefs="co-terminal"
><para
>Utilisé réellement si un terminal est nécessaire, une application texte</para>
</callout>
<callout arearefs="co-x-kde-startupnotify"
><para
>Affiche un curseur animé, désactivé s'il ne fonctionne pas.</para>
</callout>
<callout arearefs="co-x-dcop-servicetype"
><para
>L'application a-t-elle démarré correctement ? Supprimé s'il ne fonctionne pas</para>
</callout>
<callout arearefs="co-categories"
><para
>Catégories pour le menu &kde;, non utilisé sur le bureau</para>
</callout>
</calloutlist>



</sect2>

<sect2 id="desktop-icons-exec">
<title
>L'option <varname
>Exec</varname
> dans les fichiers <literal role="extension"
>.desktop</literal
></title>

<para
>Après la commande, vous pouvez avoir plusieurs paramètres fictifs qui seront remplacés par les valeurs réelles lorsque le programme réel s'exécute : <variablelist>
<varlistentry>
<term
>%f</term
> <listitem
><para
>Un seul nom de fichier : utilisée lorsqu'on fait glisser un fichier sur une icône ou avec des associations de fichiers.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%F</term>
<listitem
><para
>Une liste de fichiers : utilisée pour les applications qui peuvent ouvrir plusieurs fichiers locaux en même temps.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%u</term>
<listitem
><para
>Une seule &URL; : si l'application peut gérer &pex; des &URL; &FTP; ou &HTTP; elle-même, sinon &kde;.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%U</term>
<listitem
><para
>Une liste d'&URL; : téléchargera le fichier d'abord puis transmettra un fichier local à l'application !</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%d</term>
<listitem
><para
>Le dossier du fichier à ouvrir : utile si l'application doit avoir un fichier dans le dossier de travail en cours.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%D</term>
<listitem
><para
>Une liste de dossiers : pas très pratique.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%i</term
> 
<listitem
><para
>L'icône avec l'option <option
>--icon</option
> : l'application &kde; utilisera l'icône provenant de la ligne <varname
>Icon</varname
>= dans la barre des tâches.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%m</term>
<listitem
><para
>La mini-icône : héritée.</para>
</listitem>
</varlistentry>

<varlistentry>
<term
>%c</term
> 
<listitem
><para
>La légende avec l'option <option
>--caption</option
> : l'application &kde; utilisera le nom provenant de la ligne <varname
>Name</varname
>= dans la barre d'outilsr.</para>
</listitem>
</varlistentry>

</variablelist>
</para>

<informalexample>
<para
>Exemples : <segmentedlist>
<segtitle
>Ligne <varname
>exec</varname
></segtitle>
<segtitle
>Commande exécutée</segtitle>
<seglistitem
><seg
>ksirc %i</seg
><seg
><command
>ksirc --icon ksirc</command
></seg>
</seglistitem>
<seglistitem
><seg
>cd %d; kedit $(basename %f)</seg
><seg
><command
>cd /tmp; kedit file.txt</command
></seg>
</seglistitem>
</segmentedlist>
</para>
</informalexample>

<!--Dont' know what this refers to: -->
<!--See What's This (Shift-F1) in Properties Dialog-->

</sect2>

<sect2 id="desktop-icons-devices">
<title
>Périphériques</title>
<para
>Liens vers les périphériques en utilisant le fichier <literal role="extension"
>.desktop</literal
> : Créer un nouveau périphérique </para>
</sect2>

<sect2 id="where-to-define">
<title
>Où définir quoi ?</title>

<para
>De nombreux endroits pour définir les icônes du bureau : <itemizedlist>

<listitem
><para
><filename class="directory"
>~/Desktop</filename
> : copié depuis <filename class="directory"
>/etc/skel/Desktop</filename
></para
></listitem>

<listitem
><para
><filename class="directory"
>$<envar
>KDEDIR</envar
>/apps/kdesktop/Desktop</filename
> (fusionné)</para
></listitem>

<listitem
><para
><filename class="directory"
>$<envar
>KDEDIR</envar
>/apps/kdesktop/DesktopLinks</filename
> (copié)</para
></listitem>

<listitem
><para
>Icônes des périphériques (fusionnées dynamiquement)</para
></listitem>

<listitem
><para
>La distribution SUSE Linux copie certaines icônes dans startkde.theme depuis <filename class="directory"
>/opt/kde3/share/config/SuSE/default/</filename
></para
></listitem>

</itemizedlist>
</para>
</sect2>
</sect1>

<sect1 id="kde-menu">
<title
>Menu &kde;</title>

<sect2 id="how-it-works">
<title
>Comment fonctionne-t-il</title>

<para
>Dans &kde; 3.2, un format de menu commun est introduit à <ulink url="http://freedesktop.org/Standards/menu-spec/"
>http://freedesktop.org/Standards/menu-spec/</ulink
></para>
<para
>Avant &kde; 3.2 : <itemizedlist>

<listitem
><para
>Structure des dossiers sous <filename class="directory"
>share/applnk</filename
></para
></listitem>

<listitem
><para
>La structure des dossiers représente la structure des menus</para
></listitem>

<listitem
><para
>Chaque fichier <literal role="extension"
>.desktop</literal
> représente une seule application</para
></listitem>

</itemizedlist>
</para>

<para
>Comme il a été difficile de réorganiser la structure dans &kde; 3.2, le nouveau format de menu : <itemizedlist>
<listitem
><para
>Définit une structure dans un seule fichier .menu</para
></listitem>
<listitem
><para
>Est basé sur des catégories</para
></listitem>
<listitem
><para
>Est partagé entre <acronym
>GNOME</acronym
> et &kde;</para
></listitem>
<listitem
><para
>Prend en charge les menus dans le style applnk également</para
></listitem>
</itemizedlist>
</para>

<informalexample>
<para
>Exemple de <filename
>applications.menu</filename
> : <programlisting
><markup>
        &lt;Menu&gt;
            &lt;Name&gt;Office&lt;/Name&gt;
            &lt;Directory&gt;suse-office.directory&lt;/Directory&gt;
            &lt;Include&gt;
                &lt;Filename&gt;Acrobat Reader.desktop&lt;/Filename&gt;
                &lt;Filename&gt;kde-kpresenter.desktop&lt;/Filename&gt;
                &lt;Filename&gt;kde-kword.desktop&lt;/Filename&gt;
            &lt;/Include&gt;
        &lt;Menu&gt;
</markup
>
</programlisting>
</para>
<para
>Élément de menu avec 3 applications : <itemizedlist>

<listitem
><para
><filename
>/usr/share/applications/Acrobat Reader.desktop</filename
></para
></listitem>

<listitem
><para
><filename
>/opt/kde3/share/applications/kde/kpresenter.desktop</filename
></para
></listitem>

<listitem
><para
><filename
>/opt/kde3/share/applications/kde/kword.desktop</filename
></para
></listitem>

</itemizedlist>
</para>
</informalexample>
</sect2>

<sect2 id="stored-where">
<title
>Stocké où ?</title>

<para
>Les fichiers <literal role="extension"
>.menu</literal
> décrivant la structure des menus. Les fichiers sont stockés dans <filename class="directory"
>$<envar
>KDEDIR</envar
>/etc/xdg/menus</filename
> et <filename class="directory"
>/etc/xdg/menus</filename
>. Ceux-ci stockent la structure des menus à l'échelle du système et sont contrôlés par $<envar
>XDG_CONFIG_DIRS</envar
>. <filename class="directory"
>$<envar
>HOME</envar
>/.config/menus</filename
> stocke les changements propres à l'utilisateur dans la structure des menus et est contrôlé par $<envar
>XDG_CONFIG_HOME</envar
>. Pour plus d'informations, reportez-vous à <ulink url="http://www.freedesktop.org/Standards/basedir-spec"
>http://www.freedesktop.org/Standards/basedir-spec</ulink
>.</para>

<para
>Les fichiers <literal role="extension"
>.desktop</literal
> décrivent les applications et sont stockés dans : <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/applications</filename
>, <filename class="directory"
>/usr/share/applications</filename
>, <filename class="directory"
>/usr/local/share/applications</filename
>. Ce sont des fichiers <literal role="extension"
>.desktop</literal
> d'application à l'échelle du système, qui sont contrôlés par $<envar
>XDG_DATA_DIRS</envar
>.</para>

<para
><filename class="directory"
>$<envar
>HOME</envar
>/.local/applications</filename
> contient les fichiers <literal role="extension"
>.desktop</literal
> propres au système et les changements propres à l'utilisateur. Il est contrôlé par $<envar
>XDG_DATA_HOME</envar
>. Pour plus d'informations, reportez-vous à <ulink url="http://www.freedesktop.org/Standards/basedir-spec"
>http://www.freedesktop.org/Standards/basedir-spec</ulink
></para>


<para
>Les fichiers <literal role="extension"
>.directory</literal
> décrivant les sous-menus sont stockés dans : <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/desktop-directories</filename
>, <filename class="directory"
>/usr/share/desktop-directories</filename
>, <filename class="directory"
>/usr/local/share/desktop-directories</filename
>. Ce sont des fichiers <literal role="extension"
>.directory</literal
> à l'échelle du système, contrôlés par $<envar
>XDG_DATA_DIRS</envar
>. Les changements propres à l'utilisateur sont stockés dans <filename class="directory"
>$<envar
>HOME</envar
>/.local/desktop-directories</filename
>. Ceux-ci sont contrôlés par $<envar
>XDG_DATA_HOME</envar
>. Pour plus d'informations, reportez-vous à <ulink url="http://www.freedesktop.org/Standards/basedir-spec"
>http://www.freedesktop.org/Standards/basedir-spec</ulink
></para>

<informalexample>
<para
>Exemple de <filename
>applications.menu</filename
> : <programlisting
><markup>
             &lt;Menu&gt;
                        &lt;Name&gt;Art&lt;/Name&gt;
                        &lt;Directory&gt;suse-edutainment-art.directory&lt;/Directory&gt;
                        &lt;Include&gt;
                                &lt;Category&gt;X-SuSE-Art&lt;/Category&gt;
                        &lt;/Include&gt;
                &lt;/Menu&gt;
</markup
>
</programlisting>
</para>

<para
><literal
>Art</literal
> est le nom interne de ce menu. <filename
>suse-edutainment-art.directory</filename
> définit le nom et l'icône de ce menu et le menu regroupe toutes les applications qui ont <literal
>X-SuSE-Art</literal
> répertorié comme catégorie, &pex; : <programlisting
>Categories=Qt;KDE;Education;X-SuSE-Art
</programlisting
></para>

<para
><filename
>suse-edutainment-art.directory</filename
> définit le nom et l'icône de ce menu : <programlisting
>[Desktop Entry]
Name=Art and Culture
Icon=kcmsystem
</programlisting>
</para>
</informalexample>
</sect2>

<sect2 id="common-pitfalls">
<title
>Pièges courants</title>

<para
>Les applications qui ne sont <emphasis
>pas</emphasis
> dans le menu n'existent <emphasis
>pas</emphasis
> par rapport aux autres applications ou associations de fichiers : si vous supprimez une application du menu, &kde; part du principe que vous ne voulez pas l'utiliser.</para>

<para
>Quand des applications sont indésirables dans le menu, placez-les soit dans le menu <filename
>.hidden</filename
>, soit dans un menu dédié avec <programlisting>
NoDisplay=true
</programlisting
> dans le fichier <literal role="extension"
>.directory</literal
></para>
</sect2>

<sect2 id="essential-menus">
<title
>Menus essentiels</title>

<para
><filename class="directory"
>$<envar
>KDEDIR</envar
>/etc/xdg/menus/applications-merged/</filename
> contient <filename
>kde-essential.menu</filename
> regroupant certains menus essentiels qui ne sont normalement pas affichés dans le menu &kde; lui-même : <itemizedlist>
<listitem
><para
>Le Centre de configuration a un menu Configuration caché dont le contenu est défini par <filename
>kde-settings.menu</filename
> et dont l'icône ainsi que le nom sont définis par <filename
>kde-settings.directory</filename
>.</para>
</listitem>
<listitem
><para
>Le Centre d'informations comporte un menu Informations caché dont le contenu est défini par <filename
>kde-information.menu</filename
> et dont l'icône ainsi que le nom sont définis par <filename
>kde-information.directory</filename
>.</para>
</listitem>

<listitem
><para
>Le menu Écrans de veille contient un menu Système / Écrans de veille caché, dont le contenu est défini par <filename
>kde-screensavers.menu</filename
> et dont l'icône ainsi que le nom sont définis par <filename
>kde-system-screensavers.directory</filename
>. <filename
>$<envar
>KDEDIR</envar
>/share/desktop-directories/kde-system-screensavers.directory</filename
> contient : <programlisting
>NoDisplay=true
</programlisting>
</para>
</listitem>
</itemizedlist
></para>
</sect2>

<sect2 id="old-style-menus">
<title
>Menus de style ancien</title>

<para
>&kde; continue à gérer les menus de style ancien qui sont définis par les structures de dossiers dans <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/applnk</filename
> (à l'échelle du système) et <filename class="directory"
>$<envar
>HOME</envar
>/.kde/share/applnk</filename
> (propre à l'utilisateur). Ceci est observé à moins que le fichier <literal role="extension"
>.desktop</literal
> comporte une ligne <varname
>Categories</varname
>=. Dans ce cas, les catégories déterminent l'emplacement dans le menu.</para>
</sect2>

<sect2 id="ksycoca">
<title
><application
>KSycoca</application
></title>
<para
><application
>KSycoca</application
> met en cache la structure des menus et les informations sur toutes les applications disponibles. Vous pouvez reconstruire la base de données avec <userinput
><command
>kbuildsycoca</command
></userinput
>. La base de données construite réside dans <filename class="directory"
>/var/tmp/kdecache-${<envar
>USER</envar
>}/ksycoca</filename
>. Elle est automatiquement mise à jour par <application
>KDED</application
>, vérifiée pendant la connexion à &kde; et <application
>KDED</application
> surveille les changements au cours de l'ouverture de session.</para>

<para
>Pour désactiver la surveillance des changements (puisqu'il y a un risque de problème sur NFS), ajoutez ce qui suit à <filename
>kdedrc</filename
> : <programlisting
>[General]
CheckSycoca=false
</programlisting>
</para>

<para
>Pour forcer la régénération, exécutez <userinput
><command
>touch $<envar
>KDEDIR</envar
>/share/services/update_ksycoca</command
></userinput
>.</para>

</sect2>

<sect2 id="kmenuedit">
<title
>&kmenuedit;</title>

<para
>&kmenuedit; est destiné à la configuration pour un seul utilisateur. Les changements apportés à la structure des menus sont enregistrés dans <filename
>~/.config/menus/applications-kmenuedit.menu</filename
>, ceux des applications le sont dans <filename class="directory"
>~/.local/share/applications/</filename
> et ceux qui concernent les sous-menus (icône, nom) dans <filename class="directory"
>~/.local/share/desktop-directories/</filename
>. L'outil d'administration KIOSK utilise &kmenuedit; et copie les changements ci-dessus dans des emplacements à l'échelle d'un profil ou du système. </para>

</sect2>

</sect1>

<!-- This section might be redundant. If it isn't, it needs some screenies -->
<sect1 id="kde-panel">
<title
>Tableau de bord de &kde;</title>

<para
>Le tableau de bord de &kde; est également connu comme &kicker;. Il est modulaire et repose sur les composants suivants : <itemizedlist>
<listitem
><para
>Applets,</para
></listitem>
<listitem
><para
>Boutons d'applications,</para
></listitem>
<listitem
><para
>Boutons spéciaux.</para
></listitem>
</itemizedlist>
</para>

<para
>Par défaut, le tableau de bord contient les applets suivantes : <itemizedlist
> <listitem
><para
>Pager - affiche les bureaux virtuels,</para
></listitem
> <listitem
><para
>Barre des tâches,</para
></listitem
> <listitem
><para
>Boîte à miniatures,</para
></listitem
> <listitem
><para
>Horloge.</para
></listitem
> </itemizedlist
> et les boutons spéciaux suivants : <itemizedlist>
<listitem
><para
>Menu &kde;,</para
></listitem>
<listitem
><para
>Bouton Bureau.</para
></listitem>
</itemizedlist>
</para>

<para
>Divers boutons d'applications sont également ajoutés : <itemizedlist>
<listitem
><para
>Bouton Dossier personnel,</para
></listitem>
<listitem
><para
>Bouton Navigateur,</para
></listitem>
<listitem
><para
>Bouton KMail.</para
></listitem>
</itemizedlist>
</para>
</sect1>

<sect1 id="file-associations">
<title
>Associations de fichiers</title>

<para
>Les associations de fichiers associent un type de fichier avec une application ou des applications. Le type d'un fichier est établi en déterminant son type &MIME;. Les types &MIME; connus de &kde; sont stockés dans <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/mimelnk</filename
> et chaque fichier <literal role="extension"
>.desktop</literal
> de l'application contient une liste de types &MIME; pris en charge par cette application.</para>

<informalexample>
<para
><filename
>kview.desktop</filename
>: <programlisting
>MimeType=image/gif;image/x-xpm;image/x-xbm;image/jpeg;
image/x-bmp;image/png;image/x-ico;image/x-portable-bitmap;
image/x-portable-pixmap;image/x-portable-greymap;
image/tiff;image/jp2
</programlisting>
</para>

<para
><filename
>kuickshow.desktop</filename
>: <programlisting
>MimeType=image/gif;image/x-xpm;image/x-xbm;image/jpeg;
image/png;image/tiff;image/x-bmp;image/x-psd;image/x-eim;
image/x-portable-bitmap;image/x-portable-pixmap;
image/x-portable-greymap
</programlisting>
</para>

<para
>Les deux peuvent ouvrir image/gif. Laquelle est utilisée pour ouvrir un fichier <literal role="extension"
>.gif</literal
> ?</para>

<para
>L'application ayant la préférence la plus élevée ! <filename
>kview.desktop</filename
> contient <programlisting>
InitialPreference=3
</programlisting
> alors que <filename
>kuickshow.desktop</filename
> contient <programlisting>
InitialPreference=6
</programlisting
>Par conséquent, &kuickshow; sera utilisé pour ouvrir les fichiers <literal role="extension"
>.gif</literal
>. </para>

<para
>Comment pouvons-nous créer les paramètres par défaut de &kview; ?</para>

<para
>Un utilisateur peut changer les associations de fichiers dans le &centreConfiguration;. Ces changements sont stockés dans <filename
>$<envar
>HOME</envar
>/.kde/share/config/profilerc</filename
>. Pour utiliser les mêmes réglages pour des utilisateurs multiples, stockez ces réglages dans le dossier des profils des utilisateurs ou le dossier de configuration globale de &kde; auquel faire appel en tant que dossier par défaut pour des utilisateurs multiples.</para>

</informalexample>

</sect1>

</chapter>

<chapter id="locking-down-kde">
<title
>Verrouiller &kde;</title>

<sect1 id="how-it-works-the-basics">
<title
>Les bases de fonctionnement</title>

<para
>Les fonctionnalités de verrouillage de &kde; sont centrées autour des options suivantes :</para>

<itemizedlist>
<listitem
><para
><link linkend="immutable-configuration-options"
>rendre les options de configuration immuables,</link
></para
></listitem>
<listitem
><para
><link linkend="action-restrictions"
>restreindre des actions spécifiques,</link
></para
></listitem>
<listitem
><para
><link linkend="url-restrictions"
>restreindre l'accès à certaines &URL;,</link
></para
></listitem>
<listitem
><para
><link linkend="configuration-modules"
>restreindre l'accès à certains modules de configuration.</link
></para
></listitem>
</itemizedlist>

</sect1>

<sect1 id="immutable-configuration-options">
<title
>Options de configuration immuables</title>
<subtitle
>Verrouiller &kde;</subtitle>

<para
>Les options immuables permettent à l'administrateur système de fournir des paramètres par défaut qui ne peuvent pas être changés par l'utilisateur.</para>

<para
>Les options de configuration préexistantes de l'utilisateur sont ignorées dès lors qu'une option de configuration est rendue immuable.</para>

<para
>Les options peuvent être contrôlées par élément, par groupe d'éléments ou par fichier.</para>

<para
>Si un fichier ou un groupe est immuable, toutes les options de configuration pour ce fichier ou ce groupe sont immuables, même les options pour lesquelles l'administrateur système n'a pas de valeurs par défaut prévues.</para>

<note
><para
>La prise en charge des options immuables dans les applications peut varier d'une application à l'autre. Bien que l'utilisateur ne soit pas en mesure de rendre permanents les changements des options de configuration immuables, l'utilisateur peut encore obtenir une option d'interface utilisateur pour apporter ce type de changement.</para
></note>

</sect1>

<sect1 id="action-restrictions">
<title
>Restrictions des actions</title>

<para
>Les applications &kde; sont construites autour de la notion d'action. Les actions peuvent être activées de différentes façons, généralement via la barre de menus, une des barres d'outils ou un raccourci clavier. <action
>Enregistrer le document</action
> est un exemple d'action. Si vous connaissez le nom interne d'une action, il est possible de restreindre cette action. Quand une action est restreinte, elle n'apparaît plus dans la barre de menus ou la barre d'outils. Le nom interne de l'action <action
>Enregistrer le document</action
> est <option
>action/file_save</option
>. La fenêtre de verrouillage fournit aussi un ensemble de restrictions plus abstraites qui peuvent servir à désactiver la fonctionnalité non assurée par une seule action. Un exemple est la restriction <option
>shell_access</option
> qui désactive toute la fonctionnalité qui offrirait l'accès utilisateur à un interpréteur &UNIX;.</para>

<example>
<title
>Restreindre l'accès utilisateur aux interpréteurs</title>

<para
>Pour empêcher l'accès utilisateur à un interpréteur de commandes, nous pouvons restreindre l'action <option
>shell_access</option
> en ajoutant ce qui suit à <filename
>kdeglobals</filename
> : </para
> 

<screen
>[KDE Action Restrictions]
shell_access=false</screen>

<para
>Puisque ceci affecte le menu &kde; et les applications disponibles, nous devons forcer une mise à jour de la base de données sycoca :</para>

<screen
><userinput
><command
>touch</command
> <filename
>$<envar
>KDEDIR</envar
>/share/services/update_ksycoca</filename
></userinput
></screen>

<para
>Reconnectons-nous à &kde; et vérifions les points suivants :</para>

<itemizedlist>
<listitem
><para
>le &menuk;,</para
></listitem>
<listitem
><para
>dans &konqueror;, <menuchoice
><guimenu
>Outils</guimenu
><guimenuitem
>Ouvrir un terminal</guimenuitem
></menuchoice
>,</para
></listitem>
<listitem
><para
>la commande d'exécution <keycombo action="simul"
>&Alt;<keycap
>F2</keycap
></keycombo
>.</para
></listitem>
</itemizedlist>
</example>
<para
>Vous trouverez une documentation complète sur les actions disponibles à l'adresse <ulink url="http://www.kde.org/areas/sysadmin/"
>http://www.kde.org/areas/sysadmin/</ulink
>.</para>

<para
>Quelques-unes des actions les plus intéressantes sont répertoriées ci-dessous :</para>

<variablelist>
<varlistentry>
<term
><option
>action/options_configure</option
></term>
<listitem
><para
>L'option <guimenuitem
>Configurer</guimenuitem
> du menu <guimenu
>Configuration</guimenu
></para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>action/help_report_bug</option
></term>
<listitem
><para
>L'option <guimenuitem
>Rapport de bogue...</guimenuitem
> du menu <guimenu
>Aide</guimenu
>.</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>action/kdesktop_rmb</option
></term>
<listitem
><para
>Le menu du &BDS; sur le bureau.</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>action/kicker_rmb</option
></term>
<listitem
><para
>Le menu du &BGS; sur le tableau de bord.</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>user/root</option
></term>
<listitem
><para
>Cache toutes les actions ou applications qui nécessitent un accès <systemitem class="username"
>root</systemitem
>.</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>shell_access</option
></term>
<listitem
><para
>Cache toutes les actions ou applications qui fournissent un accès à l'interpréteur de commandes.</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>print/system</option
></term>
<listitem
><para
>Désactive l'option permettant de sélectionner le système d'impression (<foreignphrase
>backend</foreignphrase
>).</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>lock_screen</option
></term>
<listitem
><para
>Décide si l'utilisateur sera ou non en mesure de verrouiller l'écran</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>start_new_session</option
></term>
<listitem
><para
>Décide si l'utilisateur peut démarrer une deuxième session X (voir aussi &kdm;)</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>opengl_screensavers</option
></term>
<listitem
><para
>Décide si l'utilisation des économiseurs d'écran OpenGL est autorisée</para
></listitem>
</varlistentry>
<varlistentry>
<term
><option
>manipulatescreen_screensavers</option
></term>
<listitem
><para
>Autorise les économiseurs d'écran qui ne masquent pas l'écran entier</para
></listitem>
</varlistentry>
</variablelist>

</sect1>

<sect1 id="url-restrictions">
<title
>Restrictions sur les &URL;</title>

<para
>Il y a trois types de restrictions susceptibles de s'appliquer aux &URL; :</para>

<variablelist>
<varlistentry>
<term
>list</term>
<listitem
><para
>Pour contrôler si un listage de dossiers est autorisé.</para
></listitem>
</varlistentry>
<varlistentry>
<term
>open</term>
<listitem
><para
>Pour contrôler si certaines &URL; peuvent être ouvertes</para
></listitem>
</varlistentry>
<varlistentry>
<term
>Redirect</term>
<listitem
><para
>Pour contrôler si une &URL; peut ouvrir une autre &URL;, automatiquement ou via un lien hypertexte.</para
></listitem>
</varlistentry>
</variablelist>

<para
>Les règles sont vérifiées dans l'ordre dans lequel elles sont définies. La dernière règle qui est applicable à une &URL; définit s'il est possible d'accéder à l'&URL;.</para>

<para
>Les règles suivantes désactivent l'ouverture des &URL; http et https en dehors de <systemitem class="domainname"
>.notreentreprise.com</systemitem
> :</para>

<screenco
><areaspec>
<area id="url_commas" coords="3"/>
<area id="url_rule1" coords="3"/>
<area id="url_rule2" coords="4"/>
</areaspec>
<screen
>[KDE URL Restrictions]
rule_count=2
rule_1=open,,,,http,,,false
rule_2=open,,,,http,*.notreentreprise.com,,true</screen
></screenco>

<calloutlist>
<callout arearefs="url_commas">
<para
>Les quatre premières virgules sautent les critères de sélection par rapport à l'&URL; d'origine. Cette partie n'est nécessaire qu'avec les règles de type redirection.</para
> 
</callout>
<callout arearefs="url_rule1"
><para
><option
>rule_1</option
> interdit l'ouverture de toute &URL; http ou https.</para
></callout>
<callout arearefs="url_rule2"
><para
><option
>rule_2</option
> autorise l'ouverture de n'importe quelle &URL; http et https dans le domaine <systemitem class="domainname"
>.notreentreprise.com</systemitem
>. Notez que le joker <token
>*</token
> n'est autorisé qu'au début d'un domaine.</para
></callout>
</calloutlist>

<para
>Les règles suivantes font que l'utilisateur ne peut plus naviguer dans les dossiers sur le système de fichiers local qui sont en dehors de son dossier $<envar
>HOME</envar
> :</para>

<screenco
><areaspec>
<area id="home_rule1" coords="3"/>
<area id="home_rule2" coords="4"/>
</areaspec>
<screen
>[KDE URL Restrictions]
rule_count=2
rule_1=list,,,,file,,,false
rule_2=list,,,,file,,$HOME,true</screen
></screenco>

<calloutlist>
<callout arearefs="home_rule1"
><para
><option
>rule_1</option
> interdit le listage de tout dossier local.</para
></callout>
<callout arearefs="home_rule2"
><para
><option
>rule_2</option
> autorise le listage des dossiers sous le dossier $<envar
>HOME</envar
> propre des utilisateurs.</para
></callout>
</calloutlist>

<para
>$<envar
>HOME</envar
> et $<envar
>TMP</envar
> sont des valeurs spéciales pour indiquer le dossiers personnel des utilisateurs et le dossier temporaire &kde; de l'utilisateur, &pex; <filename class="directory"
>/tmp/kde-bastian</filename
>.</para>

<para
>Les règles suivantes font que l'utilisateur ne peut plus ouvrir les fichiers locaux qui sont en dehors de son dossier $<envar
>HOME</envar
> :</para>

<screenco
><areaspec>
<area id="local_rule1" coords="3"/>
<area id="local_rule2" coords="4"/>
<area id="local_rule3" coords="5"/>
</areaspec>
<screen
>[KDE URL Restrictions]
rule_count=3
rule_1=open,,,,file,,,false
rule_2=open,,,,file,,$HOME,true
rule_3=open,,,,file,,$TMP,true</screen
></screenco>

<calloutlist>
<callout arearefs="local_rule1"
><para
><option
>rule_1</option
> interdit l'ouverture de tout fichier local.</para
></callout>
<callout arearefs="local_rule2"
><para
><option
>rule_2</option
> autorise l'ouverture des fichiers sous le dossier $<envar
>HOME</envar
> propre des utilisateurs.</para
></callout>
<callout arearefs="local_rule3"
><para
><option
>rule_3</option
> autorise l'ouverture des fichiers dans le dossier temporaire &kde; de l'utilisateur. Celle-ci est exigée par certaines applications &kde; qui téléchargent d'abord un fichier ou un document dans le dossier temporaire puis l'ouvrent dans une application.</para
></callout>
</calloutlist>


<para
>L'option de redirection contrôle si les documents d'un emplacement donné peuvent renvoyer, automatiquement ou manuellement via un lien hypertexte, à un autre emplacement donné. Un ensemble de règles par défaut est présent à titre de mesure de sécurité générale. Par exemple, des documents qui se trouvent sur l'Internet peuvent ne pas renvoyer à des documents stockés en local.</para>

<para
>Par exemple, si nous voulons donner au serveur intranet <systemitem class="systemname"
>www.monentreprise.com</systemitem
> la possibilité de renvoyer à des fichiers locaux, nous pourrions ajouter la règle suivante :</para>

<screen
>[KDE URL Restrictions]
rule_count=1
rule_1=redirect,http,www.monentreprise.com,,file,,,true</screen>

<para
>Au lieu de lister un protocole par nom, il est également possible de spécifier un groupe entier de protocoles. Pour ce faire, les groupes suivants ont été définis :</para>

<variablelist>
<varlistentry>
<term
>:local</term>
<listitem
><para
>Les protocoles qui accèdent aux informations stockées en local : des exemples sont file:/, man:/, fonts:/, floppy:/</para
></listitem>
</varlistentry>
<varlistentry>
<term
>:internet</term>
<listitem
><para
>Protocoles internet courants tels que http et ftp</para
></listitem>
</varlistentry>
</variablelist>

<para
>Les informations sur les protocoles sont stockées dans les fichiers <literal role="extension"
>*.protocol</literal
>, qui se trouvent dans <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/services</filename
>.</para>

<para
>L'élément <option
>Class</option
>= définit le groupe auquel un protocole appartient : <userinput
><command
>grep</command
> <option
>Class=</option
> <filename
>$<envar
>KDEDIR</envar
>/share/services/*.protocol</filename
></userinput
></para>

<para
>Règles générales :</para>

<itemizedlist>
<listitem
><para
>Les protocoles :local peuvent renvoyer n'importe quel autre protocole</para
></listitem>
<listitem
><para
>Il est toujours autorisé de renvoyer à un protocole :internet</para
></listitem>
<listitem
><para
>Tous les protocoles ne font pas partie d'un groupe, fish:/ par exemple</para
></listitem>
</itemizedlist>

</sect1>

<sect1 id="configuration-modules">
<title
>Modules de configuration</title>

<para
>&kde; comporte des modules de configuration permettant de configurer divers aspects de l'environnement &kde;. Les modules de configuration apparaissent dans le Centre de configuration, dans la boîte de dialogue Configuration d'une application ou les deux.</para>

<informalexample>
<para
>Le module de configuration Serveur mandataire apparaît dans le Centre de configuration mais fait également partie de la boîte de dialogue <guilabel
>Configuration de Konqueror</guilabel
> dans &konqueror;.</para>

<para
>Les modules de configuration individuels peuvent être démarrés via <command
>kcmshell</command
> <replaceable
>module</replaceable
></para>

<para
>Pour démarrer le serveur mandataire, utilisez :</para>
<itemizedlist>
<listitem
><para
><command
>kcmshell</command
> <filename
>kde-proxy.desktop</filename
></para
></listitem>
<listitem
><para
><command
>kcmshell</command
> proxy</para
></listitem>
</itemizedlist>

<para
><note
><para
>Toutes les applications n'utilisent pas les modules de configuration. Souvent la boîte de dialogue fait partie intégrante de l'application elle-même.</para
></note
></para>
</informalexample>

<para
>Tous les modules de configuration font partie à proprement parler du menu &kde;.</para>

<itemizedlist>
<listitem>
<para
>Les modules que l'on peut voir dans le Centre de configuration comportent normalement un fichier <literal role="extension"
>.desktop</literal
> dans <filename class="directory"
>$<envar
>KDEDIR</envar
>/share/applications/kde</filename
> et sont triés sous le menu <guimenu
>Configuration-Modules</guimenu
> par le <filename
>kde-settings.menu</filename
>, inclus depuis <filename
>kde-essential.menu</filename
>.</para>
<screen
><userinput
><command
>kbuildsycoca</command
> <option
>--menutest</option
> 2&gt; /dev/null | <command
>grep</command
> Configuration-Modules</userinput
></screen>
</listitem>
<listitem>
<para
>Les modules propres à une application comportent normalement un fichier <literal role="extension"
>.desktop</literal
> sous <filename
>$<envar
>KDEDIR</envar
>/share/applnk/.hidden</filename
>, qui correspond au menu caché .hidden, inclus à la suite de <markup
>&lt;KDELegacyDirs/&gt;</markup
></para>
<screen
><userinput
><command
>kbuildsycoca</command
> <option
>--menutest</option
> 2&gt; /dev/null | <command
>grep</command
> .hidden</userinput
></screen>
</listitem>
<listitem
><para
>Dans &kde; 3.3, il est possible de modifier le Centre de configuration avec <application
>kcontroledit</application
>. <application
>kcontroledit</application
> fonctionne exactement comme <application
>kmenuedit</application
>, mais ne change que pour l'utilisateur actuel. Utilisez <application
>kiosktool</application
> pour effectuer les changements pour chacun.</para
></listitem
> 
</itemizedlist>

<para
>Les modules de configuration individuels peuvent être désactivés en ajoutant ce qui suit à <filename
>kdeglobals</filename
> :</para>

<screen
>[KDE Control Module Restrictions]
<replaceable
>module-id</replaceable
>=false</screen>
<para
>Par exemple, pour désactiver le serveur mandataire, utilisez</para>
<screen
>[KDE Control Module Restrictions]
kde-proxy.desktop=false</screen>
<para
>Vérifiez le Centre de configuration et la boîte de dialogue <guilabel
>Configurer Konqueror...</guilabel
> si la configuration du serveur mandataire est encore présente.</para>

</sect1>
<!-- 
<sect1 id="making-it-work">
<title
>Making it Work</title>

Making It Work
KDE 3.2: Set $KDEDIRS from startkde script
Distribute profiles to all clients

</para>
</sect1>
-->
</chapter>

<chapter id="the-lazy-admin">
<title
>L'administrateur paresseux</title>

<!-- This section appears to need quite a lot of additional words to -->
<!-- make sense. Perhaps it would be better to comment it out if it -->
<!-- can't be updated before the next release (Phil) -->
<!-- FIXME: Commented it out until it's got some more content fleshing it -->
<!-- out (Lauri)

<sect1 id="lazy-admin-overview">
<title
>Overview</title>

<para>
The Lazy Admin
Overview
Deployment
	How to get &kde; available on many clients
Remote Desktop Sharing
Take a look at someone else desktop
DCOP
	The DCOP command line tool makes it possible to control &kde; applications from the command line
KDialog
	A versatile tool to use standard &kde; dialogs in your own scripts



Deployment
Thin Clients
Installing Software
= AutoYaST
= KickStart
Maintaining Settings
= /etc/kderc, other settings
= Use rsync to copy files around
= Shared filesystem such as NFS
o store profiles themselves on NFS



http://www.suse.de/~nashif/autoinstall/index.html

</para>
</sect1>
-->
<sect1 id="remote-desktop-sharing">
<title
>Partage de bureau distant</title>

<para
>Le partage de bureau distant permet à des utilisateurs distants de voir et éventuellement de contrôler le bureau de l'utilisateur courant. L'utilisateur distant doit avoir reçu une invitation et il est possible de créer un mot de passe pour protéger une invitation en attente. Cela convient parfaitement pour des équipes de support technique ou des administrateurs pour obtenir l'accès aux bureaux des utilisateurs afin de les dépanner ou les guider dans une procédure.</para>

<para
>Le partage de bureau distant repose sur deux applications : &krfb; (&kde; remote frame buffer, un serveur VNC) et &krdc; (&kde; remote desktop connection, un client VNC).</para>

<para
>&krfb; peut être utilisé par tout utilisateur pour créer et gérer des invitations. Les invitations créent un mot de passe à usage unique qui permet au destinataire de se connecter à votre bureau. Par défaut elle est valable pour une seule connexion réussie et expire au bout d'une heure de non utilisation.</para>

<para
>Les connexions entrantes sont gérées par le module kinetd kded. Vous pouvez utiliser la commande <userinput
><command
>dcop</command
> kded kinetd services</userinput
> pour vérifier que &krfb; est en cours d'exécution et attend par défaut les connexions sur le port 5900. Quand une connexion entrante est établie, une boîte de dialogue apparaît pour demander confirmation à l'utilisateur courant.</para>

<!-- TODO: Write a bit more here, with a walk through maybe? -->

</sect1>

<sect1 id="kde-diy">
<title
>&kde; DIY - Construisez vos propres outils</title>

<sect2 id="dcop">
<title
>DCOP</title>

<para
>Desktop COmmunication Protocol, <acronym
>DCOP</acronym
> (protocole de communication du bureau) est un mécanisme léger permettant la communication inter-processus. <acronym
>DCOP</acronym
> permet à l'utilisateur d'interagir avec les applications qui s'exécutent actuellement. &kde; fournit deux programmes pour tirer parti de <acronym
>DCOP</acronym
> : <application
>dcop</application
>, un programme en ligne de commande et <application
>kdcop</application
>, un programme d'interface graphique (<acronym
>GUI</acronym
>). </para>
<para
>Voici quelques remarques sur l'utilisation de <command
>dcop</command
> : </para>

<para>
<itemizedlist>
<listitem>
<para
><command
>dcop</command
> [options] [application [object [function [arg1] [arg2] ... ] ] ] </para>
</listitem>
<listitem>
<para
>Les applications qui peuvent ouvrir plusieurs fenêtres à la fois seront répertoriées sous la forme d'un <acronym
>PID</acronym
> d'&lt;application&gt; </para>
</listitem>
<listitem>
<para
>Tous les arguments sont sensibles à la casse. 'setFullScreen' et 'setfullscreen' sont deux fonctions différentes. </para>
</listitem>
<listitem>
<para
>Le jeton (<foreignphrase
>token</foreignphrase
>) de l'expression rationnelle * peut être utilisé dans l'application et les arguments de l'objet. <screen
><prompt
>&percnt; </prompt
><userinput
><command
>dcop</command
><option
> kon*</option
></userinput>
konqueror-16006
konsole-8954
</screen>
</para>
</listitem>

</itemizedlist>

</para>

<para
>Voici quelques exemples de commandes et leur sortie : </para>

<informalexample>
<screen
><prompt
>&percnt; </prompt
><userinput
><command
>dcop</command
><option
> konsole*</option
></userinput>
konsole-8954
</screen>
<para
>Une &konsole; s'exécute avec un <acronym
>PID</acronym
> de 8954.</para>

<screen
><prompt
>&percnt; </prompt
><userinput
><command
>dcop</command
><option
> konsole-8954</option
></userinput>
KBookmarkManager-.../share/apps/kfile/bookmarks.xml
KBookmarkManager-.../share/apps/konqueror/bookmarks.xml
KBookmarkNotifier
KDebug
MainApplication-Interface
konsole (default)
konsole-mainwindow#1
ksycoca
session-1
session-2
session-3
session-4
</screen>
<para
>Vous voyez ici qu'il y a quatre sessions actives.</para>

<screen
><prompt
>&percnt; </prompt
><userinput
><command
>dcop</command
><option
> konsole-8954</option
><option
> konsole</option
></userinput>
QCStringList interfaces()
QCStringList functions()
int sessionCount()
QString currentSession()
QString newSession()
QString newSession(QString type)
QString sessionId(int position)
void activateSession(QString sessionId)
void nextSession()
void prevSession()
void moveSessionLeft()
void moveSessionRight()
bool fullScreen()
void setFullScreen(bool on)
ASYNC reparseConfiguration()
</screen>
<para
>Voici les options du programme &konsole; principal. </para>

<screen
><prompt
>&percnt; </prompt
><userinput
><command
>dcop</command
><option
> konsole-8954</option
><option
> session-1</option
></userinput>
QCStringList interfaces()
QCStringList functions()
bool closeSession()
bool sendSignal(int signal)
void clearHistory()
void renameSession(QString name)
QString sessionName()
int sessionPID()
QString schema()
void setSchema(QString schema)
QString encoding()
void setEncoding(QString encoding)
QString keytab()
void setKeytab(QString keyboard)
QSize size()
void setSize(QSize size)
</screen>
<para
>Voici les options de la première session, session-1.</para>

<screen
><prompt
>&percnt; </prompt
><userinput
><command
>dcop</command
><option
> konsole-8954</option
><option
> konsole</option
><option
> setFullScreen</option
><parameter
> true</parameter
></userinput
>
</screen>
<para
>Cette commande place &konsole; en mode plein écran.</para>

</informalexample>

<para
>Quand il y a plusieurs applications/objets, lequel devrez-vous utiliser ? Avez-vous une référence ? </para>
<screen
><prompt
>&percnt; </prompt
><userinput
><command
>echo</command
><option
> $KONSOLE_DCOP</option
></userinput>
DCOPRef(konsole-7547,konsole)

<prompt
>&percnt; </prompt
><userinput
><command
>dcop</command
><option
> $KONSOLE_DCOP</option
><option
> newSession</option
></userinput>
session-6

<prompt
>&percnt; </prompt
><userinput
><command
>dcopstart</command
><option
> konsole</option
></userinput>
konsole-9058


#!/bin/sh
konsole=$(dcopstart konsole-script)
session=$(dcop $konsole konsole currentSession)
dcop $konsole $session renameSession Local

session=$(dcop $konsole konsole newSession)
dcop $konsole $session renameSession Remote

session=$(dcop $konsole konsole newSession)
dcop $konsole $session renameSession Code
dcop $konsole $session sendSession 'cd /my/work/directory'

</screen>

</sect2>

<sect2 id="kdialog">
<title
>KDialog</title>
<subtitle
>&kde; DIY - Construisez vos propres outils</subtitle>

<para
>Vous pouvez utiliser les boîtes de dialogue &kde; depuis vos propres scripts pour combiner la puissance du scriptage shell d'&UNIX; à la facilité d'utilisation de &kde;.</para>

<screen
><userinput
><command
>kdialog</command
> <option
>--msgbox 'Vous avez de nouveaux messages !'</option
></userinput
></screen>

<screen
><userinput
><command
>kdialog</command
> <option
>--title 'Nouveaux messages'</option
> <option
>--msgbox 'Vous avez de nouveaux messages !'</option
></userinput
></screen>

<para
>Le composant <application
>KDialog</application
> peut être remplacé par l'option <option
>--caption</option
></para>

<screen
><userinput
><command
>kdialog</command
> <option
>--title 'Nouveaux messages'</option
> <option
>--msgbox 'Vous avez de nouveaux messages !'</option
> <option
>--dontagain myfile:mykey</option
></userinput
></screen>

<para
>Enregistre ce qu'il faut ou non afficher à nouveau dans <filename
>$<envar
>KDEHOME</envar
>/share/config/myfile</filename
> (en insérant dans ce fichier les lignes suivantes :</para>

<screen
>[Notification Messages]
mykey=false</screen>

<para
>À la place de <option
>--msgbox</option
>, vous pouvez également faire appel à <option
>--sorry</option
> et <option
>--error</option
>, comme approprié. Par exemple, vous pourriez utiliser <command
>kdialog</command
> <option
>--sorry 'Le réseau est inaccessible'</option
> ou <command
>kdialog</command
> <option
>--error 'Impossible d'ouvrir la boîte aux lettres'</option
>.</para>

<para
>Il est également possible de créer des boîtes de messages qui acceptent une réponse oui ou non.</para>

<screen
><command
>kdialog</command
> <option
>--yesno 'Voulez-vous vous connecter
à l'Internet ?'</option
> <command
>echo</command
> <returnvalue
>$?</returnvalue
></screen>

<informaltable>
<tgroup cols="2">
<thead>
<row>
<entry
>Valeur de retour</entry>
<entry
>Signification</entry>
</row>
</thead>
<tbody>
<row
><entry
>0</entry
><entry
>Oui, OK, Continuer</entry
></row>
<row
><entry
>1</entry
><entry
>Non</entry
></row>
<row
><entry
>2</entry
><entry
>Annuler</entry
></row>
</tbody>
</tgroup>
</informaltable>

<para
>Veillez à enregistrer le résultat dans une variable si vous ne l'utilisez pas directement, la prochaine commande complète $? avec une nouvelle valeur. Vous pouvez faire appel à <option
>--dontagain</option
> ici également, car elle retient le choix de l'utilisateur et le retourne les fois suivantes sans jamais plus afficher la boîte de dialogue.</para>

<para
>Les autres variations sont :</para>

<variablelist>
<varlistentry>
<term
><option
>--warningyesno</option
></term>
<listitem>
<para
>comme <option
>--yesno</option
>, mais avec une icône différente</para>
</listitem>
</varlistentry>
<varlistentry>
<term
><option
>--warningcontinuecancel</option
></term>
<listitem
><para
>Avec les boutons <guibutton
>Continuer</guibutton
> et <guibutton
>Annuler</guibutton
>.</para>
</listitem>
</varlistentry>
<varlistentry>
<term
><option
>--warningyesnocancel</option
></term>
<listitem
><para
>Avec les boutons <guibutton
>Oui</guibutton
>, <guibutton
>Non</guibutton
> et <guibutton
>Annuler</guibutton
>. Par exemple :</para>
<screen
><command
>kdialog</command
> <option
>--warningyesnocancel 'Voulez-vous
enregistrer les changements ?'</option
></screen>
</listitem>
</varlistentry>
</variablelist>

<screen
><command
>kdialog</command
> <option
>--inputbox "Saisissez votre nom :" "VotreNom"</option
></screen>

<para
>Le résultat s'affiche sur la sortie standard. Pour le placer dans une variable, vous pouvez utiliser <userinput
>name=$(kdialog --inputbox "Saisissez votre nom :" "VotreNom")</userinput
>. Le dernier argument est optionnel, il sert à préremplir la boîte de dialogue.</para>

<screen
><userinput
><varname
>mot_de_passe</varname
>=$(<command
>kdialog</command
> <option
>--password "Saisissez votre mot de passe :"</option
>)</userinput
></screen>

<para
>L'option <option
>--dontagain</option
> ne fonctionne pas avec <option
>--inputbox</option
> ou <option
>--password</option
></para>

<para
>Il y a deux boîtes de dialogue qui permettent à l'utilisateur de faire un choix dans une liste :</para>

<variablelist>
<varlistentry>
<term
><option
>--menu</option
></term>
<listitem>
<para
>Permet à l'utilisateur de sélectionner un seul élément dans une liste.</para>
</listitem>
</varlistentry>
<varlistentry>
<term
><option
>--checklist</option
></term>
<listitem>
<para
>Permet à l'utilisateur de sélectionner un ou plusieurs éléments dans une liste.</para>
</listitem>
</varlistentry>
</variablelist>

<screen
><userinput
><varname
>ville</varname
>=$(<command
>kdialog</command
> <option
>--menu "Sélectionnez une ville" a Londres b Madrid c Paris d Berlin</option
>)</userinput
></screen>

<para
><varname
>$ville</varname
> sera <returnvalue
>a</returnvalue
>, <returnvalue
>b</returnvalue
>, <returnvalue
>c</returnvalue
> ou <returnvalue
>d</returnvalue
>.</para>

<screen
><userinput
><varname
>ville</varname
>=$(<command
>kdialog</command
> <option
>--checklist "Sélectionnez des villes" a Londres off b Madrid on c Paris on d Berlin off</option
>)</userinput
></screen>

<para
>Madrid et Paris seront présélectionnées. Le résultat avec Madrid et Paris sélectionnées sera <returnvalue
>"b"</returnvalue
> <returnvalue
>"c"</returnvalue
>.</para>

<para
>Si vous ajoutez l'option <option
>--separate-output</option
>, elle placera <returnvalue
>b</returnvalue
> et<returnvalue
>c</returnvalue
> chacune sur une ligne propre, ce qui rend le résultat plus facile à traiter.</para>

<screen
>file=$(kdialog --getopenfilename $HOME)
file=$(kdialog --getopenfilename $HOME "*.png *.jpg|Image Files")
file=$(kdialog --getsavefilename $HOME/SaveMe.png)
file=$(kdialog --getexistingdirectory $HOME)</screen>

</sect2>

</sect1>

</chapter>
&groupware-with-kontact; </part>

<!-- Keep this comment at the end of the file
Local variables:
mode: xml
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:nil
sgml-general-insert-case:lower
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:0
sgml-indent-data:true
sgml-parent-document:("index.docbook" "book" "part")
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
